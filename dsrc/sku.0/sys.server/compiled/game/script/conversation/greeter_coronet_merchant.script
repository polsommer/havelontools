// ======================================================================
//
// greeter_coronet_merchant.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.36 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.features;
include library.groundquests;
include library.skill;
include library.space_flags;
include library.space_quest;
include library.space_utils;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/greeter_coronet_merchant";

// ======================================================================
// Script Conditions
// ======================================================================

boolean greeter_coronet_merchant_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_getInvoiceAndSchedule (obj_id player, obj_id npc)
{
	if ( groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_getSchedule") &&
	( groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_getInvoice") ||
	groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_craftTool")||
	groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_craftedTool") ) )
	{
		return true;
	}
	
	if ( groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment_intro", "ralMundi_getSchedule") &&
	( groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment_intro", "ralMundi_getInvoice") ||
	  groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment_intro", "ralMundi_gaveTool") ) )
	{
		return true;
	}	
		
	return false;
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_getSchedule (obj_id player, obj_id npc)
{
	if ( groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_getSchedule") &&
	groundquests.hasCompletedTask(player, "corellia_coronet_find_missing_shipment", "ralMundi_craftedTool") )
	{
		return true;
	}
	
	if ( groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment_intro", "ralMundi_getSchedule") &&
	groundquests.hasCompletedTask(player, "corellia_coronet_capitol_problems_missing_shipment_intro", "ralMundi_gaveTool") )
	{
		return true;
	}
	
	return false;
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_getInvoice (obj_id player, obj_id npc)
{
	if ( groundquests.hasCompletedTask(player, "corellia_coronet_find_missing_shipment", "ralMundi_getSchedule") &&
	( groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_getInvoice") ||
	groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_craftTool")||
	groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_craftedTool") ) )
	{
		return true;
	}

	if ( groundquests.hasCompletedTask(player, "corellia_coronet_capitol_problems_missing_shipment_intro", "ralMundi_getSchedule") &&
	( groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment_intro", "ralMundi_getInvoice") ||
      groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment_intro", "ralMundi_gaveTool") ) )
	{
		return true;
	}
	
	return false;
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_faliedSpaceQuest (obj_id player, obj_id npc)
{
	return (groundquests.hasCompletedQuest(player, "corellia_coronet_capitol_problems_missing_shipment_intro")&&
			!(groundquests.isQuestActiveOrComplete(player, "corellia_coronet_capitol_problems_missing_shipment") ));
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_playerHasShip (obj_id player, obj_id npc)
{
	return space_utils.hasShip(player);
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_gotBothInvoiceAndSchedule (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_gotScheduleAndInvoice") ||
	groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment_intro", "ralMundi_gotScheduleAndInvoice");
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_sawRagtagFighters (obj_id player, obj_id npc)
{
	return 	groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment", "ralMundi_traceTransportRoute");
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_failedSpacePatrol (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment", "ralMundi_failed_patrol");
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_foundTomiBunker (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_defeatTomi") ||
	groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment", "ralMundi_defeatTomi");
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_intimidateRagtags (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_intimidateRagtags") ||
	groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment", "ralMundi_intimidateRagtags");
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_goGetShipment (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_shipmentAtCapitol") ||
	groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment", "ralMundi_shipmentAtCapitol");
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_foundShipment (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_coronet_find_missing_shipment", "ralMundi_shipmentFound") ||
	groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment", "ralMundi_shipmentFound");
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_questComplete (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "corellia_coronet_find_missing_shipment") ||
	groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment", "ralMundi_reportToJasper") ||
	groundquests.hasCompletedQuest(player, "corellia_coronet_capitol_problems_missing_shipment");
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_hasSpacePatrol (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_coronet_capitol_problems_missing_shipment", "givespacequest");
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_hasOtherSpaceMission (obj_id player, obj_id npc)
{
	return space_quest.hasQuest(player);
}

// ----------------------------------------------------------------------

boolean greeter_coronet_merchant_condition_notOnMissingShipment (obj_id player, obj_id npc)
{
	return groundquests.isQuestDisabled ("corellia_coronet_capitol_problems_missing_shipment") ||
	( !groundquests.isQuestActive(player, "corellia_coronet_capitol_problems_missing_shipment")&&
	!groundquests.hasCompletedQuest(player, "corellia_coronet_capitol_problems_missing_shipment") &&
	!groundquests.isQuestActive(player, "corellia_coronet_capitol_problems_missing_shipment_intro")&&
	!groundquests.hasCompletedQuest(player, "corellia_coronet_capitol_problems_missing_shipment_intro") );
}

// ======================================================================
// Script Actions
// ======================================================================

void greeter_coronet_merchant_action_beginMissingShipment (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "ralMundi_begin");
}

// ----------------------------------------------------------------------

void greeter_coronet_merchant_action_givePatrolMission (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "corellia_coronet_capitol_problems_missing_shipment");
}

// ----------------------------------------------------------------------

void greeter_coronet_merchant_action_goAfterRagtags (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "ralMundi_traceTransportRoute");
}

// ----------------------------------------------------------------------

void greeter_coronet_merchant_action_endQuest (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "ralMundi_shipmentFound");
}

// ----------------------------------------------------------------------

void greeter_coronet_merchant_action_signalPatrolMission (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "ralMundi_gotScheduleAndInvoice");
}

// ----------------------------------------------------------------------

void greeter_coronet_merchant_action_giveShip (obj_id player, obj_id npc)
{
	space_quest.grantNewbieShip(player, "neutral");
}

// ----------------------------------------------------------------------

void greeter_coronet_merchant_action_clearFailedPatrol (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "failed_ral");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int greeter_coronet_merchant_handleBranch3 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] found stolen shipment at the capitol building
	//-- NPC: The missing shipment was at the capitol building? Unbelievable. I'll send some droids to go retrieve it. And the mystery crate contained spice? I'm astounded. Why in the world would a smuggled crate of spice end up at the capitol building? You don't think this involved the Diktat, do you? No, that's patently absurd, isn't it?  I'll have to alert CorSec of all this. Not that there's much they can do at this point. Thank you, though, for your help!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: It was my pleasure.
	if (response == "s_125")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			greeter_coronet_merchant_action_endQuest (player, npc);

			//-- NPC: You did a wonderful job. I have an opening in my warehouse if you're...no, what am I saying. That position is far beneath someone like you. But you do have my thanks. And now I must get back to making my starships.
			string_id message = new string_id (c_stringFile, "s_126");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch8 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] completed space patrol mission
	//-- NPC: Attacked by Ragtags? Those thugs who plague the planet? And amid the debris of what looked like the destroyed engines of large freighter or transport, no less. Very interesting.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Did you discover anything about the strange crate in your shipment?
	if (response == "s_114")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			//-- NPC: Indeed I did. A low level employee in my warehouse named Tomi Jinsin has been accessing shipment records and adding something to deliveries from time to time over the past few months. Adding things like this unexplained crate. He's been fairly obvious about it. If I'd been paying more attention, I'd have likely noticed sooner. It's odd in a way. Almost like he wanted me to discover what he was doing.
			string_id message = new string_id (c_stringFile, "s_115");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Why would he do that?
			boolean hasResponse0 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_116");

				utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 9);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch9 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Indeed I did. A low level employee in my warehouse named Tomi Jinsin has been accessing shipment records and adding something to deliveries from time to time over the past few months. Adding things like this unexplained crate. He's been fairly obvious about it. If I'd been paying more attention, I'd have likely noticed sooner. It's odd in a way. Almost like he wanted me to discover what he was doing.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why would he do that?
	if (response == "s_116")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			//-- NPC: Hmm? Oh, it's probably nothing. I'm sure he was just careless. In any case, we must find Tomi Jinsin. Unfortunately, I do not have any record of where he might live. But I suspect there must be some connection with these Ragtags. Maybe if you put some pressure on those thugs, they'll reveal what they know about Tomi. Seems like our best bet at this juncture.
			string_id message = new string_id (c_stringFile, "s_117");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: That's a good idea. I'll go intimidate some Ragtags.
			boolean hasResponse0 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No thanks. I think I've had enough of this.
			boolean hasResponse1 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_118");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_119");

				utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 10);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch10 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Hmm? Oh, it's probably nothing. I'm sure he was just careless. In any case, we must find Tomi Jinsin. Unfortunately, I do not have any record of where he might live. But I suspect there must be some connection with these Ragtags. Maybe if you put some pressure on those thugs, they'll reveal what they know about Tomi. Seems like our best bet at this juncture.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: That's a good idea. I'll go intimidate some Ragtags.
	if (response == "s_118")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			greeter_coronet_merchant_action_goAfterRagtags (player, npc);

			//-- NPC: You'll find Ragtags outside of most Corellia cities and Coronet is no exception. They're usually loitering around on the outskirts of the city. If you find anything about Tomi or my missing shipment, please follow it through.
			string_id message = new string_id (c_stringFile, "s_120");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No thanks. I think I've had enough of this.
	if (response == "s_119")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			//-- NPC: I understand. Those Ragtags are likely to get violent. I don't blame you for stepping away.
			string_id message = new string_id (c_stringFile, "s_121");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch13 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] failed or aborted space patrol mission
	//-- NPC: You didn't find anything? Nothing at all? Would you please go look again? I just know there must be some clue as to what happened out there. Maybe the transport broke down. Or was attacked. Please look again and be sure to fly the entire route.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Okay, I'll go look again.
	if (response == "s_110")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			greeter_coronet_merchant_action_givePatrolMission (player, npc);

			//-- NPC: Thank you. Be sure to fly the entire route.
			string_id message = new string_id (c_stringFile, "s_112");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't think so. I'm done with this.
	if (response == "s_111")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well. I probably should not ask so much of someone I barely know.
			string_id message = new string_id (c_stringFile, "s_113");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: What's the problem?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I need the route information again.
	if (response == "s_48")
	{
		//-- [NOTE] 
		if (!greeter_coronet_merchant_condition_playerHasShip (player, npc))
		{
			greeter_coronet_merchant_action_giveShip (player, npc);

			//-- NPC: Very well. Here is the information.
			string_id message = new string_id (c_stringFile, "s_57");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			greeter_coronet_merchant_action_givePatrolMission (player, npc);

			//-- NPC: Very well. I will transfer the information to you now.
			string_id message = new string_id (c_stringFile, "s_49");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] completed first tasks - offer space patrol mission
	//-- NPC: Excellent and good work. Let me take a look at these. Hmmm... this is odd. There's a crate in this shipment with no identification. I do not know what that could be or why it is in my shipment. While I look into this, I ask that you launch into Corellia space and trace the route flown by the transport delivering the shipment. Maybe you'll find a clue as to what happened.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Understood. I'll launch into Corellia space.
	if (response == "s_104")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition_hasOtherSpaceMission (player, npc))
		{
			//-- NPC: Oh my, it looks like you already have a mission for space. Talk to me again when you've completed it and are ready for a new space mission.
			string_id message = new string_id (c_stringFile, "s_160");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (!greeter_coronet_merchant_condition_playerHasShip (player, npc))
		{
			greeter_coronet_merchant_action_giveShip (player, npc);

			//-- NPC: I appreciate your enthusiasm, but it appears you don't have a ship. Here take this one, I don't need it anymore, and it should be more than adequate for your needs.
			string_id message = new string_id (c_stringFile, "s_53");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Thank you, I will make good use of it.
			boolean hasResponse0 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_54");

				utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 22);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			greeter_coronet_merchant_action_givePatrolMission (player, npc);

			//-- NPC: Thank you. Return and report anything out of the ordinary to me.
			string_id message = new string_id (c_stringFile, "s_106");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't think I'm interested. But good luck.
	if (response == "s_105")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well. I'll try to pursue this on my own.
			string_id message = new string_id (c_stringFile, "s_107");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch22 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I appreciate your enthusiasm, but it appears you don't have a ship. Here take this one, I don't need it anymore, and it should be more than adequate for your needs.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Thank you, I will make good use of it.
	if (response == "s_54")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition_hasOtherSpaceMission (player, npc))
		{
			//-- NPC: Oh my, it looks like you already have a mission for space. Talk to me again when you've completed it and are ready for a new space mission.
			string_id message = new string_id (c_stringFile, "s_160");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (!greeter_coronet_merchant_condition_playerHasShip (player, npc))
		{
			greeter_coronet_merchant_action_giveShip (player, npc);

			//-- NPC: I appreciate your enthusiasm, but it appears you don't have a ship. Here take this one, I don't need it anymore, and it should be more than adequate for your needs.
			string_id message = new string_id (c_stringFile, "s_53");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Thank you, I will make good use of it.
			boolean hasResponse0 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_54");

				utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 22);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			greeter_coronet_merchant_action_givePatrolMission (player, npc);

			//-- NPC: Thank you. Return and report anything out of the ordinary to me.
			string_id message = new string_id (c_stringFile, "s_106");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch28 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] intial greeting
	//-- NPC: Greetings and welcome to Coronet. I apologize for my fading enthusiasm, but I've been waiting for quite some time for a shipment of goods to arrive. These two shipwrights have been waiting with me, and one of them is becoming especially belligerent.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why are they waiting with you?
	if (response == "s_80e2ba26")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: They ordered some parts from me, and those parts should be in the missing shipment. I gave them a good price, but the long wait seems to have eroded their goodwill.
			string_id message = new string_id (c_stringFile, "s_82cd91e");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: That's too bad. I hope your goods arrive soon.
			boolean hasResponse0 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_d48167e1");

				utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 29);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch29 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: They ordered some parts from me, and those parts should be in the missing shipment. I gave them a good price, but the long wait seems to have eroded their goodwill.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: That's too bad. I hope your goods arrive soon.
	if (response == "s_d48167e1")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "laugh_cackle");

			//-- NPC: Thank you for the kind words. It's more important than you might realize. I've put all of my available funds into this shipment. Without it I cannot complete my starships and uphold the construction contracts for them. I could lose everything.
			string_id message = new string_id (c_stringFile, "s_8ae971c3");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I wish I could do something to help.
			boolean hasResponse0 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_89");

				utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 30);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch30 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Thank you for the kind words. It's more important than you might realize. I've put all of my available funds into this shipment. Without it I cannot complete my starships and uphold the construction contracts for them. I could lose everything.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I wish I could do something to help.
	if (response == "s_89")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			//-- NPC: Maybe you can. You could help me track down my missing shipment. If you're able to find it, then not only will I be able to fulfill the order these two gentlemen placed, but I'll also be able to complete construction on my own starships.
			string_id message = new string_id (c_stringFile, "s_91");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What would I need to do?
			boolean hasResponse0 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_92");

				utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 31);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch31 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Maybe you can. You could help me track down my missing shipment. If you're able to find it, then not only will I be able to fulfill the order these two gentlemen placed, but I'll also be able to complete construction on my own starships.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What would I need to do?
	if (response == "s_92")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			//-- NPC: To start, go speak with my assistant, Abagga Creel, and get a shipment invoice for the missing shipment. She's at our office building here in Coronet. Also, speak to the starport master and get a shipping schedule for the transport that was supposed to make the delivery.
			string_id message = new string_id (c_stringFile, "s_94");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Okay, I'll do it.
			boolean hasResponse0 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No thanks. I'm not interested.
			boolean hasResponse1 = false;
			if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_96");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_97");

				utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 32);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int greeter_coronet_merchant_handleBranch32 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: To start, go speak with my assistant, Abagga Creel, and get a shipment invoice for the missing shipment. She's at our office building here in Coronet. Also, speak to the starport master and get a shipping schedule for the transport that was supposed to make the delivery.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Okay, I'll do it.
	if (response == "s_96")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			greeter_coronet_merchant_action_beginMissingShipment (player, npc);

			//-- NPC: Thank you! Return to me when you have both the invoice and the schedule.
			string_id message = new string_id (c_stringFile, "s_98");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No thanks. I'm not interested.
	if (response == "s_97")
	{
		//-- [NOTE] 
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			//-- NPC: I understand. Hopefully it'll arrive soon anyway.
			string_id message = new string_id (c_stringFile, "s_99");
			utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.greeter_coronet_merchant");

	setCondition (self, CONDITION_CONVERSABLE);
	setInvulnerable( self, true );
	setCondition( self, CONDITION_SPACE_INTERESTING );

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setInvulnerable( self, true );
	setCondition( self, CONDITION_SPACE_INTERESTING );

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);

	faceTo( self, player );

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	setCondition( self, CONDITION_SPACE_INTERESTING );
	
	detachScript (self, "conversation.greeter_coronet_merchant");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] Generic Greeting. Player does not have the space expansion.
	if (greeter_coronet_merchant_condition_notOnMissingShipment (player, npc))
	{
		doAnimationAction (npc, "laugh_titter");

		doAnimationAction (player, "shrug_shoulders");

		//-- NPC: Greetings and welcome to Coronet. I apologize, but I don't have time to chat right now. If you'll excuse me.
		string_id message = new string_id (c_stringFile, "s_198d9a41");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (greeter_coronet_merchant_condition_questComplete (player, npc))
	{
		//-- NPC: Welcome! I cannot thank you enough for your assistance. Thank you once again!
		string_id message = new string_id (c_stringFile, "s_156");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] found stolen shipment at the capitol building
	if (greeter_coronet_merchant_condition_foundShipment (player, npc))
	{
		//-- NPC: The missing shipment was at the capitol building? Unbelievable. I'll send some droids to go retrieve it. And the mystery crate contained spice? I'm astounded. Why in the world would a smuggled crate of spice end up at the capitol building? You don't think this involved the Diktat, do you? No, that's patently absurd, isn't it?  I'll have to alert CorSec of all this. Not that there's much they can do at this point. Thank you, though, for your help!
		string_id message = new string_id (c_stringFile, "s_124");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: It was my pleasure.
		boolean hasResponse0 = false;
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_125");

			utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 3);

			npcStartConversation (player, npc, "greeter_coronet_merchant", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] defeated tomi jinsin
	if (greeter_coronet_merchant_condition_goGetShipment (player, npc))
	{
		//-- NPC: You defeated Tomi? Well, I suppose it would come to that sooner or later. If you would, please, go to the capitol and find out if my shipment is really there. I cannot imagine why it would be at the capitol building.
		string_id message = new string_id (c_stringFile, "s_123");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] defeated enough ragtags
	if (greeter_coronet_merchant_condition_foundTomiBunker (player, npc))
	{
		//-- NPC: Go to that bunker where Tomi is hiding and make him explain to you what is going on with all this.
		string_id message = new string_id (c_stringFile, "s_122");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (greeter_coronet_merchant_condition_intimidateRagtags (player, npc))
	{
		//-- NPC: Go pressure some Ragtags into revealing where to find Tomi Jinsin. You should be able to find some on the outskirts of the city. They are usually loitering around and harassing people.
		string_id message = new string_id (c_stringFile, "s_155");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] completed space patrol mission
	if (greeter_coronet_merchant_condition_sawRagtagFighters (player, npc))
	{
		//-- NPC: Attacked by Ragtags? Those thugs who plague the planet? And amid the debris of what looked like the destroyed engines of large freighter or transport, no less. Very interesting.
		string_id message = new string_id (c_stringFile, "s_109");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Did you discover anything about the strange crate in your shipment?
		boolean hasResponse0 = false;
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_114");

			utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 8);

			npcStartConversation (player, npc, "greeter_coronet_merchant", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] failed or aborted space patrol mission
	if (greeter_coronet_merchant_condition_failedSpacePatrol (player, npc))
	{
		greeter_coronet_merchant_action_clearFailedPatrol (player, npc);

		//-- NPC: You didn't find anything? Nothing at all? Would you please go look again? I just know there must be some clue as to what happened out there. Maybe the transport broke down. Or was attacked. Please look again and be sure to fly the entire route.
		string_id message = new string_id (c_stringFile, "s_108");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Okay, I'll go look again.
		boolean hasResponse0 = false;
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I don't think so. I'm done with this.
		boolean hasResponse1 = false;
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_110");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_111");

			utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 13);

			npcStartConversation (player, npc, "greeter_coronet_merchant", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (greeter_coronet_merchant_condition_hasSpacePatrol (player, npc))
	{
		//-- NPC: Launch into space and trace the route taken by the transport that was to deliver my shipment. Return to me when you've completed that and report anything out of the ordinary that happens.
		string_id message = new string_id (c_stringFile, "s_159");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (greeter_coronet_merchant_condition_faliedSpaceQuest (player, npc))
	{
		//-- NPC: What's the problem?
		string_id message = new string_id (c_stringFile, "s_47");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I need the route information again.
		boolean hasResponse0 = false;
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_48");

			utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 17);

			npcStartConversation (player, npc, "greeter_coronet_merchant", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] completed first tasks - offer space patrol mission
	if (greeter_coronet_merchant_condition_gotBothInvoiceAndSchedule (player, npc))
	{
		greeter_coronet_merchant_action_signalPatrolMission (player, npc);

		//-- NPC: Excellent and good work. Let me take a look at these. Hmmm... this is odd. There's a crate in this shipment with no identification. I do not know what that could be or why it is in my shipment. While I look into this, I ask that you launch into Corellia space and trace the route flown by the transport delivering the shipment. Maybe you'll find a clue as to what happened.
		string_id message = new string_id (c_stringFile, "s_103");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Understood. I'll launch into Corellia space.
		boolean hasResponse0 = false;
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I don't think I'm interested. But good luck.
		boolean hasResponse1 = false;
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_104");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_105");

			utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 20);

			npcStartConversation (player, npc, "greeter_coronet_merchant", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] has invoice but not schedule
	if (greeter_coronet_merchant_condition_getSchedule (player, npc))
	{
		//-- NPC: You have the shipment invoice, but I also need the shipping schedule. Speak with the starport master and ask for the shipping schedule for the transport delivering my shipment.
		string_id message = new string_id (c_stringFile, "s_100");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] has shipping schedule but not invoice
	if (greeter_coronet_merchant_condition_getInvoice (player, npc))
	{
		//-- NPC: You have the shipping schedule, but I still need the shipment invoice. Go speak to my assistant, Abagga Creel, and ask her for it.
		string_id message = new string_id (c_stringFile, "s_102");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] has first tasks but completed neither
	if (greeter_coronet_merchant_condition_getInvoiceAndSchedule (player, npc))
	{
		//-- NPC: Go speak to my assistant, Abagga Creel, and ask her for the shipment invoice. Also, speak with the starport master and ask for the shipping schedule for the transport delivering my shipment.
		string_id message = new string_id (c_stringFile, "s_101");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] intial greeting
	if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
	{
		doAnimationAction (npc, "beckon");

		//-- NPC: Greetings and welcome to Coronet. I apologize for my fading enthusiasm, but I've been waiting for quite some time for a shipment of goods to arrive. These two shipwrights have been waiting with me, and one of them is becoming especially belligerent.
		string_id message = new string_id (c_stringFile, "s_4a019574");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Why are they waiting with you?
		boolean hasResponse0 = false;
		if (greeter_coronet_merchant_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_80e2ba26");

			utils.setScriptVar (player, "conversation.greeter_coronet_merchant.branchId", 28);

			npcStartConversation (player, npc, "greeter_coronet_merchant", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "greeter_coronet_merchant")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

	if (branchId == 3 && greeter_coronet_merchant_handleBranch3 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 8 && greeter_coronet_merchant_handleBranch8 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 9 && greeter_coronet_merchant_handleBranch9 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 10 && greeter_coronet_merchant_handleBranch10 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 13 && greeter_coronet_merchant_handleBranch13 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && greeter_coronet_merchant_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && greeter_coronet_merchant_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 22 && greeter_coronet_merchant_handleBranch22 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 28 && greeter_coronet_merchant_handleBranch28 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 29 && greeter_coronet_merchant_handleBranch29 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 30 && greeter_coronet_merchant_handleBranch30 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 31 && greeter_coronet_merchant_handleBranch31 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 32 && greeter_coronet_merchant_handleBranch32 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.greeter_coronet_merchant.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

