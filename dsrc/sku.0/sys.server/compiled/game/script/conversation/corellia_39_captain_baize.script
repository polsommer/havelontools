// ======================================================================
//
// corellia_39_captain_baize.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.35 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.groundquests;
include library.space_quest;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/corellia_39_captain_baize";

// ======================================================================
// Script Conditions
// ======================================================================

boolean corellia_39_captain_baize_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_assumedIdentityContinuedA (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "corellia_39_chirq_council_02") &&
	groundquests.hasCompletedTask(player, "corellia_39_chirq_council_02", "chirq_council_02_03");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_assumedIdentityComplete (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_39_chirq_council_02b", "chirq_council_02_07") ||
	groundquests.hasCompletedQuest(player, "corellia_39_chirq_council_02b");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_assumedIdentityFailed (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "corellia_39_chirq_council_02_failed");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_assumedIdentityContinuedB (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "corellia_39_chirq_council_02");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_movingUpSpiceActive (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "corellia_39_chirq_council_03") &&
	!groundquests.isTaskActive(player, "corellia_39_chirq_council_03", "chirq_council_03_03");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_movingUpSpiceComplete (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_39_chirq_council_03", "chirq_council_03_03");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_readyFor39 (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_38_corsec_files_03", "corsec_files_03_01") ||
	groundquests.hasCompletedQuest(player, "corellia_38_corsec_files_05");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_movingUpCoverUpA (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "corellia_39_chirq_council_03") &&
	groundquests.hasCompletedTask(player, "corellia_39_chirq_council_03", "chirq_council_03_03");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_movingUpCoverUpB (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "corellia_39_chirq_council_03");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_movingUpCorsecTerminal (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_39_chirq_council_03", "chirq_council_03_08");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_AllCompleted (obj_id player, obj_id npc)
{
	return 	groundquests.hasCompletedQuest(player, "corellia_39_chirq_council_04");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_seekCouncilActive (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "corellia_39_chirq_council_01");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_seekCouncilComplete (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_39_chirq_council_01", "chirq_council_01_08") ||
	groundquests.hasCompletedQuest(player, "corellia_39_chirq_council_01");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_assumedIdentityTrinsActive (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "corellia_39_chirq_council_02") &&
	!groundquests.isTaskActive(player, "corellia_39_chirq_council_02", "chirq_council_02_03");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_assumedIdentityTrinsComplete (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_39_chirq_council_02", "chirq_council_02_03");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_movingUpComplete (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_39_chirq_council_03b", "chirq_council_03_11") ||
	groundquests.hasCompletedQuest(player, "corellia_39_chirq_council_03b");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_eliteCouncilActive (obj_id player, obj_id npc)
{
	return  groundquests.isQuestActive(player, "corellia_39_chirq_council_04");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_eliteCouncilComplete (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_39_chirq_council_04", "chirq_council_04_03");
}

// ----------------------------------------------------------------------

boolean corellia_39_captain_baize_condition_needs40Pointer (obj_id player, obj_id npc)
{
	return !groundquests.isQuestActiveOrComplete(player, "talus_nashal_goto_agent") &&
	!groundquests.isQuestActiveOrComplete(player, "talus_nashal_goto_kiki");
}

// ======================================================================
// Script Actions
// ======================================================================

void corellia_39_captain_baize_action_regrant_assumedIdentityB (obj_id player, obj_id npc)
{
	if ( !groundquests.isQuestActive(player, "corellia_39_chirq_council_02b") )
	{
		groundquests.grantQuest(player, "corellia_39_chirq_council_02b");
	}
	return;
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_signal_assumedIdentityFailed (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "chirq_council_02_failed");
	groundquests.grantQuest(player, "corellia_39_chirq_council_02b");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_signal_assumedIdentityComplete (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "chirq_council_02_07");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_grant_movingUp (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "corellia_39_chirq_council_03");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_signal_movingUpSpice (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "chirq_council_03_03");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_regrant_movingUpB (obj_id player, obj_id npc)
{
	if ( !groundquests.isQuestActive(player, "corellia_39_chirq_council_03b") )
	{
		groundquests.grantQuest(player, "corellia_39_chirq_council_03b");
	}
	return;
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_signal_movingUpComplete (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "chirq_council_03_11");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_signal_39Pointer (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "corellia_39_pointer_01");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_grant_seekCouncil (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "corellia_39_chirq_council_01");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_signal_seekCouncilComplete (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "chirq_council_01_08");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_grant_assumedIdentity (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "corellia_39_chirq_council_02");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_signal_assumedIdentityTrins (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "chirq_council_02_03");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_gant_eliteCouncil (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "corellia_39_chirq_council_04");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_signal_eliteCouncilComplete (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "chirq_council_04_03");
}

// ----------------------------------------------------------------------

void corellia_39_captain_baize_action_grant_40Pointer (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "talus_nashal_goto_agent");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

string corellia_39_captain_baize_tokenTO_playersName (obj_id player, obj_id npc)
{
    string name = getName(player);
    string firstName = "agent";
    if ( name != null )
    {
        java.util.StringTokenizer tok = new java.util.StringTokenizer(name);

        if ( tok.hasMoreTokens() )
        {
        	firstName = tok.nextToken();
        }
    }
    
	return firstName;
}

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int corellia_39_captain_baize_handleBranch1 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The hero returns. Corellia is a much safer place, thanks to you. Don't get me wrong, there are plenty of other dangers out there. But the Chirq Council threatened to be one of the worst. We're well rid of them. Thank you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am happy to have been of service.
	if (response == "s_93")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			corellia_39_captain_baize_action_grant_40Pointer (player, npc);

			//-- NPC: Thank you. And your service might continue, if you wish. Agent Taarna would like to speak with you.
			string_id message = new string_id (c_stringFile, "s_94");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch3 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Magnificently done! Reports are already coming in that say the Chirq Council is splintering. Without the discipline and motivation provided by the Elite Council, they are turning on one another and falling to pieces. You have done a remarkable job, and your service to Corellia has not gone unnoticed.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Thank you. It was my honor.
	if (response == "s_76")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "salute2");

			corellia_39_captain_baize_action_grant_40Pointer (player, npc);

			//-- NPC: No, the honor was all mine. Though apparently others wish to share in that honor. CorSec agent Taarna wishes to speak with you, though I do not know the reason.
			string_id message = new string_id (c_stringFile, "s_78");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch6 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We have it! We know now that the Chirq Council is governed by nine members who call themselves the Elite Council. Your next task is simple enough, though quite dangerous: Eliminate the Elite Council.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Don't worry. I can take care of them.
	if (response == "s_47")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			//-- NPC: I have no doubt. According to the information you downloaded from Jzoro, the Elite Council has two bases outside of town. Start with the one south of town. 
			string_id message = new string_id (c_stringFile, "s_48");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm on my way.
			boolean hasResponse0 = false;
			if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_74");

				utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 7);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch7 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I have no doubt. According to the information you downloaded from Jzoro, the Elite Council has two bases outside of town. Start with the one south of town. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm on my way.
	if (response == "s_74")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			corellia_39_captain_baize_action_gant_eliteCouncil (player, npc);

			//-- NPC: Good luck, and may the Force be with you.
			string_id message = new string_id (c_stringFile, "s_75");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You were warned NOT to harm any of the Pendretronics employees. Luckily, our Public Relations department was able to convince Kazic Pendre, as well as the local media, that it was a botched robbery. Which means, you might have another chance to go after Pendre. But don't make the same mistake again! Do you understand?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, I understand.
	if (response == "s_89")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			corellia_39_captain_baize_action_signal_assumedIdentityFailed (player, npc);

			//-- NPC: Good. Let's not go through this again.
			string_id message = new string_id (c_stringFile, "s_90");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch16 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well done thus far, but the most dangerous part is next. Trins Evnar reported to Kazic Pendre, who, in turn, reported to a man named Jzoro Quanera. You need to report to Jzoro and convince him that you're ready to move up in the organization.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm on my way.
	if (response == "s_67")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			//-- NPC: You'll find Jzoro Quanera in a bunker outside of town. You might want to be careful venturing too far into his bunker. Most of his henchmen don't trust strangers and are likely to attack you.
			string_id message = new string_id (c_stringFile, "s_68");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'll be careful.
			boolean hasResponse0 = false;
			if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_69");

				utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I need to take a small break for a while
	if (response == "s_36")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			//-- NPC: I see. Well, I suppose this is as good a time as any.
			string_id message = new string_id (c_stringFile, "s_37");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You'll find Jzoro Quanera in a bunker outside of town. You might want to be careful venturing too far into his bunker. Most of his henchmen don't trust strangers and are likely to attack you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'll be careful.
	if (response == "s_69")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "laugh");

			corellia_39_captain_baize_action_grant_movingUp (player, npc);

			//-- NPC: I'm sure you will.
			string_id message = new string_id (c_stringFile, "s_70");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch22 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Based on the information you gathered at Trins Evnar's house, we now know who his direct contacts within the Chirq Council were. You will need to take them down in order to insure that they cannot get in your way.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'll get started immediately.
	if (response == "s_72")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			corellia_39_captain_baize_action_signal_assumedIdentityTrins (player, npc);

			//-- NPC: Very good. We'll upload coordinates to you as you need them.
			string_id message = new string_id (c_stringFile, "s_73");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch25 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well done. We've put Trins Evnar under observation and have no doubt of his connection to the Chirq Council. Now you will take his place. Most people in the Chirq Council will only  know Trins Evnar by name, but a few will know his face, gender, and species. We'll need to find out who they are and make certain that they cannot hinder your progress.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How do I get started?
	if (response == "s_57")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			//-- NPC:  First, you need to go to Trins Evnar's house and take his place. Be sure to collect as much data on him as you can while you're there.
			string_id message = new string_id (c_stringFile, "s_58");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm on my way.
			boolean hasResponse0 = false;
			if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_63");

				utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 26);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch26 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC:  First, you need to go to Trins Evnar's house and take his place. Be sure to collect as much data on him as you can while you're there.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm on my way.
	if (response == "s_63")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			corellia_39_captain_baize_action_grant_assumedIdentity (player, npc);

			//-- NPC: Good luck to you.
			string_id message = new string_id (c_stringFile, "s_64");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch29 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well met, %TO. I trust Lt. Cope has already briefed you on your mission here in Doaba Guerfel. If we are to bring down the Chirq Council, we must do so from within. Therefore, you will need to infiltrate the Chirq Council as one of their own. Once you've done that, we can take down their leaders.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What do you need me to do?
	if (response == "s_80")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			//-- NPC: First we need to find a confirmed member of the Chirq Council. To help with that, you will contact an undercover agent already working here in Doaba Guerfel. She will have your best leads on finding someone in the Chirq Council. She awaits you at the shuttleport.
			string_id message = new string_id (c_stringFile, "s_82");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'll go speak with her.
			boolean hasResponse0 = false;
			if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't have time to help with this right now.
			boolean hasResponse1 = false;
			if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_84");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_88");

				utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 30);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_39_captain_baize_handleBranch30 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: First we need to find a confirmed member of the Chirq Council. To help with that, you will contact an undercover agent already working here in Doaba Guerfel. She will have your best leads on finding someone in the Chirq Council. She awaits you at the shuttleport.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'll go speak with her.
	if (response == "s_84")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			corellia_39_captain_baize_action_grant_seekCouncil (player, npc);

			//-- NPC: Good. Be careful not to blow her cover.
			string_id message = new string_id (c_stringFile, "s_86");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't have time to help with this right now.
	if (response == "s_88")
	{
		//-- [NOTE] 
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			//-- NPC: I see. For the sake of this investigation, I hope that you can make time soon. Or perhaps I'll give the assignment to the next person who comes along.
			string_id message = new string_id (c_stringFile, "s_92");
			utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.corellia_39_captain_baize");

	setCondition (self, CONDITION_CONVERSABLE);

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	
	faceTo( self, player );

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.corellia_39_captain_baize");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_AllCompleted (player, npc))
	{
		//-- NPC: The hero returns. Corellia is a much safer place, thanks to you. Don't get me wrong, there are plenty of other dangers out there. But the Chirq Council threatened to be one of the worst. We're well rid of them. Thank you.
		string_id message = new string_id (c_stringFile, "s_77");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I am happy to have been of service.
		boolean hasResponse0 = false;
		if (corellia_39_captain_baize_condition_needs40Pointer (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_93");

			utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 1);

			npcStartConversation (player, npc, "corellia_39_captain_baize", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_eliteCouncilComplete (player, npc))
	{
		corellia_39_captain_baize_action_signal_eliteCouncilComplete (player, npc);

		//-- NPC: Magnificently done! Reports are already coming in that say the Chirq Council is splintering. Without the discipline and motivation provided by the Elite Council, they are turning on one another and falling to pieces. You have done a remarkable job, and your service to Corellia has not gone unnoticed.
		string_id message = new string_id (c_stringFile, "s_49");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Thank you. It was my honor.
		boolean hasResponse0 = false;
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_76");

			utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 3);

			npcStartConversation (player, npc, "corellia_39_captain_baize", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_eliteCouncilActive (player, npc))
	{
		//-- NPC: Eliminate all members of the Elite Council. Our hope is that without its leadership, that the Chirq Council will dissolve into chaos and disarray.
		string_id message = new string_id (c_stringFile, "s_51");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_movingUpComplete (player, npc))
	{
		corellia_39_captain_baize_action_signal_movingUpComplete (player, npc);

		//-- NPC: We have it! We know now that the Chirq Council is governed by nine members who call themselves the Elite Council. Your next task is simple enough, though quite dangerous: Eliminate the Elite Council.
		string_id message = new string_id (c_stringFile, "s_42");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Don't worry. I can take care of them.
		boolean hasResponse0 = false;
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_47");

			utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 6);

			npcStartConversation (player, npc, "corellia_39_captain_baize", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_movingUpCoverUpB (player, npc))
	{
		corellia_39_captain_baize_action_regrant_movingUpB (player, npc);

		//-- NPC: Once you've gained Jzoro's trust, download all information he has about the Chirq Council from his central mainframe. We should be able to determine who the leaders of the Chirq Council are from that information.
		string_id message = new string_id (c_stringFile, "s_39");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_movingUpCorsecTerminal (player, npc))
	{
		//-- NPC: You have been authorized to use this terminal to make a fake CorSec ID. Go ahead.
		string_id message = new string_id (c_stringFile, "s_41");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_movingUpCoverUpA (player, npc))
	{
		//-- NPC: From reports I've gathered, you are making headway with Jzoro. Soon he'll trust you enough to let you access his central computers. Keep up the good work.
		string_id message = new string_id (c_stringFile, "s_38");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_movingUpSpiceComplete (player, npc))
	{
		corellia_39_captain_baize_action_signal_movingUpSpice (player, npc);

		//-- NPC: Good. We'll switch the spice you collected with some poor quality spice that we've diluted with a common medicinal powder. It's unlikely that Jzoro will notice, but even if he does, he'll blame the Monumenters.
		string_id message = new string_id (c_stringFile, "s_40");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_movingUpSpiceActive (player, npc))
	{
		//-- NPC: Work with Jzoro as best you can to prove your loyalty, but be sure not to commit any actual crimes. I'll help you with that, if needed.
		string_id message = new string_id (c_stringFile, "s_71");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_assumedIdentityFailed (player, npc))
	{
		doAnimationAction (npc, "blame");

		//-- NPC: You were warned NOT to harm any of the Pendretronics employees. Luckily, our Public Relations department was able to convince Kazic Pendre, as well as the local media, that it was a botched robbery. Which means, you might have another chance to go after Pendre. But don't make the same mistake again! Do you understand?
		string_id message = new string_id (c_stringFile, "s_34");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yes, I understand.
		boolean hasResponse0 = false;
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_89");

			utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 14);

			npcStartConversation (player, npc, "corellia_39_captain_baize", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_assumedIdentityComplete (player, npc))
	{
		corellia_39_captain_baize_action_signal_assumedIdentityComplete (player, npc);

		//-- NPC: Well done thus far, but the most dangerous part is next. Trins Evnar reported to Kazic Pendre, who, in turn, reported to a man named Jzoro Quanera. You need to report to Jzoro and convince him that you're ready to move up in the organization.
		string_id message = new string_id (c_stringFile, "s_66");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I'm on my way.
		boolean hasResponse0 = false;
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I need to take a small break for a while
		boolean hasResponse1 = false;
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_67");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_36");

			utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 16);

			npcStartConversation (player, npc, "corellia_39_captain_baize", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_assumedIdentityContinuedB (player, npc))
	{
		corellia_39_captain_baize_action_regrant_assumedIdentityB (player, npc);

		//-- NPC: Be careful when going after Kazic Pendre. As far as we can tell, all of the employees at his business, Pendretronics, are normal, hard working people with no criminal records. Do not harm any of them.
		string_id message = new string_id (c_stringFile, "s_35");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_assumedIdentityContinuedA (player, npc))
	{
		//-- NPC: Continue to eliminate Trins Evnar's Chirq Council contacts.
		string_id message = new string_id (c_stringFile, "s_65");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_assumedIdentityTrinsComplete (player, npc))
	{
		//-- NPC: Based on the information you gathered at Trins Evnar's house, we now know who his direct contacts within the Chirq Council were. You will need to take them down in order to insure that they cannot get in your way.
		string_id message = new string_id (c_stringFile, "s_62");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I'll get started immediately.
		boolean hasResponse0 = false;
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_72");

			utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 22);

			npcStartConversation (player, npc, "corellia_39_captain_baize", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_assumedIdentityTrinsActive (player, npc))
	{
		//-- NPC: Trins Evnar must be removed from the area, and information about his contacts within the Chirq Council must be collected.
		string_id message = new string_id (c_stringFile, "s_61");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_seekCouncilComplete (player, npc))
	{
		corellia_39_captain_baize_action_signal_seekCouncilComplete (player, npc);

		//-- NPC: Well done. We've put Trins Evnar under observation and have no doubt of his connection to the Chirq Council. Now you will take his place. Most people in the Chirq Council will only  know Trins Evnar by name, but a few will know his face, gender, and species. We'll need to find out who they are and make certain that they cannot hinder your progress.
		string_id message = new string_id (c_stringFile, "s_56");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: How do I get started?
		boolean hasResponse0 = false;
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_57");

			utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 25);

			npcStartConversation (player, npc, "corellia_39_captain_baize", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_seekCouncilActive (player, npc))
	{
		//-- NPC: Continue your investigation into the attempted assassination of the mayor of Kor Vella.
		string_id message = new string_id (c_stringFile, "s_55");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition_readyFor39 (player, npc))
	{
		corellia_39_captain_baize_action_signal_39Pointer (player, npc);

		//-- NPC: Well met, %TO. I trust Lt. Cope has already briefed you on your mission here in Doaba Guerfel. If we are to bring down the Chirq Council, we must do so from within. Therefore, you will need to infiltrate the Chirq Council as one of their own. Once you've done that, we can take down their leaders.
		string_id message = new string_id (c_stringFile, "s_60");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What do you need me to do?
		boolean hasResponse0 = false;
		if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_80");

			utils.setScriptVar (player, "conversation.corellia_39_captain_baize.branchId", 29);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);
			pp.other.set (corellia_39_captain_baize_tokenTO_playersName (player, npc));

			npcStartConversation (player, npc, "corellia_39_captain_baize", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);
			pp.other.set (corellia_39_captain_baize_tokenTO_playersName (player, npc));

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_39_captain_baize_condition__defaultCondition (player, npc))
	{
		//-- NPC: Crime rates have risen all over Corellia lately. It is up to the Corellian Security Forces to find out why.
		string_id message = new string_id (c_stringFile, "s_96");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "corellia_39_captain_baize")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

	if (branchId == 1 && corellia_39_captain_baize_handleBranch1 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 3 && corellia_39_captain_baize_handleBranch3 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 6 && corellia_39_captain_baize_handleBranch6 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 7 && corellia_39_captain_baize_handleBranch7 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && corellia_39_captain_baize_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 16 && corellia_39_captain_baize_handleBranch16 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && corellia_39_captain_baize_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 22 && corellia_39_captain_baize_handleBranch22 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 25 && corellia_39_captain_baize_handleBranch25 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 26 && corellia_39_captain_baize_handleBranch26 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 29 && corellia_39_captain_baize_handleBranch29 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 30 && corellia_39_captain_baize_handleBranch30 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.corellia_39_captain_baize.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

