// ======================================================================
//
// ep3_imp_dr_price.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.36 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.factions;
include library.groundquests;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/ep3_imp_dr_price";

// ======================================================================
// Script Conditions
// ======================================================================

boolean ep3_imp_dr_price_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean ep3_imp_dr_price_condition_hasCompletedQuest01 (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "ep3_imp_drprice");
}

// ----------------------------------------------------------------------

boolean ep3_imp_dr_price_condition_hasCompletedQuest02 (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "ep3_imp_cmd_richards");
}

// ----------------------------------------------------------------------

boolean ep3_imp_dr_price_condition_isReadyForDrPrice (obj_id player, obj_id npc)
{
	string factionName = factions.getFaction( player );
	if ( factionName == null || factionName == "" )
		return false;
		
	if (factionName.equals( factions.FACTION_IMPERIAL ))
		return true;
	
	else
		return false;		
}

// ----------------------------------------------------------------------

boolean ep3_imp_dr_price_condition_isOnQuest01 (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "ep3_imp_drprice");
}

// ----------------------------------------------------------------------

boolean ep3_imp_dr_price_condition_isOnTask01 (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "ep3_imp_drprice", 2);
}

// ----------------------------------------------------------------------

boolean ep3_imp_dr_price_condition_isOnQuest02 (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "ep3_imp_cmd_richards");
}

// ----------------------------------------------------------------------

boolean ep3_imp_dr_price_condition_isOnTask02 (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "ep3_imp_cmd_richards", 4);
}

// ======================================================================
// Script Actions
// ======================================================================

void ep3_imp_dr_price_action_grantQuest01 (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "ep3_imp_drprice");
}

// ----------------------------------------------------------------------

void ep3_imp_dr_price_action_sendSignal01 (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "completedDrPrice");
}

// ----------------------------------------------------------------------

void ep3_imp_dr_price_action_sendSignal02 (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "rewardDrPrice");
}

// ----------------------------------------------------------------------

void ep3_imp_dr_price_action_grantQuest02 (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "ep3_imp_cmd_richards");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int ep3_imp_dr_price_handleBranch2 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Hello again. I trust you had a pleasant adventure. I understand that the Avatar Platform is a fairly impressive installation. Did you manage to get me the other blood sample and the medical records?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yeah, I got them. But it wasn't easy.
	if (response == "s_323")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "listen");

			//-- NPC: Really? How wonderful! I am glad you enjoyed yourself. I will have to run some tests to make sure, but this should give me all the information that I need in order to make my report. Because you have done such a great job, I have been authorized to issue you some duty pay. I also have one of these hologram things that we were told to make sure that all of our troops received.
			string_id message = new string_id (c_stringFile, "s_324");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: A hologram?
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_325");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 3);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch3 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Really? How wonderful! I am glad you enjoyed yourself. I will have to run some tests to make sure, but this should give me all the information that I need in order to make my report. Because you have done such a great job, I have been authorized to issue you some duty pay. I also have one of these hologram things that we were told to make sure that all of our troops received.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: A hologram?
	if (response == "s_325")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "tap_head");

			ep3_imp_dr_price_action_sendSignal02 (player, npc);

			//-- NPC: Yes. They are supposed to inspire confidence or something. I am not really clear on the finer details of military moral. Now if you will excuse me I need to figure out how to make a man run faster then a katarn.
			string_id message = new string_id (c_stringFile, "s_326");
			utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch6 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Wh...what? Oh...you...you were the one who wanted to run from the katarn, right? Not a very good idea...the very thought that anyone could outrun a katarn is just foolish. The last volunteer made it roughly one and a half steps before becoming a meal.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Umm...no, I have your blood samples.
	if (response == "s_315")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "snap_finger1");

			//-- NPC: That is good news. I will take those from you, but I have been doing some thinking. The Trandoshans really do not have a facility on this planet that could maintain a strain of the Elo virus. When I realized that I said to myself, self where would the Trandoshans store such a virus? That is when it hit me...the Avatar Space Platform.
			string_id message = new string_id (c_stringFile, "s_316");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: The Avatar Space Platform?
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_317");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 7);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch7 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That is good news. I will take those from you, but I have been doing some thinking. The Trandoshans really do not have a facility on this planet that could maintain a strain of the Elo virus. When I realized that I said to myself, self where would the Trandoshans store such a virus? That is when it hit me...the Avatar Space Platform.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: The Avatar Space Platform?
	if (response == "s_317")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: The Trandoshans take all of the captured Wookiees there for retraining. It is my understanding that it has an extensive medical facility aboard. It would be my guess that is where they would infect the Wookiees if they are doing so. You need to get on board, get a blood sample from a Wookiee who went through the medical procedure, and steal their medical records. Good luck.
			string_id message = new string_id (c_stringFile, "s_318");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Wait a minute! How am I supposed to do that?
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_319");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 8);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch8 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The Trandoshans take all of the captured Wookiees there for retraining. It is my understanding that it has an extensive medical facility aboard. It would be my guess that is where they would infect the Wookiees if they are doing so. You need to get on board, get a blood sample from a Wookiee who went through the medical procedure, and steal their medical records. Good luck.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Wait a minute! How am I supposed to do that?
	if (response == "s_319")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shrug_hands");

			//-- NPC: I don't know. I am just a scientist, not a commando. Go talk to Commander Richards. He has been briefed on the situation and is supposed to have a plan. At least that is what I thought he said.
			string_id message = new string_id (c_stringFile, "s_320");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Why don't we just make the slavers turn over their records?
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_321");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 9);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch9 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I don't know. I am just a scientist, not a commando. Go talk to Commander Richards. He has been briefed on the situation and is supposed to have a plan. At least that is what I thought he said.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why don't we just make the slavers turn over their records?
	if (response == "s_321")
	{
		ep3_imp_dr_price_action_sendSignal01 (player, npc);

		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "check_wrist_device");

			ep3_imp_dr_price_action_grantQuest02 (player, npc);

			//-- NPC: Commander Richards seemed so excited about having a clandestine operation that I couldn't bear to not let him do it. Besides he said something about evidence being destroyed...proof lost...I didn't understand all his military jargon. Now, please excuse me...I need to figure out how to make a man run faster than a katarn.
			string_id message = new string_id (c_stringFile, "s_322");
			utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch12 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Eh? Oh, could you hold this for a moment...don't drop it...very toxic. Wait, on second thought maybe you should stand over there. Are you taking notes on all of this?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ummm, what?
	if (response == "s_297")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_forward");

			//-- NPC: Aren't you the new assistant that I requested from headquarters? Last one got eaten by a katarn...well mostly eaten anyways. Hmmm...how fast can you run? We can probably catch one if you can lead it up from the depths of the Rryatt Trail. Wait...what would I do with a katarn...maybe later.
			string_id message = new string_id (c_stringFile, "s_298");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I think you are confused. I am not your new lab assistant.
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Run from a katarn! That would be suicide!
			boolean hasResponse1 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_299");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_300");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 13);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch13 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Aren't you the new assistant that I requested from headquarters? Last one got eaten by a katarn...well mostly eaten anyways. Hmmm...how fast can you run? We can probably catch one if you can lead it up from the depths of the Rryatt Trail. Wait...what would I do with a katarn...maybe later.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I think you are confused. I am not your new lab assistant.
	if (response == "s_299")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: Oh, really? That is a shame...you certainly look fast. Well, since you are not my new assistant, who are you?
			string_id message = new string_id (c_stringFile, "s_304");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I was told you were looking for someone to gather samples.
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_305");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 14);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Run from a katarn! That would be suicide!
	if (response == "s_300")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			//-- NPC: You would only have to lead it up the trail a little ways. I am pretty sure they get quite focused while eating so we could sneak up and capture it without too much trouble. Think of all the wonderful things we could learn from a katarn...who knows what secrets we could unlock.
			string_id message = new string_id (c_stringFile, "s_301");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: But I would be dead!
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_302");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 20);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Oh, really? That is a shame...you certainly look fast. Well, since you are not my new assistant, who are you?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I was told you were looking for someone to gather samples.
	if (response == "s_305")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "smack_self");

			//-- NPC: Samples...samples...oh! Samples! Yes, I need to get several blood samples of various Wookiees. These samples then need to be brought to me for testing. 
			string_id message = new string_id (c_stringFile, "s_306");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What do you need their blood for?
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_307");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Samples...samples...oh! Samples! Yes, I need to get several blood samples of various Wookiees. These samples then need to be brought to me for testing. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What do you need their blood for?
	if (response == "s_307")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: We have discovered all the Wookiees we are using as labor are infected with a strain of the Elo virus. This causes them to live very short lifespans. Of course, this might be natural for the Wookiee species...they are rather a dirty race. But we suspect that the Trandoshans are infecting them with the virus before selling them to us.
			string_id message = new string_id (c_stringFile, "s_308");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Why would they do something like that?
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_309");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 16);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch16 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We have discovered all the Wookiees we are using as labor are infected with a strain of the Elo virus. This causes them to live very short lifespans. Of course, this might be natural for the Wookiee species...they are rather a dirty race. But we suspect that the Trandoshans are infecting them with the virus before selling them to us.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why would they do something like that?
	if (response == "s_309")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "rub_chin_thoughtful");

			//-- NPC: Why? Well, I have never studied this but I don't think a dead Wookiee is very good at labor. Therefore, we need to buy a replacement. So it is probably a marketing technique used by the Trandoshans to increase sales. If you could help me out collecting the blood samples we could know for certain.
			string_id message = new string_id (c_stringFile, "s_310");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ok, what is it you need me to do?
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No thanks. This isn't for me.
			boolean hasResponse1 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_311");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_312");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Why? Well, I have never studied this but I don't think a dead Wookiee is very good at labor. Therefore, we need to buy a replacement. So it is probably a marketing technique used by the Trandoshans to increase sales. If you could help me out collecting the blood samples we could know for certain.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ok, what is it you need me to do?
	if (response == "s_311")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			ep3_imp_dr_price_action_grantQuest01 (player, npc);

			//-- NPC: First, I need a sample from a Wookiee that has been recently captured by the Trandoshans.  After that, I need a sample from an untainted Wookiee. You can find Wookiees who would be perfect in some of the small villages in this area. Once you have those two samples, bring them back to me and we will go from there.
			string_id message = new string_id (c_stringFile, "s_313");
			utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No thanks. This isn't for me.
	if (response == "s_312")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			//-- NPC: Really? Oh well, maybe you would be interested in a katarn project that I just started. How fast are you?
			string_id message = new string_id (c_stringFile, "s_314");
			utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You would only have to lead it up the trail a little ways. I am pretty sure they get quite focused while eating so we could sneak up and capture it without too much trouble. Think of all the wonderful things we could learn from a katarn...who knows what secrets we could unlock.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: But I would be dead!
	if (response == "s_302")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			//-- NPC: Hmmm, so you would. I still think it is a sound plan and...wait a moment, I didn't send in my request forms for a new assistant yet. If you are not my new assistant, who are you?
			string_id message = new string_id (c_stringFile, "s_303");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I was told you were looking for someone to gather samples.
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_305");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 14);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_imp_dr_price_handleBranch21 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Hmmm, so you would. I still think it is a sound plan and...wait a moment, I didn't send in my request forms for a new assistant yet. If you are not my new assistant, who are you?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I was told you were looking for someone to gather samples.
	if (response == "s_305")
	{
		//-- [NOTE] 
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "smack_self");

			//-- NPC: Samples...samples...oh! Samples! Yes, I need to get several blood samples of various Wookiees. These samples then need to be brought to me for testing. 
			string_id message = new string_id (c_stringFile, "s_306");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What do you need their blood for?
			boolean hasResponse0 = false;
			if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_307");

				utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.ep3_imp_dr_price");

	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);
	setInvulnerable (self, true);
	setName(self, "Dr. Price");

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);
	setInvulnerable (self, true);
	setName(self, "Dr. Price");

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	setCondition (self, CONDITION_CONVERSABLE);
	faceTo(self, player);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.ep3_imp_dr_price");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (ep3_imp_dr_price_condition_hasCompletedQuest02 (player, npc))
	{
		doAnimationAction (npc, "shrug_hands");

		//-- NPC: Oh, it's you again. I am afraid that I have nothing left for you to do. I just got a new assistant who looks very fast, so I don't even think I will need you to run from the katarn. Thank you for asking though.
		string_id message = new string_id (c_stringFile, "s_43");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_imp_dr_price_condition_isOnTask02 (player, npc))
	{
		doAnimationAction (npc, "greet");

		//-- NPC: Hello again. I trust you had a pleasant adventure. I understand that the Avatar Platform is a fairly impressive installation. Did you manage to get me the other blood sample and the medical records?
		string_id message = new string_id (c_stringFile, "s_264");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yeah, I got them. But it wasn't easy.
		boolean hasResponse0 = false;
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_323");

			utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 2);

			npcStartConversation (player, npc, "ep3_imp_dr_price", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_imp_dr_price_condition_isOnQuest02 (player, npc))
	{
		doAnimationAction (npc, "standing_placate");

		//-- NPC: No...no...no. I do not wish to talk to you right now. You are to report to Commander Richards. He is the one who has your mission objectives all prepared.
		string_id message = new string_id (c_stringFile, "s_42");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_imp_dr_price_condition_isOnTask01 (player, npc))
	{
		doAnimationAction (npc, "point_forward");

		//-- NPC: Wh...what? Oh...you...you were the one who wanted to run from the katarn, right? Not a very good idea...the very thought that anyone could outrun a katarn is just foolish. The last volunteer made it roughly one and a half steps before becoming a meal.
		string_id message = new string_id (c_stringFile, "s_266");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Umm...no, I have your blood samples.
		boolean hasResponse0 = false;
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_315");

			utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 6);

			npcStartConversation (player, npc, "ep3_imp_dr_price", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_imp_dr_price_condition_isOnQuest01 (player, npc))
	{
		doAnimationAction (npc, "wave_on_dismissing");

		//-- NPC: Unless you have my Wookiee blood samples, I do not have time to talk with you. They sent me an assistant who is not very swift at all...perhaps I can modify him with a mixture of benzo....
		string_id message = new string_id (c_stringFile, "s_265");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_imp_dr_price_condition_isReadyForDrPrice (player, npc))
	{
		doAnimationAction (npc, "wave_finger_warning");

		//-- NPC: Eh? Oh, could you hold this for a moment...don't drop it...very toxic. Wait, on second thought maybe you should stand over there. Are you taking notes on all of this?
		string_id message = new string_id (c_stringFile, "s_267");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Ummm, what?
		boolean hasResponse0 = false;
		if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_297");

			utils.setScriptVar (player, "conversation.ep3_imp_dr_price.branchId", 12);

			npcStartConversation (player, npc, "ep3_imp_dr_price", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_imp_dr_price_condition__defaultCondition (player, npc))
	{
		doAnimationAction (npc, "explain");

		//-- NPC: I am afraid that I am extremely busy and do not have time to talk to you. Now where was I? Oh, yes...the haemoglobin seems to be infected with a strain of traso....
		string_id message = new string_id (c_stringFile, "s_268");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "ep3_imp_dr_price")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

	if (branchId == 2 && ep3_imp_dr_price_handleBranch2 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 3 && ep3_imp_dr_price_handleBranch3 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 6 && ep3_imp_dr_price_handleBranch6 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 7 && ep3_imp_dr_price_handleBranch7 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 8 && ep3_imp_dr_price_handleBranch8 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 9 && ep3_imp_dr_price_handleBranch9 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 12 && ep3_imp_dr_price_handleBranch12 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 13 && ep3_imp_dr_price_handleBranch13 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && ep3_imp_dr_price_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && ep3_imp_dr_price_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 16 && ep3_imp_dr_price_handleBranch16 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && ep3_imp_dr_price_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && ep3_imp_dr_price_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 21 && ep3_imp_dr_price_handleBranch21 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.ep3_imp_dr_price.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

