// ======================================================================
//
// tatooine_knives_fencing_valarian.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.37 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.conversation;
include library.features;
include library.groundquests;
include library.space_quest;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/tatooine_knives_fencing_valarian";

// ======================================================================
// Script Conditions
// ======================================================================

boolean tatooine_knives_fencing_valarian_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_failSpace (obj_id player, obj_id npc)
{
	return space_quest.hasFailedQuest(player, "assassinate", "tatooine_knives_riposte_assassinate") ||
		   space_quest.hasAbortedQuest(player, "assassinate", "tatooine_knives_riposte_assassinate");
}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_TandPrewarded (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_fencing");
	int finishTPreward = groundquests.getTaskId(questId1, "tatooine_knives_fencing_e3"); 
	
	boolean onTask = questIsTaskActive(questId1, finishTPreward, player);
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_QuestComplete (obj_id player, obj_id npc)
{
	int questId1 = questGetQuestId("quest/tatooine_knives_fencing");
	int questId2 = questGetQuestId("quest/tatooine_knives_fencing_pt_2");
	
	boolean OnTask = (questIsQuestComplete(questId1, player))&& !((features.isSpaceEdition( player)))
					|| ((questIsQuestComplete(questId1, player)) && (questIsQuestComplete(questId2, player)));
	
	return OnTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_completeTandP (obj_id player, obj_id npc)
{

	int questId1 = questGetQuestId("quest/tatooine_knives_thrust");
	int questId2 = questGetQuestId("quest/tatooine_knives_parry_pt2");
	int questId3 = questGetQuestId("quest/tatooine_knives_fencing_reward");
	
	boolean OnTask= 	(questIsQuestComplete(questId1, player))&&(questIsQuestComplete(questId2, player))&&(questIsQuestActive(questId3, player));
						
	return OnTask;					
						
	
}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_physcoHasJTL (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_fencing");

	boolean onTask = 	questIsQuestComplete(questId1, player)&& features.isSpaceEdition( player );
	
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_onPhysco (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_fencing");
	int finishBank = groundquests.getTaskId(questId1, "tatooine_knives_fencing_e85"); 
	
	boolean onTask = questIsTaskActive(questId1, finishBank, player);
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_thrustComplete (obj_id player, obj_id npc)
{
	int questId1 = questGetQuestId("quest/tatooine_knives_thrust");
	int questId2 = questGetQuestId("quest/tatooine_knives_fencing_reward");
	
	boolean OnTask = 	(questIsQuestComplete(questId1, player))&&(questIsQuestActive(questId2, player));
	
	return OnTask;


}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_parryComplete (obj_id player, obj_id npc)
{
	int questId1 = questGetQuestId("quest/tatooine_knives_parry_pt2");
	int questId2 = questGetQuestId("quest/tatooine_knives_fencing_reward");
	
	boolean OnTask = 	(questIsQuestComplete(questId1, player))&&(questIsQuestActive(questId2, player));
	
	return OnTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_onUna (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_fencing");
	int finishBank = groundquests.getTaskId(questId1, "tatooine_knives_fencing_e45"); 
	
	boolean onTask = questIsTaskActive(questId1, finishBank, player);
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_unaComplete (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_fencing");
	int keelaQuestioned = groundquests.getTaskId(questId1, "tatooine_knives_fencing_e7"); 
	
	boolean onTask = questIsTaskActive(questId1, keelaQuestioned, player);
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_onKeela (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_fencing");
	int finishBank = groundquests.getTaskId(questId1, "tatooine_knives_fencing_e6"); 
	
	boolean onTask = questIsTaskActive(questId1, finishBank, player);
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_spaceCompleted (obj_id player, obj_id npc)
{
	if (space_quest.hasWonQuest( player, "assassinate", "tatooine_knives_riposte_assassinate" ))
		return true;
	
	return false;
}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_squadComplete (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_fencing_pt_2");
	int onspace = groundquests.getTaskId(questId1, "tatooine_knives_fencing_e17"); 
	
	boolean onTask = questIsTaskActive(questId1, onspace, player);
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_physcoDead (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_fencing");
	int tatooine_knives_fencing_valarian_condition_physcoDead = groundquests.getTaskId(questId1, "tatooine_knives_fencing_e85"); 
	
	boolean onTask = (questIsTaskComplete(questId1, tatooine_knives_fencing_valarian_condition_physcoDead, player));
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_isThisDisabled (obj_id player, obj_id npc)
{
	return groundquests.isQuestDisabled ("tatooine_knives_thrust") ||
		groundquests.isQuestDisabled ("tatooine_knives_parry") ||
		groundquests.isQuestDisabled ("tatooine_knives_fencing");
}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_onIntercept (obj_id player, obj_id npc)
{
	if (groundquests.isQuestActive(player,"quest/tatooine_knives_fencing_pt_2")
		&&!space_quest.hasWonQuest( player, "assassinate", "tatooine_knives_riposte_assassinate" ))
		return true;
	
	return false;
}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_hasPrologContentQuest (obj_id player, obj_id npc)
{
	faceTo(npc, player);
	return groundquests.isTaskActive(player, "quest/quest_05_frame_valarians", "defeatAssassinLadyValarian");
}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_wave_event_active (obj_id player, obj_id npc)
{
	int wave = utils.getIntScriptVar(npc, "waveEventCurrentWave");
	return  wave > 0;
}

// ----------------------------------------------------------------------

boolean tatooine_knives_fencing_valarian_condition_hasGetReparations (obj_id player, obj_id npc)
{
	faceTo(npc, player);
	return groundquests.isTaskActive(player, "quest/quest_05_frame_valarians_success_assassin", "getReparations");
}

// ======================================================================
// Script Actions
// ======================================================================

void tatooine_knives_fencing_valarian_action_facePlayer (obj_id player, obj_id npc)
{
	faceTo(npc, player);
}

// ----------------------------------------------------------------------

void tatooine_knives_fencing_valarian_action_giveIntercept (obj_id player, obj_id npc)
{	
	

	groundquests.clearQuest(player,"tatooine_knives_fencing_pt_2");
	groundquests.grantQuest(player,"tatooine_knives_fencing_pt_2");
	
	space_quest.clearQuestFlags( player, "assassinate", "tatooine_knives_riposte_assassinate" );
	space_quest.grantQuest( player, "assassinate", "tatooine_knives_riposte_assassinate" );

}

// ----------------------------------------------------------------------

void tatooine_knives_fencing_valarian_action_signalPhyscoReward (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "tatooine_knives_fencing_launch_e10");
}

// ----------------------------------------------------------------------

void tatooine_knives_fencing_valarian_action_signalPhysco (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "tatooine_knives_fencing_launch_e8");
}

// ----------------------------------------------------------------------

void tatooine_knives_fencing_valarian_action_signalReward (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "tatooine_knives_fencing_launch_e18");
}

// ----------------------------------------------------------------------

void tatooine_knives_fencing_valarian_action_signalUna (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "tatooine_knives_fencing_launch_e4");
}

// ----------------------------------------------------------------------

void tatooine_knives_fencing_valarian_action_content_valarian_assassin (obj_id player, obj_id npc)
{
	dictionary webster = new dictionary();
	webster.put("player", player);
	messageTo(npc, "waveEventControllerNPCStart", webster, 0, false);
}

// ----------------------------------------------------------------------

void tatooine_knives_fencing_valarian_action_payReparations (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "hasReceivedReparations");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int tatooine_knives_fencing_valarian_handleBranch1 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Grrrrr. How much to make you go away?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: 3,000 credits.
	if (response == "s_166")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			tatooine_knives_fencing_valarian_action_payReparations (player, npc);

			//-- NPC: I have transfered the amount directly to Jabba. NOW LEAVE!
			string_id message = new string_id (c_stringFile, "s_167");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch4 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Who thinks they can speak to Lady Valarian?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: [Backhand]
	if (response == "s_101")
	{
		doAnimationAction (player, "backhand");

		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "scream");

			tatooine_knives_fencing_valarian_action_content_valarian_assassin (player, npc);

			//-- NPC: You shall pay for this!!
			string_id message = new string_id (c_stringFile, "s_153");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Uh...Jabba has a bone to pick with you.
	if (response == "s_155")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "scream");

			tatooine_knives_fencing_valarian_action_content_valarian_assassin (player, npc);

			//-- NPC: Is this some sort of joke?  Titus! Take out the trash.
			string_id message = new string_id (c_stringFile, "s_157");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I have come to collect reparations for the death of Jabba's...uh labratory assistant, Bera Jeza. 
	if (response == "s_158")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: Bera what?  Never heard of her.
			string_id message = new string_id (c_stringFile, "s_159");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: How did you know it was a 'her?'
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_160");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 7);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch7 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Bera what?  Never heard of her.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How did you know it was a 'her?'
	if (response == "s_160")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: Look lacky. I don't have to explain anything to you. I had nothing to do with her death. I'm not interested in escalating anything with Jabba at the moment.
			string_id message = new string_id (c_stringFile, "s_161");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I didn't come here to argue, just collect. 3,000 credits should be enough compensation for the loss of the labratory assistant.
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_162");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 8);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch8 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Look lacky. I don't have to explain anything to you. I had nothing to do with her death. I'm not interested in escalating anything with Jabba at the moment.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I didn't come here to argue, just collect. 3,000 credits should be enough compensation for the loss of the labratory assistant.
	if (response == "s_162")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "scream");

			tatooine_knives_fencing_valarian_action_content_valarian_assassin (player, npc);

			//-- NPC: Insolence!  Titus!  Handle this fool.
			string_id message = new string_id (c_stringFile, "s_164");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch11 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] One or both quests are complete
	//-- NPC: I have been impressed. Nothing is simple at the Lucky Despot but you seemed to navigate the chaos quite well. I will have need of someone like you in the future.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I look forward to that.
	if (response == "s_76")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: A pleasure as always.
			string_id message = new string_id (c_stringFile, "s_77");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well done. But I seemed to have angered the minuscule worm known as Jabba. Are you ready for a final task?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Down load the information to my pad.
	if (response == "s_141")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: This job must be done in public. Finish this now.
			string_id message = new string_id (c_stringFile, "s_144");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What must I do?
	if (response == "s_142")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: Jabba is sending an assassination squad after me. My people here can protect me, but I want Jabba humbled, You will ambush the squad in public before they can arrive at the Lucky Despot. 
			string_id message = new string_id (c_stringFile, "s_145");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am on my way.
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_146");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 16);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I need to rest and refresh myself. 
	if (response == "s_143")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "dismiss");

			//-- NPC: I understand. Come back when you can be more accommodating.
			string_id message = new string_id (c_stringFile, "s_112");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch16 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Jabba is sending an assassination squad after me. My people here can protect me, but I want Jabba humbled, You will ambush the squad in public before they can arrive at the Lucky Despot. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am on my way.
	if (response == "s_146")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: This job must be done in public. Finish this now.
			string_id message = new string_id (c_stringFile, "s_144");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The ship escaped!!!! I hope I was not a fool in trusting you. Do you wish to try again?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes I want to redeem myself.
	if (response == "s_55")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			tatooine_knives_fencing_valarian_action_giveIntercept (player, npc);

			//-- NPC: You must intercept them soon. 
			string_id message = new string_id (c_stringFile, "s_129");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Not right now.
	if (response == "s_57")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: Reconsider your position my friend. 
			string_id message = new string_id (c_stringFile, "s_58");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Jabba still has not fully paid off for his effrontery. Are you ready to serve me again?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes. Upload the information to my datapad. 
	if (response == "s_128")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			tatooine_knives_fencing_valarian_action_giveIntercept (player, npc);

			//-- NPC: You must intercept them soon. 
			string_id message = new string_id (c_stringFile, "s_129");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What am I to do now?
	if (response == "s_131")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: I wish to punish Jabba. From my own informant in his ranks I have learned that he is shipping spice out to the Rebel Alliance. I want that ship destroyed
			string_id message = new string_id (c_stringFile, "s_132");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: They are as good as destroyed.
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Both of you supply the Alliance?
			boolean hasResponse1 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_133");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_135");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 22);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I must see to other needs right now.
	if (response == "s_134")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "dismiss");

			//-- NPC: I understand. Come back when you can be more accommodating.
			string_id message = new string_id (c_stringFile, "s_112");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch22 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I wish to punish Jabba. From my own informant in his ranks I have learned that he is shipping spice out to the Rebel Alliance. I want that ship destroyed

	//-- [RESPONSE NOTE] 
	//-- PLAYER: They are as good as destroyed.
	if (response == "s_133")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			tatooine_knives_fencing_valarian_action_giveIntercept (player, npc);

			//-- NPC: You must intercept them soon. 
			string_id message = new string_id (c_stringFile, "s_129");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Both of you supply the Alliance?
	if (response == "s_135")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "laugh");

			//-- NPC: We supply a market. Imperial, Rebel, it does not matter. Wars are good for business, especially my business. But Jabba must be taught a lesson. Now go out and destroy that ship!]
			string_id message = new string_id (c_stringFile, "s_136");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I have other matters to attend to first. 
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I am on my way.
			boolean hasResponse1 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_137");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_138");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 23);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch23 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We supply a market. Imperial, Rebel, it does not matter. Wars are good for business, especially my business. But Jabba must be taught a lesson. Now go out and destroy that ship!]

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I have other matters to attend to first. 
	if (response == "s_137")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "dismiss");

			//-- NPC: I understand. Come back when you can be more accommodating.
			string_id message = new string_id (c_stringFile, "s_112");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am on my way.
	if (response == "s_138")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			tatooine_knives_fencing_valarian_action_giveIntercept (player, npc);

			//-- NPC: You must intercept them soon. 
			string_id message = new string_id (c_stringFile, "s_129");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch24 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Player completed killing Physco and will get his reward
	//-- NPC: So Keska' Cay is dead. I thank you for that. I am still not finished with that Hutt worm though. Talk to me soon about how you could further serve me. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I look forward to that.
	if (response == "s_74")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: go and enjoy yourself.
			string_id message = new string_id (c_stringFile, "s_75");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch26 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: My informants say Keska' Cay still lives. Eliminate him now!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: He is as good as dead.
	if (response == "s_72")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: I hope so.
			string_id message = new string_id (c_stringFile, "s_73");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch28 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well done. Keela's information is illuminating. Jabba has overstep himself and must be punished. Are you ready for another assignment?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Always. Just load the details into my datapad.
	if (response == "s_119")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			tatooine_knives_fencing_valarian_action_signalPhysco (player, npc);

			//-- NPC: This one is dangerous. But I am greatly angered and I can not allow Una's treachery to be used by Jabba unpunished.
			string_id message = new string_id (c_stringFile, "s_120");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am on my way.
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_70");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 29);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What exactly am I to do?
	if (response == "s_122")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: Una betrayed one of my smugglers, who was running weapons and explosives to the Rebel Alliance. The assassin is a psychotic killer known as Keska' Cay. I want him killed.
			string_id message = new string_id (c_stringFile, "s_123");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: It would be my pleasure. 
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I need some time to think this over.
			boolean hasResponse1 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_124");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_125");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 31);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I need some time to rest first. 
	if (response == "s_121")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "dismiss");

			//-- NPC: I understand. Come back when you can be more accommodating.
			string_id message = new string_id (c_stringFile, "s_112");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch29 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: This one is dangerous. But I am greatly angered and I can not allow Una's treachery to be used by Jabba unpunished.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am on my way.
	if (response == "s_70")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good luck.
			string_id message = new string_id (c_stringFile, "s_71");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch31 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Una betrayed one of my smugglers, who was running weapons and explosives to the Rebel Alliance. The assassin is a psychotic killer known as Keska' Cay. I want him killed.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: It would be my pleasure. 
	if (response == "s_124")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			tatooine_knives_fencing_valarian_action_signalPhysco (player, npc);

			//-- NPC: This one is dangerous. But I am greatly angered and I can not allow Una's treachery to be used by Jabba unpunished.
			string_id message = new string_id (c_stringFile, "s_120");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am on my way.
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_70");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 29);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I need some time to think this over.
	if (response == "s_125")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "dismiss");

			//-- NPC: I understand. Come back when you can be more accommodating.
			string_id message = new string_id (c_stringFile, "s_112");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch32 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: So Una is dead. But where is my information? I must know what that traitor told the Hutts.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will go back to get it.
	if (response == "s_69")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good.
			string_id message = new string_id (c_stringFile, "s_79");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch34 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I will not speak to you until you have dealt with the traitor Una.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Una will die soon.
	if (response == "s_82")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: See that he does.
			string_id message = new string_id (c_stringFile, "s_84");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch36 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I have a real traitor in my happy family here. Are you willing to help me?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Just give me the details. 
	if (response == "s_107")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: [I have a real traitor. Una has been selling information about my operations to Jabba the Hutt. And that worm is attacking my operations. So find out what Una has told Jabba ... and then kill Una
			string_id message = new string_id (c_stringFile, "s_108");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Tell me where you think this character is.
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I am not ready to go up against the Hutts like that.
			boolean hasResponse1 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_114");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_113");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 37);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Not right now.
	if (response == "s_111")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "dismiss");

			//-- NPC: I understand. Come back when you can be more accommodating.
			string_id message = new string_id (c_stringFile, "s_112");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch37 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: [I have a real traitor. Una has been selling information about my operations to Jabba the Hutt. And that worm is attacking my operations. So find out what Una has told Jabba ... and then kill Una

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Tell me where you think this character is.
	if (response == "s_114")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			tatooine_knives_fencing_valarian_action_signalUna (player, npc);

			//-- NPC: Here is where your target's last know location. Bring me his head. 
			string_id message = new string_id (c_stringFile, "s_115");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am not ready to go up against the Hutts like that.
	if (response == "s_113")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "dismiss");

			//-- NPC: I understand. Come back when you can be more accommodating.
			string_id message = new string_id (c_stringFile, "s_112");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch40 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Starting general Node. 
	//-- NPC: Welcome to the Lucky Despot. Whatever your tastes, whatever you vice, I am sure we can fill your every need.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will keep that in mind.
	if (response == "s_96")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: A pleasure meeting you.
			string_id message = new string_id (c_stringFile, "s_98");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I have some information about your man Ind that could interest you.
	if (response == "s_102")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			//-- NPC: And what would that be?
			string_id message = new string_id (c_stringFile, "s_104");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ind masterminded the hit on your cash courier. He deposited the cash in a secret account. Here is the proof. 
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_110");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 42);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Kavas is playing you false. Do you want to know how?
	if (response == "s_168")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "belly_laugh");

			//-- NPC: Yes I know all about how Ind and Kavas are trying to get me to ...eliminate... the other. I also know of each other's current plot.  
			string_id message = new string_id (c_stringFile, "s_149");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: You know about this?
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_151");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 43);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You need to know what Kavas and Ind are up to Lady.
	if (response == "s_170")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "belly_laugh");

			//-- NPC: Yes I know all about how Ind and Kavas are trying to get me to ...eliminate... the other. I also know of each other's current plot.  
			string_id message = new string_id (c_stringFile, "s_149");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: You know about this?
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_151");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 43);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch42 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: And what would that be?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ind masterminded the hit on your cash courier. He deposited the cash in a secret account. Here is the proof. 
	if (response == "s_110")
	{
		doAnimationAction (player, "standing_placate");

		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "belly_laugh");

			//-- NPC: Yes I know all about how Ind and Kavas are trying to get me to ...eliminate... the other. I also know of each other's current plot.  
			string_id message = new string_id (c_stringFile, "s_149");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: You know about this?
			boolean hasResponse0 = false;
			if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_151");

				utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 43);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_fencing_valarian_handleBranch43 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes I know all about how Ind and Kavas are trying to get me to ...eliminate... the other. I also know of each other's current plot.  

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You know about this?
	if (response == "s_151")
	{
		//-- [NOTE] 
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "belly_laugh");

			tatooine_knives_fencing_valarian_action_signalReward (player, npc);

			//-- NPC: Little one I know everything that happens in the Lucky Despot. Nothing happens without my gainsay. But I will need to discipline Ind and Kavas for getting out of hand. I thank you for coming to me. Here is a token of my appreciation. And if you wish more work, speak to me directly. 
			string_id message = new string_id (c_stringFile, "s_154");
			utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.tatooine_knives_fencing_valarian");

	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);
	setInvulnerable (self, true);
	setName (self, "Lady Valarian");
	ai_lib.setDefaultCalmBehavior( self, ai_lib.BEHAVIOR_SENTINEL );

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);
	setInvulnerable (self, true);
	setName (self, "Lady Valarian");
	ai_lib.setDefaultCalmBehavior( self, ai_lib.BEHAVIOR_SENTINEL );

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	setCondition (self, CONDITION_CONVERSABLE);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.tatooine_knives_fencing_valarian");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_hasGetReparations (player, npc))
	{
		//-- NPC: Grrrrr. How much to make you go away?
		string_id message = new string_id (c_stringFile, "s_163");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: 3,000 credits.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_166");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 1);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_wave_event_active (player, npc))
	{
		//-- NPC: I'm in the middle of something. I'll have to deal with you later.
		string_id message = new string_id (c_stringFile, "s_165");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_hasPrologContentQuest (player, npc))
	{
		//-- NPC: Who thinks they can speak to Lady Valarian?
		string_id message = new string_id (c_stringFile, "s_100");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: [Backhand]
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Uh...Jabba has a bone to pick with you.
		boolean hasResponse1 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: I have come to collect reparations for the death of Jabba's...uh labratory assistant, Bera Jeza. 
		boolean hasResponse2 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_101");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_155");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_158");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 4);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_isThisDisabled (player, npc))
	{
		//-- NPC: Please come back later.
		string_id message = new string_id (c_stringFile, "s_62");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] One or both quests are complete
	if (tatooine_knives_fencing_valarian_condition_QuestComplete (player, npc))
	{
		doAnimationAction (npc, "bow3");

		tatooine_knives_fencing_valarian_action_facePlayer (player, npc);

		//-- NPC: I have been impressed. Nothing is simple at the Lucky Despot but you seemed to navigate the chaos quite well. I will have need of someone like you in the future.
		string_id message = new string_id (c_stringFile, "s_105");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I look forward to that.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_76");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 11);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_squadComplete (player, npc))
	{
		tatooine_knives_fencing_valarian_action_signalReward (player, npc);

		//-- NPC: You have served me well. Jabba will not move on me for a long while. Here is a token of my appreciation. 
		string_id message = new string_id (c_stringFile, "s_148");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_spaceCompleted (player, npc))
	{
		//-- NPC: Well done. But I seemed to have angered the minuscule worm known as Jabba. Are you ready for a final task?
		string_id message = new string_id (c_stringFile, "s_140");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Down load the information to my pad.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: What must I do?
		boolean hasResponse1 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: I need to rest and refresh myself. 
		boolean hasResponse2 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_141");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_142");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_143");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 14);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_failSpace (player, npc))
	{
		//-- NPC: The ship escaped!!!! I hope I was not a fool in trusting you. Do you wish to try again?
		string_id message = new string_id (c_stringFile, "s_54");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yes I want to redeem myself.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Not right now.
		boolean hasResponse1 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_55");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_57");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 17);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_onIntercept (player, npc))
	{
		doAnimationAction (npc, "dismiss");

		tatooine_knives_fencing_valarian_action_facePlayer (player, npc);

		//-- NPC: Return when that ship is destroyed.
		string_id message = new string_id (c_stringFile, "s_139");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_physcoHasJTL (player, npc))
	{
		tatooine_knives_fencing_valarian_action_facePlayer (player, npc);

		//-- NPC: Jabba still has not fully paid off for his effrontery. Are you ready to serve me again?
		string_id message = new string_id (c_stringFile, "s_127");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yes. Upload the information to my datapad. 
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: What am I to do now?
		boolean hasResponse1 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: I must see to other needs right now.
		boolean hasResponse2 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_128");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_131");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_134");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 20);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] Player completed killing Physco and will get his reward
	if (tatooine_knives_fencing_valarian_condition_physcoDead (player, npc))
	{
		doAnimationAction (npc, "applause_excited");

		tatooine_knives_fencing_valarian_action_signalPhyscoReward (player, npc);

		//-- NPC: So Keska' Cay is dead. I thank you for that. I am still not finished with that Hutt worm though. Talk to me soon about how you could further serve me. 
		string_id message = new string_id (c_stringFile, "s_130");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I look forward to that.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_74");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 24);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_onPhysco (player, npc))
	{
		doAnimationAction (npc, "scream");

		tatooine_knives_fencing_valarian_action_facePlayer (player, npc);

		//-- NPC: My informants say Keska' Cay still lives. Eliminate him now!
		string_id message = new string_id (c_stringFile, "s_126");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: He is as good as dead.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_72");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 26);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_unaComplete (player, npc))
	{
		doAnimationAction (npc, "shiver");

		tatooine_knives_fencing_valarian_action_facePlayer (player, npc);

		//-- NPC: Well done. Keela's information is illuminating. Jabba has overstep himself and must be punished. Are you ready for another assignment?
		string_id message = new string_id (c_stringFile, "s_117");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Always. Just load the details into my datapad.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: What exactly am I to do?
		boolean hasResponse1 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: I need some time to rest first. 
		boolean hasResponse2 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_119");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_122");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_121");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 28);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_onKeela (player, npc))
	{
		tatooine_knives_fencing_valarian_action_facePlayer (player, npc);

		//-- NPC: So Una is dead. But where is my information? I must know what that traitor told the Hutts.
		string_id message = new string_id (c_stringFile, "s_118");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I will go back to get it.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_69");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 32);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_onUna (player, npc))
	{
		doAnimationAction (npc, "backhand");

		tatooine_knives_fencing_valarian_action_facePlayer (player, npc);

		//-- NPC: I will not speak to you until you have dealt with the traitor Una.
		string_id message = new string_id (c_stringFile, "s_116");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Una will die soon.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_82");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 34);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_fencing_valarian_condition_TandPrewarded (player, npc))
	{
		//-- NPC: I have a real traitor in my happy family here. Are you willing to help me?
		string_id message = new string_id (c_stringFile, "s_106");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Just give me the details. 
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Not right now.
		boolean hasResponse1 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_107");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_111");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 36);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] Starting general Node. 
	if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
	{
		doAnimationAction (npc, "bow");

		tatooine_knives_fencing_valarian_action_facePlayer (player, npc);

		//-- NPC: Welcome to the Lucky Despot. Whatever your tastes, whatever you vice, I am sure we can fill your every need.
		string_id message = new string_id (c_stringFile, "s_94");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I will keep that in mind.
		boolean hasResponse0 = false;
		if (tatooine_knives_fencing_valarian_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I have some information about your man Ind that could interest you.
		boolean hasResponse1 = false;
		if (tatooine_knives_fencing_valarian_condition_thrustComplete (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: Kavas is playing you false. Do you want to know how?
		boolean hasResponse2 = false;
		if (tatooine_knives_fencing_valarian_condition_parryComplete (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		//-- PLAYER: You need to know what Kavas and Ind are up to Lady.
		boolean hasResponse3 = false;
		if (tatooine_knives_fencing_valarian_condition_completeTandP (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse3 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_96");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_102");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_168");

			if (hasResponse3)
				responses [responseIndex++] = new string_id (c_stringFile, "s_170");

			utils.setScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId", 40);

			npcStartConversation (player, npc, "tatooine_knives_fencing_valarian", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "tatooine_knives_fencing_valarian")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

	if (branchId == 1 && tatooine_knives_fencing_valarian_handleBranch1 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 4 && tatooine_knives_fencing_valarian_handleBranch4 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 7 && tatooine_knives_fencing_valarian_handleBranch7 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 8 && tatooine_knives_fencing_valarian_handleBranch8 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 11 && tatooine_knives_fencing_valarian_handleBranch11 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && tatooine_knives_fencing_valarian_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 16 && tatooine_knives_fencing_valarian_handleBranch16 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && tatooine_knives_fencing_valarian_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && tatooine_knives_fencing_valarian_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 22 && tatooine_knives_fencing_valarian_handleBranch22 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 23 && tatooine_knives_fencing_valarian_handleBranch23 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 24 && tatooine_knives_fencing_valarian_handleBranch24 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 26 && tatooine_knives_fencing_valarian_handleBranch26 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 28 && tatooine_knives_fencing_valarian_handleBranch28 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 29 && tatooine_knives_fencing_valarian_handleBranch29 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 31 && tatooine_knives_fencing_valarian_handleBranch31 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 32 && tatooine_knives_fencing_valarian_handleBranch32 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 34 && tatooine_knives_fencing_valarian_handleBranch34 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 36 && tatooine_knives_fencing_valarian_handleBranch36 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 37 && tatooine_knives_fencing_valarian_handleBranch37 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 40 && tatooine_knives_fencing_valarian_handleBranch40 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 42 && tatooine_knives_fencing_valarian_handleBranch42 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 43 && tatooine_knives_fencing_valarian_handleBranch43 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.tatooine_knives_fencing_valarian.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

