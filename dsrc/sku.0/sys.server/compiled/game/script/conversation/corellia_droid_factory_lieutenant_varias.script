// ======================================================================
//
// corellia_droid_factory_lieutenant_varias.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.37 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.conversation;
include library.groundquests;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/corellia_droid_factory_lieutenant_varias";

// ======================================================================
// Script Conditions
// ======================================================================

boolean corellia_droid_factory_lieutenant_varias_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_isGotoActive (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "corellia_droid_bunker_cornel_goto");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_gotFirstQuest (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_completedHackQuest (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_completedLastQuest (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "corellia_droid_bunker_destroy_factory");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_CompletedLastQuestTask (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_droid_bunker_destroy_factory", "destroyedFactory");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_isLastQuestActive (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "corellia_droid_bunker_destroy_factory");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_readyForDestroyFactoryQuest (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "corellia_droid_bunker_activate_terminals") && groundquests.hasCompletedQuest(player, "corellia_droid_bunker_lost_patrol");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_notCompletedPreReqQuests (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "corellia_droid_bunker_lost_patrol") && !groundquests.hasCompletedQuest(player, "corellia_droid_bunker_activate_terminals");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_readyToFinishLostPatrol (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "corellia_droid_bunker_lost_patrol", "lostPatrolReportBack");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_workingOnLostPatrol (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "corellia_droid_bunker_lost_patrol") && !groundquests.isTaskActive(player, "corellia_droid_bunker_lost_patrol", "lostPatrolReportBack");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_beforeLostPatrol (obj_id player, obj_id npc)
{
	return !groundquests.isQuestActive(player, "corellia_droid_bunker_lost_patrol");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_completedLostPatrol (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "corellia_droid_bunker_lost_patrol");
}

// ----------------------------------------------------------------------

boolean corellia_droid_factory_lieutenant_varias_condition_offer_u13_quests (obj_id player, obj_id npc)
{
	if ( !U13_QUESTS_ENABLED )
	{
		return false;	
	}
	
	if ( groundquests.isQuestActiveOrComplete(player, "u13_vengeance_pointer") )
	{
		return false;
	}	
	return true;
}

// ======================================================================
// Script Actions
// ======================================================================

void corellia_droid_factory_lieutenant_varias_action_grantDestroyFactoryQuest (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "corellia_droid_bunker_destroy_factory");
}

// ----------------------------------------------------------------------

void corellia_droid_factory_lieutenant_varias_action_completeFactoryDestroyQuest (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "destroyedFactory");
}

// ----------------------------------------------------------------------

void corellia_droid_factory_lieutenant_varias_action_completeLostPatrol (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "lostPatrolReportBack");
}

// ----------------------------------------------------------------------

void corellia_droid_factory_lieutenant_varias_action_completeGoto (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "gotoVarias");
}

// ----------------------------------------------------------------------

void corellia_droid_factory_lieutenant_varias_action_grantLostPatrol (obj_id player, obj_id npc)
{
		groundquests.grantQuest(player, "corellia_droid_bunker_lost_patrol");
}

// ----------------------------------------------------------------------

void corellia_droid_factory_lieutenant_varias_action_grantVengeancePointer (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "u13_vengeance_pointer");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int corellia_droid_factory_lieutenant_varias_handleBranch1 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It's good to see you again. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm glad I could be of assistance.
	if (response == "s_58")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_grantVengeancePointer (player, npc);

			//-- NPC: Before you head off, I have a favor to ask. An associate of mine, Wernell Covington, is looking for someone of your skills to assist him with a personal matter. If you would, please travel to Rori and speak with him.
			string_id message = new string_id (c_stringFile, "s_53");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch2 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You managed to destroy the factory's control system? Thank you; with the production stopped, the crisis has been contained. We'll still need to defeat the remaining forces in there, but for now the disaster has been avoided.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm glad I could be of assistance.
	if (response == "s_52")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_grantVengeancePointer (player, npc);

			//-- NPC: Before you head off, I have a favor to ask. An associate of mine, Wernell Covington, is looking for someone of your skills to assist him with a personal matter. If you would, please travel to Rori and speak with him.
			string_id message = new string_id (c_stringFile, "s_53");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch5 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It looks like your work with Druno has paid off. Thanks to your effort, Druno has identified a way to destroy the factory's production capability.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: So what's the next step?
	if (response == "s_25")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: Druno has disabled the factory's backup systems. This means that if we can shut the factory down it won't be able to restart itself.
			string_id message = new string_id (c_stringFile, "s_26");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I might as well see this through.
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I think I've done enough for now. You'll need to find someone else.
			boolean hasResponse1 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_27");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_28");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 6);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch6 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Druno has disabled the factory's backup systems. This means that if we can shut the factory down it won't be able to restart itself.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I might as well see this through.
	if (response == "s_27")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_grantDestroyFactoryQuest (player, npc);

			//-- NPC: I knew we could count on you. Find the terminal and disable the production systems.
			string_id message = new string_id (c_stringFile, "s_29");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I think I've done enough for now. You'll need to find someone else.
	if (response == "s_28")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: I had hoped you'd help us in this, but I can't fault you.
			string_id message = new string_id (c_stringFile, "s_30");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch12 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You are the one Jornel mentioned? We could certainly use all the help we can get.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: So what can you tell me?
	if (response == "s_72")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_completedLastQuest (player, npc))
		{
			//-- NPC: It's good to see you again. 
			string_id message = new string_id (c_stringFile, "s_10");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm glad I could be of assistance.
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition_offer_u13_quests (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_58");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 1);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_CompletedLastQuestTask (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_completeFactoryDestroyQuest (player, npc);

			//-- NPC: You managed to destroy the factory's control system? Thank you; with the production stopped, the crisis has been contained. We'll still need to defeat the remaining forces in there, but for now the disaster has been avoided.
			string_id message = new string_id (c_stringFile, "s_11");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm glad I could be of assistance.
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition_offer_u13_quests (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_52");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 2);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_isLastQuestActive (player, npc))
		{
			//-- NPC: I still need you to disable the factory's control system.
			string_id message = new string_id (c_stringFile, "s_50");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_readyForDestroyFactoryQuest (player, npc))
		{
			//-- NPC: It looks like your work with Druno has paid off. Thanks to your effort, Druno has identified a way to destroy the factory's production capability.
			string_id message = new string_id (c_stringFile, "s_13");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So what's the next step?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_25");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 5);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_completedLostPatrol (player, npc))
		{
			//-- NPC: Thank you for finding our men. If you're looking to help out, talk to Druno Kener. He's working on finding a way to shut down the facility.
			string_id message = new string_id (c_stringFile, "s_19");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_readyToFinishLostPatrol (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_completeLostPatrol (player, npc);

			//-- NPC: You located Sergeant Hirka and his men? That's good news. When they failed to report back we feared the worst.
			string_id message = new string_id (c_stringFile, "s_21");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_workingOnLostPatrol (player, npc))
		{
			//-- NPC: Have you found any sign of Sergeant Hirka yet?
			string_id message = new string_id (c_stringFile, "s_23");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_isGotoActive (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_completeGoto (player, npc);

			//-- NPC: You are the one Jornel mentioned? We could certainly use all the help we can get.
			string_id message = new string_id (c_stringFile, "s_31");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So what can you tell me?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_72");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: If you are here to help I'm glad to see you. If not you are in the wrong place.
			string_id message = new string_id (c_stringFile, "s_34");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What's going on here?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_55");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 13);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch13 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: If you are here to help I'm glad to see you. If not you are in the wrong place.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What's going on here?
	if (response == "s_55")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: It all started when CorSec received reports of Clone War droids in the area. It didn't make much sense but we were dispatched from Coronet to investigate.
			string_id message = new string_id (c_stringFile, "s_57");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So what did you find?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_59");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 14);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It all started when CorSec received reports of Clone War droids in the area. It didn't make much sense but we were dispatched from Coronet to investigate.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: So what did you find?
	if (response == "s_59")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: It turned out that the cave here contains an old, fully automated droid factory. It must have been here since the Clone Wars, possibly built in preparation for a possible invasion of Corellia.
			string_id message = new string_id (c_stringFile, "s_61");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So what do you need me to do?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: How could a droid factory possibly end up here?
			boolean hasResponse1 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			//-- PLAYER: Why not call in more forces to deal with the droids?
			boolean hasResponse2 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse2 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_75");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_88");

				if (hasResponse2)
					responses [responseIndex++] = new string_id (c_stringFile, "s_102");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It turned out that the cave here contains an old, fully automated droid factory. It must have been here since the Clone Wars, possibly built in preparation for a possible invasion of Corellia.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: So what do you need me to do?
	if (response == "s_75")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: The first thing I need is for you to help me locate a group of men we initially sent into the cave to scout out the place. After their initial transmissions, we lost all contact. The patrol was led by an experienced officer, Sergeant Hirka. I want you to locate them, alive or dead and report back to me with what you find. Also you should talk to Druno Kerner and Sergeant Mener. They will have other tasks you might be interested in.
			string_id message = new string_id (c_stringFile, "s_76");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ok, I'll see what I can do.
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_105");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 16);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How could a droid factory possibly end up here?
	if (response == "s_88")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: My guess is that it was built covertly. That way droids from here could be used to cause chaos on the ground while the bulk of their forces engaged the planetary defenses from space.  However, during the Clone Wars, the droid army decided to bypass Corellia when they invaded the core worlds. Instead they struck directly at Coruscant. The invasion never happened so the factory was never activated, that is until now.
			string_id message = new string_id (c_stringFile, "s_90");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So why did the factory suddenly activate itself after all these years?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_92");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 18);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why not call in more forces to deal with the droids?
	if (response == "s_102")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: The planetary government wants to get this resolved quietly. They are worried that if word got out that we're having issues with armed combat droids, the Imperial forces would use it as a reason to deploy a large number of troops. This could result in the Empire taking a much greater level of control of the planet.
			string_id message = new string_id (c_stringFile, "s_104");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I guess that makes sense.
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_56");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 20);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch16 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The first thing I need is for you to help me locate a group of men we initially sent into the cave to scout out the place. After their initial transmissions, we lost all contact. The patrol was led by an experienced officer, Sergeant Hirka. I want you to locate them, alive or dead and report back to me with what you find. Also you should talk to Druno Kerner and Sergeant Mener. They will have other tasks you might be interested in.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ok, I'll see what I can do.
	if (response == "s_105")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_grantLostPatrol (player, npc);

			//-- NPC: Thank you.
			string_id message = new string_id (c_stringFile, "s_106");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch18 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: My guess is that it was built covertly. That way droids from here could be used to cause chaos on the ground while the bulk of their forces engaged the planetary defenses from space.  However, during the Clone Wars, the droid army decided to bypass Corellia when they invaded the core worlds. Instead they struck directly at Coruscant. The invasion never happened so the factory was never activated, that is until now.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: So why did the factory suddenly activate itself after all these years?
	if (response == "s_92")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: Your guess is as good as mine. I'd love to find out but dealing with the threat of the factory is the first priority.
			string_id message = new string_id (c_stringFile, "s_94");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So where do we start?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_48");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 19);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch19 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Your guess is as good as mine. I'd love to find out but dealing with the threat of the factory is the first priority.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: So where do we start?
	if (response == "s_48")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_completedLastQuest (player, npc))
		{
			//-- NPC: It's good to see you again. 
			string_id message = new string_id (c_stringFile, "s_10");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm glad I could be of assistance.
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition_offer_u13_quests (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_58");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 1);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_CompletedLastQuestTask (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_completeFactoryDestroyQuest (player, npc);

			//-- NPC: You managed to destroy the factory's control system? Thank you; with the production stopped, the crisis has been contained. We'll still need to defeat the remaining forces in there, but for now the disaster has been avoided.
			string_id message = new string_id (c_stringFile, "s_11");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm glad I could be of assistance.
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition_offer_u13_quests (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_52");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 2);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_isLastQuestActive (player, npc))
		{
			//-- NPC: I still need you to disable the factory's control system.
			string_id message = new string_id (c_stringFile, "s_50");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_readyForDestroyFactoryQuest (player, npc))
		{
			//-- NPC: It looks like your work with Druno has paid off. Thanks to your effort, Druno has identified a way to destroy the factory's production capability.
			string_id message = new string_id (c_stringFile, "s_13");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So what's the next step?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_25");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 5);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_completedLostPatrol (player, npc))
		{
			//-- NPC: Thank you for finding our men. If you're looking to help out, talk to Druno Kener. He's working on finding a way to shut down the facility.
			string_id message = new string_id (c_stringFile, "s_19");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_readyToFinishLostPatrol (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_completeLostPatrol (player, npc);

			//-- NPC: You located Sergeant Hirka and his men? That's good news. When they failed to report back we feared the worst.
			string_id message = new string_id (c_stringFile, "s_21");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_workingOnLostPatrol (player, npc))
		{
			//-- NPC: Have you found any sign of Sergeant Hirka yet?
			string_id message = new string_id (c_stringFile, "s_23");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_isGotoActive (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_completeGoto (player, npc);

			//-- NPC: You are the one Jornel mentioned? We could certainly use all the help we can get.
			string_id message = new string_id (c_stringFile, "s_31");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So what can you tell me?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_72");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: If you are here to help I'm glad to see you. If not you are in the wrong place.
			string_id message = new string_id (c_stringFile, "s_34");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What's going on here?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_55");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 13);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_droid_factory_lieutenant_varias_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The planetary government wants to get this resolved quietly. They are worried that if word got out that we're having issues with armed combat droids, the Imperial forces would use it as a reason to deploy a large number of troops. This could result in the Empire taking a much greater level of control of the planet.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I guess that makes sense.
	if (response == "s_56")
	{
		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_completedLastQuest (player, npc))
		{
			//-- NPC: It's good to see you again. 
			string_id message = new string_id (c_stringFile, "s_10");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm glad I could be of assistance.
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition_offer_u13_quests (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_58");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 1);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_CompletedLastQuestTask (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_completeFactoryDestroyQuest (player, npc);

			//-- NPC: You managed to destroy the factory's control system? Thank you; with the production stopped, the crisis has been contained. We'll still need to defeat the remaining forces in there, but for now the disaster has been avoided.
			string_id message = new string_id (c_stringFile, "s_11");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm glad I could be of assistance.
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition_offer_u13_quests (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_52");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 2);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_isLastQuestActive (player, npc))
		{
			//-- NPC: I still need you to disable the factory's control system.
			string_id message = new string_id (c_stringFile, "s_50");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_readyForDestroyFactoryQuest (player, npc))
		{
			//-- NPC: It looks like your work with Druno has paid off. Thanks to your effort, Druno has identified a way to destroy the factory's production capability.
			string_id message = new string_id (c_stringFile, "s_13");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So what's the next step?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_25");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 5);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_completedLostPatrol (player, npc))
		{
			//-- NPC: Thank you for finding our men. If you're looking to help out, talk to Druno Kener. He's working on finding a way to shut down the facility.
			string_id message = new string_id (c_stringFile, "s_19");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_readyToFinishLostPatrol (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_completeLostPatrol (player, npc);

			//-- NPC: You located Sergeant Hirka and his men? That's good news. When they failed to report back we feared the worst.
			string_id message = new string_id (c_stringFile, "s_21");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_workingOnLostPatrol (player, npc))
		{
			//-- NPC: Have you found any sign of Sergeant Hirka yet?
			string_id message = new string_id (c_stringFile, "s_23");
			utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition_isGotoActive (player, npc))
		{
			corellia_droid_factory_lieutenant_varias_action_completeGoto (player, npc);

			//-- NPC: You are the one Jornel mentioned? We could certainly use all the help we can get.
			string_id message = new string_id (c_stringFile, "s_31");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So what can you tell me?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_72");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			//-- NPC: If you are here to help I'm glad to see you. If not you are in the wrong place.
			string_id message = new string_id (c_stringFile, "s_34");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What's going on here?
			boolean hasResponse0 = false;
			if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_55");

				utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 13);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

const boolean U13_QUESTS_ENABLED = true;

trigger OnInitialize ()
{
	if ((!isTangible (self)) || (isPlayer (self)))
		detachScript(self, "conversation.corellia_droid_factory_lieutenant_varias");

	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	setCondition (self, CONDITION_CONVERSABLE);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.corellia_droid_factory_lieutenant_varias");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (corellia_droid_factory_lieutenant_varias_condition_completedLastQuest (player, npc))
	{
		//-- NPC: It's good to see you again. 
		string_id message = new string_id (c_stringFile, "s_10");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I'm glad I could be of assistance.
		boolean hasResponse0 = false;
		if (corellia_droid_factory_lieutenant_varias_condition_offer_u13_quests (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_58");

			utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 1);

			npcStartConversation (player, npc, "corellia_droid_factory_lieutenant_varias", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_droid_factory_lieutenant_varias_condition_CompletedLastQuestTask (player, npc))
	{
		corellia_droid_factory_lieutenant_varias_action_completeFactoryDestroyQuest (player, npc);

		//-- NPC: You managed to destroy the factory's control system? Thank you; with the production stopped, the crisis has been contained. We'll still need to defeat the remaining forces in there, but for now the disaster has been avoided.
		string_id message = new string_id (c_stringFile, "s_11");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I'm glad I could be of assistance.
		boolean hasResponse0 = false;
		if (corellia_droid_factory_lieutenant_varias_condition_offer_u13_quests (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_52");

			utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 2);

			npcStartConversation (player, npc, "corellia_droid_factory_lieutenant_varias", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_droid_factory_lieutenant_varias_condition_isLastQuestActive (player, npc))
	{
		//-- NPC: I still need you to disable the factory's control system.
		string_id message = new string_id (c_stringFile, "s_50");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_droid_factory_lieutenant_varias_condition_readyForDestroyFactoryQuest (player, npc))
	{
		//-- NPC: It looks like your work with Druno has paid off. Thanks to your effort, Druno has identified a way to destroy the factory's production capability.
		string_id message = new string_id (c_stringFile, "s_13");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: So what's the next step?
		boolean hasResponse0 = false;
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_25");

			utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 5);

			npcStartConversation (player, npc, "corellia_droid_factory_lieutenant_varias", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_droid_factory_lieutenant_varias_condition_completedLostPatrol (player, npc))
	{
		//-- NPC: Thank you for finding our men. If you're looking to help out, talk to Druno Kener. He's working on finding a way to shut down the facility.
		string_id message = new string_id (c_stringFile, "s_19");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_droid_factory_lieutenant_varias_condition_readyToFinishLostPatrol (player, npc))
	{
		corellia_droid_factory_lieutenant_varias_action_completeLostPatrol (player, npc);

		//-- NPC: You located Sergeant Hirka and his men? That's good news. When they failed to report back we feared the worst.
		string_id message = new string_id (c_stringFile, "s_21");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_droid_factory_lieutenant_varias_condition_workingOnLostPatrol (player, npc))
	{
		//-- NPC: Have you found any sign of Sergeant Hirka yet?
		string_id message = new string_id (c_stringFile, "s_23");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_droid_factory_lieutenant_varias_condition_isGotoActive (player, npc))
	{
		corellia_droid_factory_lieutenant_varias_action_completeGoto (player, npc);

		//-- NPC: You are the one Jornel mentioned? We could certainly use all the help we can get.
		string_id message = new string_id (c_stringFile, "s_31");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: So what can you tell me?
		boolean hasResponse0 = false;
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_72");

			utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 12);

			npcStartConversation (player, npc, "corellia_droid_factory_lieutenant_varias", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
	{
		//-- NPC: If you are here to help I'm glad to see you. If not you are in the wrong place.
		string_id message = new string_id (c_stringFile, "s_34");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What's going on here?
		boolean hasResponse0 = false;
		if (corellia_droid_factory_lieutenant_varias_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_55");

			utils.setScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId", 13);

			npcStartConversation (player, npc, "corellia_droid_factory_lieutenant_varias", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "corellia_droid_factory_lieutenant_varias")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

	if (branchId == 1 && corellia_droid_factory_lieutenant_varias_handleBranch1 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 2 && corellia_droid_factory_lieutenant_varias_handleBranch2 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 5 && corellia_droid_factory_lieutenant_varias_handleBranch5 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 6 && corellia_droid_factory_lieutenant_varias_handleBranch6 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 12 && corellia_droid_factory_lieutenant_varias_handleBranch12 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 13 && corellia_droid_factory_lieutenant_varias_handleBranch13 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && corellia_droid_factory_lieutenant_varias_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && corellia_droid_factory_lieutenant_varias_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 16 && corellia_droid_factory_lieutenant_varias_handleBranch16 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 18 && corellia_droid_factory_lieutenant_varias_handleBranch18 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 19 && corellia_droid_factory_lieutenant_varias_handleBranch19 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && corellia_droid_factory_lieutenant_varias_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.corellia_droid_factory_lieutenant_varias.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

