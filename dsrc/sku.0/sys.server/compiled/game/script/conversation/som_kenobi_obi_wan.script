// ======================================================================
//
// som_kenobi_obi_wan.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.35 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.groundquests;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/som_kenobi_obi_wan";

// ======================================================================
// Script Conditions
// ======================================================================

boolean som_kenobi_obi_wan_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_startFirstQuest (obj_id player, obj_id npc)
{
		if (isGod (player))
			return true;
		
		else if (groundquests.hasCompletedQuest (player, "som_kenobi_collectors_business_1")&&
				groundquests.hasCompletedQuest (player, "som_kenobi_cursed_shard_2")&&
				groundquests.hasCompletedQuest (player, "som_kenobi_hidden_treasure_2")&&
				groundquests.hasCompletedQuest (player, "som_kenobi_historian_2")&&
				groundquests.hasCompletedQuest (player, "som_kenobi_moral_choice_1")&&
				groundquests.hasCompletedQuest (player, "som_kenobi_reunite_shard_3")&&
				groundquests.hasCompletedQuest (player, "som_kenobi_samaritan_1")&&
				groundquests.hasCompletedQuest (player, "som_kenobi_serpent_shard_1")&&
				groundquests.hasCompletedQuest (player, "som_kenobi_symbiosis_1"))
		
			return true;
		else
			return false;
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_finishedQuestKilled (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "som_kenobi_main_quest_killed", "talkKenobi1");
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_finishedQuestSpared (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "som_kenobi_main_quest_spared", "talkKenobi1");
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_finishedQuest1 (obj_id player, obj_id npc)
{
	if (groundquests.isTaskActive(player, "som_kenobi_main_quest_killed", "talkKenobi1")||
		groundquests.isTaskActive(player, "som_kenobi_main_quest_spared", "talkKenobi1"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_atTheEntrance (obj_id player, obj_id npc)
{
	if (groundquests.isTaskActive(player, "som_kenobi_main_quest_3_visible", "talkKenobi3")||
		groundquests.isTaskActive(player, "som_kenobi_main_quest_3_b_visible", "talkKenobi3"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_onQuests (obj_id player, obj_id npc)
{
	if (groundquests.isQuestActive(player, "som_kenobi_main_quest_1")||
		groundquests.isQuestActive(player, "som_kenobi_main_quest_killed")||
		groundquests.isQuestActive(player, "som_kenobi_main_quest_spared")||
		groundquests.isQuestActive(player, "som_kenobi_main_quest_3_visible")||
		groundquests.isQuestActive(player, "som_kenobi_main_quest_3_b_visible"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_finishedQuestKilled2 (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "som_kenobi_main_quest_3_b_visible", "talkKenobi2");
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_finishedQuestSpared2 (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "som_kenobi_main_quest_3_visible", "talkKenobi2");
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_atTheEntranceFailed (obj_id player, obj_id npc)
{
	if (groundquests.isTaskActive(player, "som_kenobi_main_quest_3_visible", "killSinistro")||
		groundquests.isTaskActive(player, "som_kenobi_main_quest_3_b_visible", "killSinistro"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_abandonedQuest3 (obj_id player, obj_id npc)
{
	if (groundquests.isQuestActive(player, "som_kenobi_main_quest_3")|| groundquests.isQuestActive(player, "som_kenobi_main_quest_3_b"))
		{
		if	(groundquests.isQuestActive(player, "som_kenobi_main_quest_3_visible")|| groundquests.isQuestActive(player, "som_kenobi_main_quest_3_b_visible"))
			return false;
		else if (groundquests.isQuestActive(player, "som_kenobi_main_quest_spared")|| groundquests.isQuestActive(player, "som_kenobi_main_quest_killed")|| groundquests.isQuestActive(player, "som_kenobi_main_quest_1"))
			return false;
		else
			return true;
		}
	return false;
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_completedAll (obj_id player, obj_id npc)
{
	return	(hasObjVar(player, "didMustafarCrystalLair"));
}

// ----------------------------------------------------------------------

boolean som_kenobi_obi_wan_condition_failedQuest1 (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "som_kenobi_main_quest_1");
}

// ======================================================================
// Script Actions
// ======================================================================

void som_kenobi_obi_wan_action_signalTalked1Spared (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "talkedKenobi1");
	groundquests.grantQuest(player, "som_kenobi_main_quest_3");
	removeObjVar(player, "waitingOnObiwan");
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_signalTalked2Spared (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "talkedKenobi2");
	groundquests.completeQuest(player, "som_kenobi_main_quest_killed");
	groundquests.completeQuest(player, "som_kenobi_main_quest_spared");
	groundquests.clearQuest(player, "som_kenobi_main_quest_3_b");
	removeObjVar(player, "waitingOnObiwan");
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_signalTalked2Killed (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "talkedKenobi2");
	groundquests.completeQuest(player, "som_kenobi_main_quest_killed");
	groundquests.completeQuest(player, "som_kenobi_main_quest_spared");
	groundquests.clearQuest(player, "som_kenobi_main_quest_3");
	removeObjVar(player, "waitingOnObiwan");
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_giveQuest1 (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "som_kenobi_main_quest_1");
	groundquests.clearQuest(player, "som_kenobi_main_quest_killed");
	groundquests.clearQuest(player, "som_kenobi_main_quest_spared");
	
	removeObjVar(player, "waitingOnObiwan");
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_signalTalked3 (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "talkedKenobi3");
	removeObjVar(player, "waitingOnObiwan");
	groundquests.clearTask (player, "som_kenobi_main_quest_3_b", "timer1");
	groundquests.clearTask (player, "som_kenobi_main_quest_3_b", "timer2");
	groundquests.clearTask (player, "som_kenobi_main_quest_3_b", "timer3");
	groundquests.clearTask (player, "som_kenobi_main_quest_3", "timer1");
	groundquests.clearTask (player, "som_kenobi_main_quest_3", "timer2");
	groundquests.clearTask (player, "som_kenobi_main_quest_3", "timer3");
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_finalScriptVar (obj_id player, obj_id npc)
{
	setObjVar (player, "sawObiwanAtLauncher", 1);
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_signalTalked1Killed (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "talkedKenobi1");
	groundquests.grantQuest(player, "som_kenobi_main_quest_3_b");
	removeObjVar(player, "waitingOnObiwan");
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_regiveQuest3 (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "som_kenobi_main_quest_3_visible");
	removeObjVar(player, "waitingOnObiwan");
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_talkNumber2 (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "talkedKenobi2");
	removeObjVar(player, "waitingOnObiwan");
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_clearQuest1 (obj_id player, obj_id npc)
{
	groundquests.clearQuest(player, "som_kenobi_main_quest_1");
}

// ----------------------------------------------------------------------

void som_kenobi_obi_wan_action_grantQuest1 (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "som_kenobi_main_quest_1");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int som_kenobi_obi_wan_handleBranch2 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Are you ready to enter the chamber, %TU?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I think so.
	if (response == "s_315")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod");

			som_kenobi_obi_wan_action_finalScriptVar (player, npc);

			//-- NPC: Good, let us finish this, %TU.
			string_id message = new string_id (c_stringFile, "s_321");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Give me a moment to recover.
	if (response == "s_317")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod");

			//-- NPC: Very well, but don't take too long, %TU. We need to finish this.
			string_id message = new string_id (c_stringFile, "s_319");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch5 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Are you ready to pick up where we left off, %TU?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, I feel that I am.
	if (response == "s_337")
	{
		doAnimationAction (player, "nod");

		som_kenobi_obi_wan_action_regiveQuest3 (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			som_kenobi_obi_wan_action_talkNumber2 (player, npc);

			//-- NPC: Good. Make your way to the lair immediately. We haven't much time.
			string_id message = new string_id (c_stringFile, "s_341");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No. Not yet I'm afraid.
	if (response == "s_339")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well, but I hope you will be soon. We don't have much time.
			string_id message = new string_id (c_stringFile, "s_342");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch8 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I'm glad to see you made it, %TU. Let me explain how to do this.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What happened to you slowing down these guys?!
	if (response == "s_163")
	{
		doAnimationAction (player, "point_accusingly");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: There's too many of them and they are closing in too fast! We have to get inside, now!
			string_id message = new string_id (c_stringFile, "s_165");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Fine, how do I get inside? Shut up! Did you hear that?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_166");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 9);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Please... I... I can't take much more of this...
	if (response == "s_164")
	{
		doAnimationAction (player, "squirm");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The crystal is trying to break you down, but you will be free from it in a second, my friend. Take it and wedge it into one of the cracks of the pillar, then place your hands on it and focus on transferring yourself inside.
			string_id message = new string_id (c_stringFile, "s_168");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Alright, I... I hope this works...
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_171");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch9 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: There's too many of them and they are closing in too fast! We have to get inside, now!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Fine, how do I get inside? Shut up! Did you hear that?
	if (response == "s_166")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: It's the crystal. It's playing tricks with your mind. Wedge it into one of the cracks on the pillar, then place your hands on it and focus on transferring yourself inside.
			string_id message = new string_id (c_stringFile, "s_167");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: This better work!
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_169");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 10);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch10 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It's the crystal. It's playing tricks with your mind. Wedge it into one of the cracks on the pillar, then place your hands on it and focus on transferring yourself inside.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: This better work!
	if (response == "s_169")
	{
		doAnimationAction (player, "squirm");

		som_kenobi_obi_wan_action_signalTalked3 (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			som_kenobi_obi_wan_action_finalScriptVar (player, npc);

			//-- NPC: I believe it will, %TU. Now hurry!
			string_id message = new string_id (c_stringFile, "s_170");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch12 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The crystal is trying to break you down, but you will be free from it in a second, my friend. Take it and wedge it into one of the cracks of the pillar, then place your hands on it and focus on transferring yourself inside.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Alright, I... I hope this works...
	if (response == "s_171")
	{
		doAnimationAction (player, "twitch");

		som_kenobi_obi_wan_action_signalTalked3 (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			som_kenobi_obi_wan_action_finalScriptVar (player, npc);

			//-- NPC: It will, my friend. Now hurry!
			string_id message = new string_id (c_stringFile, "s_172");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Everything is set, %TU. It is time to end this. You must quickly head to the hidden chamber, before it's too late.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How do I get there?
	if (response == "s_265")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: North of the central volcano is what's called the Burning Plains. In the northeast corner of the plains, you will find the entrance to the chamber. I can't come with you, but will meet you there. The minions of the dark are closing in on you. I will have to try and throw them off track.
			string_id message = new string_id (c_stringFile, "s_269");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Thank you. I will make my way over there as fast as I can!
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_273");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Where is it?
	if (response == "s_279")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: North of the central volcano is what's called the Burning Plains. In the northeast corner of the plains, you will find the entrance to the chamber. I can't come with you, but will meet you there. The minions of the dark are closing in on you. I will have to try and throw them off track.
			string_id message = new string_id (c_stringFile, "s_281");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Don't worry. I won't let them get the crystal.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_283");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: North of the central volcano is what's called the Burning Plains. In the northeast corner of the plains, you will find the entrance to the chamber. I can't come with you, but will meet you there. The minions of the dark are closing in on you. I will have to try and throw them off track.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Thank you. I will make my way over there as fast as I can!
	if (response == "s_273")
	{
		doAnimationAction (player, "twitch");

		som_kenobi_obi_wan_action_signalTalked2Spared (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good luck, my friend, and may the Force be with you. You will need it.
			string_id message = new string_id (c_stringFile, "s_277");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: North of the central volcano is what's called the Burning Plains. In the northeast corner of the plains, you will find the entrance to the chamber. I can't come with you, but will meet you there. The minions of the dark are closing in on you. I will have to try and throw them off track.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Don't worry. I won't let them get the crystal.
	if (response == "s_283")
	{
		doAnimationAction (player, "twitch");

		som_kenobi_obi_wan_action_signalTalked2Spared (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I hope you are right. May the Force be with you, %TU. You will need it.
			string_id message = new string_id (c_stringFile, "s_285");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch19 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Everything is set, %TU. Now you need to make it to the hidden chamber quickly.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How do I get there?
	if (response == "s_293")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: North of the central volcano is what's called the Burning Plains. In the northeast corner of the plains, you will find the entrance to the chamber. I can't come with you, but will meet you there. The minions of the dark are closing in on you. I will have to try and throw them off track.
			string_id message = new string_id (c_stringFile, "s_295");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Thank you. I will make my way over there as fast as I can!
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_297");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 20);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Where is it?
	if (response == "s_301")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: North of the central volcano is what's called the Burning Plains. In the northeast corner of the plains, you will find the entrance to the chamber. I can't come with you, but will meet you there. The minions of the dark are closing in on you. I will have to try and throw them off track.
			string_id message = new string_id (c_stringFile, "s_303");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Don't worry, I won't let them get the crystal.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_305");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 22);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: North of the central volcano is what's called the Burning Plains. In the northeast corner of the plains, you will find the entrance to the chamber. I can't come with you, but will meet you there. The minions of the dark are closing in on you. I will have to try and throw them off track.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Thank you. I will make my way over there as fast as I can!
	if (response == "s_297")
	{
		doAnimationAction (player, "twitch");

		som_kenobi_obi_wan_action_signalTalked2Killed (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good luck, my friend and may the Force be with you. You will need it.
			string_id message = new string_id (c_stringFile, "s_299");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch22 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: North of the central volcano is what's called the Burning Plains. In the northeast corner of the plains, you will find the entrance to the chamber. I can't come with you, but will meet you there. The minions of the dark are closing in on you. I will have to try and throw them off track.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Don't worry, I won't let them get the crystal.
	if (response == "s_305")
	{
		doAnimationAction (player, "twitch");

		som_kenobi_obi_wan_action_signalTalked2Killed (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I hope you are right. May the Force be with you, %TU. You will need it.
			string_id message = new string_id (c_stringFile, "s_307");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch24 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Good, you have the key. We are ready to proceed, %TU.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Good, this thing is strange. I don't like it at all.
	if (response == "s_97")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition_finishedQuestSpared (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: Yes, the Jedi trapped within is clearly in great pain and he must have been what drove the poor Mustafarian you saved insane. I will try to come up with a way to help free him later, but right now we have more pressing matters.
			string_id message = new string_id (c_stringFile, "s_99");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yes, I would like to get rid of this crystal sooner rather than later.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Yes, he can wait. What's the next step?
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_159");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_160");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 25);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition_finishedQuestKilled (player, npc))
		{
			//-- NPC: Yes, the Jedi trapped within is clearly in great pain and he must have been what drove the poor Mustafarian insane. I will try to come up with a way to help free him later, but right now, we have more pressing matters. I wish you hadn't killed the Mustafarian, though. He was as much a victim as the Jedi in the crystal and if he had been spared, he could have been a help in saving the Jedi...
			string_id message = new string_id (c_stringFile, "s_103");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I had no choice but to put the crazy fool out of his misery.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I was trying to avoid it, but I couldn't save him.
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_104");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_105");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 34);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch25 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, the Jedi trapped within is clearly in great pain and he must have been what drove the poor Mustafarian you saved insane. I will try to come up with a way to help free him later, but right now we have more pressing matters.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, I would like to get rid of this crystal sooner rather than later.
	if (response == "s_159")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Yes, time is against us, in more ways than one. A great evil has arrived and it's quickly making its way over to the chamber. Not only that, but your actions have drawn the attention of its minions, and I fear that they are closing in on you as we speak.
			string_id message = new string_id (c_stringFile, "s_328");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I will be as fast as I can. What do I do next?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_330");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 26);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, he can wait. What's the next step?
	if (response == "s_160")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: We are rapidly running out of time. A great evil has arrived and it's quickly making its way over to the chamber. Not only that, but your actions have drawn the attention of its minions and I fear that they are closing in on you as we speak.
			string_id message = new string_id (c_stringFile, "s_314");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Then why are we standing around here? What's the next step?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_316");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 30);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch26 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, time is against us, in more ways than one. A great evil has arrived and it's quickly making its way over to the chamber. Not only that, but your actions have drawn the attention of its minions, and I fear that they are closing in on you as we speak.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will be as fast as I can. What do I do next?
	if (response == "s_330")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: It's dangerous, but we need to forge a stronger bond between you and the crystal. That would probably happen over time if you kept it, but we can't wait. On this planet, there are three old enclaves, remains of the Jedi temples. At each of these, there is a conduit that was used to link the enclaves together.
			string_id message = new string_id (c_stringFile, "s_332");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm not sure I like this...
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_334");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 27);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch27 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It's dangerous, but we need to forge a stronger bond between you and the crystal. That would probably happen over time if you kept it, but we can't wait. On this planet, there are three old enclaves, remains of the Jedi temples. At each of these, there is a conduit that was used to link the enclaves together.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm not sure I like this...
	if (response == "s_334")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I know, my friend, but we have no choice. You will have to go to each of these three conduits, wedge the crystal into it, and wait while the power channels through it. The first enclave is located in the northwest corner of the continent. The second is just west of the central volcano and the final one is straight east of the same volcano, all the way on the edge of the continent.
			string_id message = new string_id (c_stringFile, "s_336");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very well, I will be on my way immediately.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_338");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 28);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch28 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I know, my friend, but we have no choice. You will have to go to each of these three conduits, wedge the crystal into it, and wait while the power channels through it. The first enclave is located in the northwest corner of the continent. The second is just west of the central volcano and the final one is straight east of the same volcano, all the way on the edge of the continent.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Very well, I will be on my way immediately.
	if (response == "s_338")
	{
		doAnimationAction (player, "twitch");

		som_kenobi_obi_wan_action_signalTalked1Spared (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Be very careful, my friend. These are dangerous times indeed. May the Force be with you, %TU!
			string_id message = new string_id (c_stringFile, "s_340");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch30 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We are rapidly running out of time. A great evil has arrived and it's quickly making its way over to the chamber. Not only that, but your actions have drawn the attention of its minions and I fear that they are closing in on you as we speak.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Then why are we standing around here? What's the next step?
	if (response == "s_316")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: It's dangerous, but we need to forge a stronger bond between you and the crystal. That would probably happen over time if you kept it, but we can't wait. On this planet, there are three old enclaves, remains of the Jedi temples. At each of these there is a conduit that was used to link the enclaves together.
			string_id message = new string_id (c_stringFile, "s_318");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I thought we were in a hurry? Get to the point.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_320");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 31);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch31 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It's dangerous, but we need to forge a stronger bond between you and the crystal. That would probably happen over time if you kept it, but we can't wait. On this planet, there are three old enclaves, remains of the Jedi temples. At each of these there is a conduit that was used to link the enclaves together.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I thought we were in a hurry? Get to the point.
	if (response == "s_320")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Patience, %TU. I'm getting there. You will have to go to each of these three conduits, wedge the crystal into it, and wait while the power channels through it. The first enclave is located in the northwest corner of the continent. The second is just west of the central volcano and the final one is straight east of the same volcano, all the way on the edge of the continent.
			string_id message = new string_id (c_stringFile, "s_322");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Alright, enough chatting. I'm on my way!
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_324");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 32);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch32 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Patience, %TU. I'm getting there. You will have to go to each of these three conduits, wedge the crystal into it, and wait while the power channels through it. The first enclave is located in the northwest corner of the continent. The second is just west of the central volcano and the final one is straight east of the same volcano, all the way on the edge of the continent.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Alright, enough chatting. I'm on my way!
	if (response == "s_324")
	{
		doAnimationAction (player, "twitch");

		som_kenobi_obi_wan_action_signalTalked1Spared (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well. Stay on your guard, %TU. Danger is everywhere now. May the Force be with you!
			string_id message = new string_id (c_stringFile, "s_326");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch34 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, the Jedi trapped within is clearly in great pain and he must have been what drove the poor Mustafarian insane. I will try to come up with a way to help free him later, but right now, we have more pressing matters. I wish you hadn't killed the Mustafarian, though. He was as much a victim as the Jedi in the crystal and if he had been spared, he could have been a help in saving the Jedi...

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I had no choice but to put the crazy fool out of his misery.
	if (response == "s_104")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: There's almost always another way, %TU. You have to be more compassionate. All that anger can only cause you pain.
			string_id message = new string_id (c_stringFile, "s_107");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I've done alright so far. Now what is the next step?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_108");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 35);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I was trying to avoid it, but I couldn't save him.
	if (response == "s_105")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I understand. Sometimes violence is the only outcome, my friend. At least you did your best. Now, let's focus on the task at hand.
			string_id message = new string_id (c_stringFile, "s_114");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yes, I would like to get rid of this crystal sooner rather than later.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_115");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 40);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch35 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: There's almost always another way, %TU. You have to be more compassionate. All that anger can only cause you pain.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I've done alright so far. Now what is the next step?
	if (response == "s_108")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: We are rapidly running out of time. A great evil has arrived and it's quickly making its way over to the chamber. Not only that, but your actions have drawn the attention of its minions and I fear that they are closing in on you as we speak.
			string_id message = new string_id (c_stringFile, "s_109");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Then why are we standing around here? What's the next step?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_110");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 36);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch36 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We are rapidly running out of time. A great evil has arrived and it's quickly making its way over to the chamber. Not only that, but your actions have drawn the attention of its minions and I fear that they are closing in on you as we speak.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Then why are we standing around here? What's the next step?
	if (response == "s_110")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: It's dangerous, but we need to forge a stronger bond between you and the crystal. That would probably happen over time if you kept it, but we can't wait. On this planet, there are three old enclaves, remains of the Jedi temples. At each of these, there is a conduit that was used to link the enclaves together.
			string_id message = new string_id (c_stringFile, "s_150");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I thought we were in a hurry? Get to the point.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_155");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 37);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch37 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It's dangerous, but we need to forge a stronger bond between you and the crystal. That would probably happen over time if you kept it, but we can't wait. On this planet, there are three old enclaves, remains of the Jedi temples. At each of these, there is a conduit that was used to link the enclaves together.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I thought we were in a hurry? Get to the point.
	if (response == "s_155")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Patience, %TU. I'm getting there. You will have to go to each of these three conduits, wedge the crystal into it and wait while the power channels through it. The first enclave is located in the northwest corner of the continent. The second is just west of the central volcano and the final one is straight east of the same volcano, all the way on the edge of the continent.
			string_id message = new string_id (c_stringFile, "s_156");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Alright, enough chatting. I'm on my way!
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_288");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 38);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch38 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Patience, %TU. I'm getting there. You will have to go to each of these three conduits, wedge the crystal into it and wait while the power channels through it. The first enclave is located in the northwest corner of the continent. The second is just west of the central volcano and the final one is straight east of the same volcano, all the way on the edge of the continent.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Alright, enough chatting. I'm on my way!
	if (response == "s_288")
	{
		doAnimationAction (player, "twitch");

		som_kenobi_obi_wan_action_signalTalked1Killed (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well. Stay on your guard, %TU. Danger is everywhere now. May the Force be with you!
			string_id message = new string_id (c_stringFile, "s_289");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch40 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I understand. Sometimes violence is the only outcome, my friend. At least you did your best. Now, let's focus on the task at hand.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, I would like to get rid of this crystal sooner rather than later.
	if (response == "s_115")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Yes, time is against us, in more ways than one. A great evil has arrived and it's quickly making its way over to the chamber. Not only that, but your actions have drawn the attention of its minions and I fear that they are closing in on you as we speak.
			string_id message = new string_id (c_stringFile, "s_116");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I will be as fast as I can. What do I do next?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_117");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 41);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch41 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, time is against us, in more ways than one. A great evil has arrived and it's quickly making its way over to the chamber. Not only that, but your actions have drawn the attention of its minions and I fear that they are closing in on you as we speak.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will be as fast as I can. What do I do next?
	if (response == "s_117")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: It's dangerous, but we need to forge a stronger bond between you and the crystal. That would probably happen over time if you kept it, but we can't wait. On this planet, there are three old enclaves, remains of the Jedi temples. At each of these, there is a conduit that was used to link the enclaves together.
			string_id message = new string_id (c_stringFile, "s_154");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm not sure I like this...
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_157");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 42);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch42 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It's dangerous, but we need to forge a stronger bond between you and the crystal. That would probably happen over time if you kept it, but we can't wait. On this planet, there are three old enclaves, remains of the Jedi temples. At each of these, there is a conduit that was used to link the enclaves together.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm not sure I like this...
	if (response == "s_157")
	{
		doAnimationAction (player, "twitch");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I know, my friend, but we have no choice. You will have to go to each of these three conduits, wedge the crystal into it, and wait while the power channels through it. The first enclave is located in the northwest corner of the continent. The second is just west of the central volcano and the final one is straight east of the same volcano, all the way on the edge of the continent.
			string_id message = new string_id (c_stringFile, "s_158");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very well, I will be on my way immediately.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_286");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 43);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch43 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I know, my friend, but we have no choice. You will have to go to each of these three conduits, wedge the crystal into it, and wait while the power channels through it. The first enclave is located in the northwest corner of the continent. The second is just west of the central volcano and the final one is straight east of the same volcano, all the way on the edge of the continent.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Very well, I will be on my way immediately.
	if (response == "s_286")
	{
		doAnimationAction (player, "twitch");

		som_kenobi_obi_wan_action_signalTalked1Killed (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Be very careful, my friend. These are dangerous times indeed. May the Force be with you, %TU!
			string_id message = new string_id (c_stringFile, "s_287");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch45 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I can't assist you any further right now, %TU. I have things that have to be done if we are to succeed.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Alright. I will do as you have asked.
	if (response == "s_349")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Thank you. The fate of galaxy rests in your hands.
			string_id message = new string_id (c_stringFile, "s_351");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I have lost the hermit.
	if (response == "s_350")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			som_kenobi_obi_wan_action_grantQuest1 (player, npc);

			//-- NPC: Very well, you will have to perform another search for him using the miner's network. Return to the Mensix Mining Facility and perform another search for the hermit. Good luck to you.
			string_id message = new string_id (c_stringFile, "s_352");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch48 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I am in dire need of your assistance, %TU. I've been watching you for some time, hoping that you would be the one I could entrust with this difficult task.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What...who are you?
	if (response == "s_121")
	{
		doAnimationAction (player, "taken_aback");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Who I am is not of any importance. What I need help with, on the other hand, may affect the future of the entire galaxy.
			string_id message = new string_id (c_stringFile, "s_123");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Then, what would I call you?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I like to know who I'm doing favors for.
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			//-- PLAYER: Please explain.
			boolean hasResponse2 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse2 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_198");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_199");

				if (hasResponse2)
					responses [responseIndex++] = new string_id (c_stringFile, "s_200");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 49);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Interesting. Who, or maybe I should say what, are you?
	if (response == "s_152")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: Who I am is not of any importance. What I need help with, on the other hand, may affect the future of the entire galaxy.
			string_id message = new string_id (c_stringFile, "s_161");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Please explain.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Fine, I'm all ears.
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			//-- PLAYER: I like to know who I'm doing favors for.
			boolean hasResponse2 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse2 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_174");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_176");

				if (hasResponse2)
					responses [responseIndex++] = new string_id (c_stringFile, "s_346");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 69);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch49 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Who I am is not of any importance. What I need help with, on the other hand, may affect the future of the entire galaxy.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Then, what would I call you?
	if (response == "s_198")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: You can call me Ben. Now let me continue, please.
			string_id message = new string_id (c_stringFile, "s_201");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Of course. My apologies.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_202");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 50);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I like to know who I'm doing favors for.
	if (response == "s_199")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I just told you, the entire galaxy. Very well, you can call me Ben. Now can I go on?
			string_id message = new string_id (c_stringFile, "s_348");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Fine, what is it you need help with?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_354");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 89);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Please explain.
	if (response == "s_200")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I'm not sure how much of this planet's history you have uncovered, but I'll tell you what I know. Thousands of years ago, long before my time, there was a large chapter of Jedi Knights located here. The planet was a center of Jedi information and artifacts, which attracted the vicious Sith.
			string_id message = new string_id (c_stringFile, "s_204");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Who are the Sith?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Yes, I've learned some of this, but please continue.
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_206");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_212");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 51);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch50 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You can call me Ben. Now let me continue, please.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Of course. My apologies.
	if (response == "s_202")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I'm not sure how much of this planet's history you have uncovered, but I'll tell you what I know. Thousands of years ago, long before my time, there was a large chapter of Jedi Knights located here. The planet was a center of Jedi information and artifacts, which attracted the vicious Sith.
			string_id message = new string_id (c_stringFile, "s_204");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Who are the Sith?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Yes, I've learned some of this, but please continue.
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_206");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_212");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 51);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch51 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I'm not sure how much of this planet's history you have uncovered, but I'll tell you what I know. Thousands of years ago, long before my time, there was a large chapter of Jedi Knights located here. The planet was a center of Jedi information and artifacts, which attracted the vicious Sith.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Who are the Sith?
	if (response == "s_206")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Sith were an ancient race that, for the lack of a better term, were pure evil. Their leaders were great wielders of the Force; but they didn't wield it for great things. They became a danger to the rest of the galaxy when their powers corrupted Jedi that came to their planet.
			string_id message = new string_id (c_stringFile, "s_208");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I understand.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_210");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 52);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, I've learned some of this, but please continue.
	if (response == "s_212")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Jedi on Mustafar uncovered a magnificent crystal of unknown origin. It was as tall as a tower, and the Jedi quickly discovered that it was attuned to the Force within them. When news of an impending Sith invasion reached them, they desperately began to experiment with the crystal, hoping to find a way to use it in their defense.
			string_id message = new string_id (c_stringFile, "s_214");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm assuming things didn't go according to plans..?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_216");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 53);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch52 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The Sith were an ancient race that, for the lack of a better term, were pure evil. Their leaders were great wielders of the Force; but they didn't wield it for great things. They became a danger to the rest of the galaxy when their powers corrupted Jedi that came to their planet.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I understand.
	if (response == "s_210")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Jedi on Mustafar uncovered a magnificent crystal of unknown origin. It was as tall as a tower, and the Jedi quickly discovered that it was attuned to the Force within them. When news of an impending Sith invasion reached them, they desperately began to experiment with the crystal, hoping to find a way to use it in their defense.
			string_id message = new string_id (c_stringFile, "s_214");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm assuming things didn't go according to plans..?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_216");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 53);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch53 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The Jedi on Mustafar uncovered a magnificent crystal of unknown origin. It was as tall as a tower, and the Jedi quickly discovered that it was attuned to the Force within them. When news of an impending Sith invasion reached them, they desperately began to experiment with the crystal, hoping to find a way to use it in their defense.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm assuming things didn't go according to plans..?
	if (response == "s_216")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: You are correct, my friend. The Jedi believed they could channel their powers through the crystal and dampen the Sith's powers while strengthening their own. As the Sith warships pierced the atmosphere, the Jedi Masters began channeling the Force through the crystal while the younger Jedi led the troops in battle.
			string_id message = new string_id (c_stringFile, "s_218");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What happened?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_220");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 54);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch54 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You are correct, my friend. The Jedi believed they could channel their powers through the crystal and dampen the Sith's powers while strengthening their own. As the Sith warships pierced the atmosphere, the Jedi Masters began channeling the Force through the crystal while the younger Jedi led the troops in battle.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What happened?
	if (response == "s_220")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: At first, it worked perfectly. The Sith could barely use their powers at all, while the young Jedi in the field could wield more power than ever. But they hadn't had time to do enough research on the crystal and its limits, and as the battle went on, it began to crack. Close to victory, the Jedi could have stopped using it and would have still won the battle.
			string_id message = new string_id (c_stringFile, "s_222");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Why didn't they? Jedi are quite wise from what I know.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_224");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 55);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch55 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: At first, it worked perfectly. The Sith could barely use their powers at all, while the young Jedi in the field could wield more power than ever. But they hadn't had time to do enough research on the crystal and its limits, and as the battle went on, it began to crack. Close to victory, the Jedi could have stopped using it and would have still won the battle.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why didn't they? Jedi are quite wise from what I know.
	if (response == "s_224")
	{
		doAnimationAction (player, "shrug_hands");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: But they have their flaws like everyone else. Some believe that the Sith Lord, facing certain defeat, somehow corrupted the vulnerable Jedi Masters as they were channeling. The result was catastrophic. When the crystal exploded, it sent the planet itself out of its orbit and wiped out all of the Sith and Jedi. All but one, that is.
			string_id message = new string_id (c_stringFile, "s_226");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Who could possibly have survived that?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: They couldn't have been unfortunate enough that the Sith Lord survived?
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_228");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_272");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 56);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch56 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: But they have their flaws like everyone else. Some believe that the Sith Lord, facing certain defeat, somehow corrupted the vulnerable Jedi Masters as they were channeling. The result was catastrophic. When the crystal exploded, it sent the planet itself out of its orbit and wiped out all of the Sith and Jedi. All but one, that is.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Who could possibly have survived that?
	if (response == "s_228")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The elder of the masters, Erg Krow. As the crystal exploded, he managed to shield himself from some of the destruction. Clinging onto life, he found a large shard of the crystal in front of the dead masters.
			string_id message = new string_id (c_stringFile, "s_230");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Amazing. What did he do?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_232");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 57);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: They couldn't have been unfortunate enough that the Sith Lord survived?
	if (response == "s_272")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: No, thankfully they weren't. All records point to the Sith Lord being vanquished.
			string_id message = new string_id (c_stringFile, "s_274");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Good. So who did survive?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_276");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 68);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch57 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The elder of the masters, Erg Krow. As the crystal exploded, he managed to shield himself from some of the destruction. Clinging onto life, he found a large shard of the crystal in front of the dead masters.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Amazing. What did he do?
	if (response == "s_232")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Sensing that this large shard still had tremendous power, he dragged it with him into hiding. He then spent his remaining energy using the Force to put a protective shield around it, to make sure that no other Force wielder could sense its presence. Unfortunately, Krow, dying from his injuries, wasn't as strong as he had once been, and the power of his shield has diminished after several thousand years.
			string_id message = new string_id (c_stringFile, "s_234");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Then it is now unprotected and it's possible to find it?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_236");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 58);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch58 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Sensing that this large shard still had tremendous power, he dragged it with him into hiding. He then spent his remaining energy using the Force to put a protective shield around it, to make sure that no other Force wielder could sense its presence. Unfortunately, Krow, dying from his injuries, wasn't as strong as he had once been, and the power of his shield has diminished after several thousand years.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Then it is now unprotected and it's possible to find it?
	if (response == "s_236")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I already have, but the forces of evil are swiftly closing in to claim it. You have seen some of them yourself. That is why we must act quickly, %TU. We can't let it fall into their hands.
			string_id message = new string_id (c_stringFile, "s_238");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Most definitely not. So why haven't you taken it?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_240");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 59);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch59 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I already have, but the forces of evil are swiftly closing in to claim it. You have seen some of them yourself. That is why we must act quickly, %TU. We can't let it fall into their hands.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Most definitely not. So why haven't you taken it?
	if (response == "s_240")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: In my state, I can't, which is why I need you. I wish it were as easy as us just going there right now and getting it, but there are some problems. Even though the shielding is all but gone, Krow made sure that it wouldn't be easy to gain access. He made the entrance only passable by someone with great Force powers and since you don't have that, we have to cheat.
			string_id message = new string_id (c_stringFile, "s_242");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Cheat how?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_244");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 60);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch60 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: In my state, I can't, which is why I need you. I wish it were as easy as us just going there right now and getting it, but there are some problems. Even though the shielding is all but gone, Krow made sure that it wouldn't be easy to gain access. He made the entrance only passable by someone with great Force powers and since you don't have that, we have to cheat.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Cheat how?
	if (response == "s_244")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: There's a shard of the crystal that has an unusually active soul of a Jedi trapped inside it. I'm fairly certain that we can use that shard as a key to gain entrance to Krow's chamber.
			string_id message = new string_id (c_stringFile, "s_246");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: A soul trapped inside? That's horrible.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_248");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 61);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch61 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: There's a shard of the crystal that has an unusually active soul of a Jedi trapped inside it. I'm fairly certain that we can use that shard as a key to gain entrance to Krow's chamber.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: A soul trapped inside? That's horrible.
	if (response == "s_248")
	{
		doAnimationAction (player, "shrug_hands");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: I agree, but that's a problem that will have to wait.
			string_id message = new string_id (c_stringFile, "s_250");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Understood. So where do we take the shard if we get it?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_252");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 62);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch62 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I agree, but that's a problem that will have to wait.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Understood. So where do we take the shard if we get it?
	if (response == "s_252")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Nowhere. We will destroy it, which is what Krow should have done in the first place. I think that some of the Sith's taint had touched him and that's why he couldn't. The crystal is much too powerful to be entrusted to anyone. No one is immune to the corruption of the Dark Side. Trust me.
			string_id message = new string_id (c_stringFile, "s_254");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I agree. So where do we find the 'key'?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_256");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 63);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch63 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Nowhere. We will destroy it, which is what Krow should have done in the first place. I think that some of the Sith's taint had touched him and that's why he couldn't. The crystal is much too powerful to be entrusted to anyone. No one is immune to the corruption of the Dark Side. Trust me.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I agree. So where do we find the 'key'?
	if (response == "s_256")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: That is the tricky part. It's currently in the possession of a crazed Mustafarian. I'm not sure what's driven him to insanity, but he's become a hermit, wandering the scorched lands erratically...making him hard to track, even for me. You need to find him.
			string_id message = new string_id (c_stringFile, "s_258");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: That will be difficult. He could be anywhere.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_260");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 64);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch64 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That is the tricky part. It's currently in the possession of a crazed Mustafarian. I'm not sure what's driven him to insanity, but he's become a hermit, wandering the scorched lands erratically...making him hard to track, even for me. You need to find him.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: That will be difficult. He could be anywhere.
	if (response == "s_260")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Yes, but I've thought of something that might help. The Mustafarian survey droids scour the planet constantly trying to find new resources. If you can gain access to their computer network, you might be able to find an approximate location of where the hermit was spotted last.
			string_id message = new string_id (c_stringFile, "s_262");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Will the Mustafarians assist me?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_264");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 65);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch65 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, but I've thought of something that might help. The Mustafarian survey droids scour the planet constantly trying to find new resources. If you can gain access to their computer network, you might be able to find an approximate location of where the hermit was spotted last.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Will the Mustafarians assist me?
	if (response == "s_264")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: That is unlikely. They are mostly interested in profit and would probably shrug you off as a lunatic if you tried to explain to them. You will have to find another way. I'm afraid I have urgent matters to take care of, but I will see you again, %TU. Please be swift in solving this. We are rapidly running out of time. If you need my assistance, go to the northeastern shoreline between the old and new mining facilities and I will try to answer your call.
			string_id message = new string_id (c_stringFile, "s_266");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I will do my best. You be careful.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_268");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 66);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch66 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That is unlikely. They are mostly interested in profit and would probably shrug you off as a lunatic if you tried to explain to them. You will have to find another way. I'm afraid I have urgent matters to take care of, but I will see you again, %TU. Please be swift in solving this. We are rapidly running out of time. If you need my assistance, go to the northeastern shoreline between the old and new mining facilities and I will try to answer your call.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will do my best. You be careful.
	if (response == "s_268")
	{
		som_kenobi_obi_wan_action_giveQuest1 (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "laugh_cackle");

			//-- NPC: Oh, this old man will be fine. You just worry about yourself, my friend. May the Force be with you, %TU.
			string_id message = new string_id (c_stringFile, "s_270");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch68 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: No, thankfully they weren't. All records point to the Sith Lord being vanquished.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Good. So who did survive?
	if (response == "s_276")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The elder of the masters, Erg Krow. As the crystal exploded, he managed to shield himself from some of the destruction. Clinging onto life, he found a large shard of the crystal in front of the dead masters.
			string_id message = new string_id (c_stringFile, "s_230");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Amazing. What did he do?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_232");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 57);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch69 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Who I am is not of any importance. What I need help with, on the other hand, may affect the future of the entire galaxy.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Please explain.
	if (response == "s_174")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I'm not sure how much of this planet's history you have uncovered, but I'll tell you what I know. Thousands of years ago, long before my time, there was a large chapter of Jedi Knights located here. The planet was a center of Jedi information and artifacts, which attracted the vicious Sith.
			string_id message = new string_id (c_stringFile, "s_204");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Who are the Sith?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Yes, I've learned some of this, but please continue.
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_206");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_212");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 51);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Fine, I'm all ears.
	if (response == "s_176")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I'm not sure how much of this planet's history you have uncovered, but I'll tell you what I know. Thousands of years ago, long before my time, there was a large chapter of Jedi Knights located here. The planet was a center of Jedi information and artifacts, which attracted the vicious Sith.
			string_id message = new string_id (c_stringFile, "s_178");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: The Sith?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: As I suspected.
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_180");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_186");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 70);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I like to know who I'm doing favors for.
	if (response == "s_346")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I just told you, the entire galaxy. Very well, you can call me Ben. Now can I go on?
			string_id message = new string_id (c_stringFile, "s_348");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Fine, what is it you need help with?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_354");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 89);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch70 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I'm not sure how much of this planet's history you have uncovered, but I'll tell you what I know. Thousands of years ago, long before my time, there was a large chapter of Jedi Knights located here. The planet was a center of Jedi information and artifacts, which attracted the vicious Sith.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: The Sith?
	if (response == "s_180")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Sith were an ancient race that, for the lack of a better term, were pure evil. Their leaders were great wielders of the Force, but they didn't wield it for great things. They became a danger to the rest of the galaxy when their powers corrupted Jedi that came to their planet.
			string_id message = new string_id (c_stringFile, "s_182");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Hmm, alright, carry on.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_184");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 71);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: As I suspected.
	if (response == "s_186")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Jedi on Mustafar uncovered a magnificent crystal of unknown origin. It was as tall as a tower, and the Jedi quickly discovered that it was attuned to the Force within them. When news of an impending Sith invasion reached them, they desperately began to experiment with the crystal, hoping to find a way to use it in their defense.
			string_id message = new string_id (c_stringFile, "s_188");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I can see where this is heading.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_190");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 72);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch71 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The Sith were an ancient race that, for the lack of a better term, were pure evil. Their leaders were great wielders of the Force, but they didn't wield it for great things. They became a danger to the rest of the galaxy when their powers corrupted Jedi that came to their planet.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Hmm, alright, carry on.
	if (response == "s_184")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Jedi on Mustafar uncovered a magnificent crystal of unknown origin. It was as tall as a tower, and the Jedi quickly discovered that it was attuned to the Force within them. When news of an impending Sith invasion reached them, they desperately began to experiment with the crystal, hoping to find a way to use it in their defense.
			string_id message = new string_id (c_stringFile, "s_188");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I can see where this is heading.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_190");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 72);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch72 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The Jedi on Mustafar uncovered a magnificent crystal of unknown origin. It was as tall as a tower, and the Jedi quickly discovered that it was attuned to the Force within them. When news of an impending Sith invasion reached them, they desperately began to experiment with the crystal, hoping to find a way to use it in their defense.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I can see where this is heading.
	if (response == "s_190")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: Yes, I'm sure you can piece it together by now, but let me go on. The Jedi believed they could channel their powers through the crystal and dampen the Sith's powers while strengthening their own. As the Sith warships pierced the atmosphere, the Jedi Masters began channeling the Force through the crystal while the younger Jedi led the troops in battle.
			string_id message = new string_id (c_stringFile, "s_192");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: But everything didn't go as they planned, did it?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_194");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 73);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch73 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, I'm sure you can piece it together by now, but let me go on. The Jedi believed they could channel their powers through the crystal and dampen the Sith's powers while strengthening their own. As the Sith warships pierced the atmosphere, the Jedi Masters began channeling the Force through the crystal while the younger Jedi led the troops in battle.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: But everything didn't go as they planned, did it?
	if (response == "s_194")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Indeed it didn't. At first, it worked perfectly. The Sith could barely use their powers at all while the young Jedi in the field could wield more power than ever. But they hadn't had time to do enough research on the crystal and its limits, and as the battle went on, it began to crack. Close to victory, the Jedi could have stopped using it and would have still won the battle.
			string_id message = new string_id (c_stringFile, "s_196");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: But they didn't?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_203");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 74);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch74 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Indeed it didn't. At first, it worked perfectly. The Sith could barely use their powers at all while the young Jedi in the field could wield more power than ever. But they hadn't had time to do enough research on the crystal and its limits, and as the battle went on, it began to crack. Close to victory, the Jedi could have stopped using it and would have still won the battle.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: But they didn't?
	if (response == "s_203")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: No, and I'm not sure why. Some believe that the Sith Lord, facing certain defeat, somehow corrupted the vulnerable Jedi Masters as they were channeling. The result was catastrophic. When the crystal exploded, it sent the planet itself out of its orbit and wiped out all of the Sith and Jedi. All but one, that is.
			string_id message = new string_id (c_stringFile, "s_207");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Who?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: The Sith Lord I assume?
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_211");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_311");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 75);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch75 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: No, and I'm not sure why. Some believe that the Sith Lord, facing certain defeat, somehow corrupted the vulnerable Jedi Masters as they were channeling. The result was catastrophic. When the crystal exploded, it sent the planet itself out of its orbit and wiped out all of the Sith and Jedi. All but one, that is.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Who?
	if (response == "s_211")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The elder of the masters, Erg Krow. As the crystal exploded, he managed to shield himself from some of the destruction. Clinging onto life, he found a large shard of the crystal in front of the dead masters.
			string_id message = new string_id (c_stringFile, "s_215");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very interesting.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_219");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 76);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: The Sith Lord I assume?
	if (response == "s_311")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "rub_chin_thoughtful");

			//-- NPC: No...why would you assume that?
			string_id message = new string_id (c_stringFile, "s_323");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Well, he must have been very powerful...corrupting the Jedi Masters.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_327");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 87);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch76 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The elder of the masters, Erg Krow. As the crystal exploded, he managed to shield himself from some of the destruction. Clinging onto life, he found a large shard of the crystal in front of the dead masters.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Very interesting.
	if (response == "s_219")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Sensing that this large shard still had tremendous power, he dragged it with him into hiding. He then spent his remaining energy using the Force to put a protective shield around it, to make sure that no other Force wielder could sense its presence. Unfortunately, Krow, dying from his injuries, wasn't as strong as he had once been, and the power of his shield has diminished after several thousand years.
			string_id message = new string_id (c_stringFile, "s_223");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: You mean that we can find it now?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_229");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 77);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch77 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Sensing that this large shard still had tremendous power, he dragged it with him into hiding. He then spent his remaining energy using the Force to put a protective shield around it, to make sure that no other Force wielder could sense its presence. Unfortunately, Krow, dying from his injuries, wasn't as strong as he had once been, and the power of his shield has diminished after several thousand years.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You mean that we can find it now?
	if (response == "s_229")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I already have, but the forces of evil are swiftly closing in to claim it. You have seen some of them yourself. That is why we must act quickly, %TU. We can't let it fall into their hands.
			string_id message = new string_id (c_stringFile, "s_235");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I agree. So where is it? Let's go get it right away.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_239");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 78);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch78 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I already have, but the forces of evil are swiftly closing in to claim it. You have seen some of them yourself. That is why we must act quickly, %TU. We can't let it fall into their hands.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I agree. So where is it? Let's go get it right away.
	if (response == "s_239")
	{
		doAnimationAction (player, "nod_head_multiple");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: I wish it was that simple. Even though the shielding is all but gone, Krow made sure that it wouldn't be easy to gain access. He made the entrance only passable by someone with great Force powers, and since you don't have that, we have to cheat.
			string_id message = new string_id (c_stringFile, "s_243");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Sounds good. What's the plan?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_247");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 79);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch79 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I wish it was that simple. Even though the shielding is all but gone, Krow made sure that it wouldn't be easy to gain access. He made the entrance only passable by someone with great Force powers, and since you don't have that, we have to cheat.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Sounds good. What's the plan?
	if (response == "s_247")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: There's a shard of the crystal that has an unusually active soul of a Jedi trapped inside it. I'm fairly certain that we can use that shard as a key to gain entrance to Krow's chamber.
			string_id message = new string_id (c_stringFile, "s_251");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Fairly certain? What if it doesn't work and someone takes my crystal?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_255");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 80);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch80 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: There's a shard of the crystal that has an unusually active soul of a Jedi trapped inside it. I'm fairly certain that we can use that shard as a key to gain entrance to Krow's chamber.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Fairly certain? What if it doesn't work and someone takes my crystal?
	if (response == "s_255")
	{
		doAnimationAction (player, "shrug_hands");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Your crystal? We are not going there to take it. We are going to destroy it.
			string_id message = new string_id (c_stringFile, "s_259");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Why?!
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_263");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 81);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch81 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Your crystal? We are not going there to take it. We are going to destroy it.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why?!
	if (response == "s_263")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: That is what Krow should have done in the first place. I think that some of the Sith's taint had touched him and that's why he couldn't. The crystal is much too powerful to be entrusted to anyone. No one is immune to the corruption of the Dark Side. Trust me.
			string_id message = new string_id (c_stringFile, "s_271");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: But... Fine. So where do we find the 'key'?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_278");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 82);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch82 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That is what Krow should have done in the first place. I think that some of the Sith's taint had touched him and that's why he couldn't. The crystal is much too powerful to be entrusted to anyone. No one is immune to the corruption of the Dark Side. Trust me.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: But... Fine. So where do we find the 'key'?
	if (response == "s_278")
	{
		doAnimationAction (player, "sigh_deeply");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: That is the tricky part. It's currently in the possession of a crazed Mustafarian. I'm not sure what's driven him to insanity, but he's become a hermit, wandering the scorched lands erratically...making him hard to track, even for me. You need to find him.
			string_id message = new string_id (c_stringFile, "s_282");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: How? Just start running around hoping I bump in to him?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_290");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 83);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch83 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That is the tricky part. It's currently in the possession of a crazed Mustafarian. I'm not sure what's driven him to insanity, but he's become a hermit, wandering the scorched lands erratically...making him hard to track, even for me. You need to find him.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How? Just start running around hoping I bump in to him?
	if (response == "s_290")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: Amusing, but no. I have a plan. The Mustafarian survey droids scour the planet constantly, trying to find new resources. If you can gain access to their computer network, you might be able to find an approximate location of where the hermit was spotted last.
			string_id message = new string_id (c_stringFile, "s_294");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I don't think the Mustafarians will let me use their network.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_298");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 84);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch84 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Amusing, but no. I have a plan. The Mustafarian survey droids scour the planet constantly, trying to find new resources. If you can gain access to their computer network, you might be able to find an approximate location of where the hermit was spotted last.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't think the Mustafarians will let me use their network.
	if (response == "s_298")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: Probably not, but I'm sure you can find a way. Now, I have urgent matters to take care of. I will see you again, %TU. Please be swift in solving this. We are rapidly running out of time. If you need my assistance, go to northeastern shoreline between the old and new mining facilities and I will try to answer your call.
			string_id message = new string_id (c_stringFile, "s_302");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What could possibly be more important than helping with this?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_306");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 85);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch85 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Probably not, but I'm sure you can find a way. Now, I have urgent matters to take care of. I will see you again, %TU. Please be swift in solving this. We are rapidly running out of time. If you need my assistance, go to northeastern shoreline between the old and new mining facilities and I will try to answer your call.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What could possibly be more important than helping with this?
	if (response == "s_306")
	{
		som_kenobi_obi_wan_action_giveQuest1 (player, npc);

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The forces of evil are marching rapidly, %TU, and this old man needs to put a wrench in their cogs before it's too late. Farewell, for now.
			string_id message = new string_id (c_stringFile, "s_309");
			utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch87 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: No...why would you assume that?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Well, he must have been very powerful...corrupting the Jedi Masters.
	if (response == "s_327")
	{
		doAnimationAction (player, "shrug_hands");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: True, but when it comes to preserving life, the dark side of the Force will always be weak.
			string_id message = new string_id (c_stringFile, "s_331");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Well, I wouldn't know. So who survived then?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_344");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 88);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch88 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: True, but when it comes to preserving life, the dark side of the Force will always be weak.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Well, I wouldn't know. So who survived then?
	if (response == "s_344")
	{
		doAnimationAction (player, "shrug_shoulders");

		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: The elder of the masters, Erg Krow. As the crystal exploded, he managed to shield himself from some of the destruction. Clinging onto life, he found a large shard of the crystal in front of the dead masters.
			string_id message = new string_id (c_stringFile, "s_215");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very interesting.
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_219");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 76);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_obi_wan_handleBranch89 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I just told you, the entire galaxy. Very well, you can call me Ben. Now can I go on?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Fine, what is it you need help with?
	if (response == "s_354")
	{
		//-- [NOTE] 
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			//-- NPC: I'm not sure how much of this planet's history you have uncovered, but I'll tell you what I know. Thousands of years ago, long before my time, there was a large chapter of Jedi Knights located here. The planet was a center of Jedi information and artifacts, which attracted the vicious Sith.
			string_id message = new string_id (c_stringFile, "s_178");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: The Sith?
			boolean hasResponse0 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: As I suspected.
			boolean hasResponse1 = false;
			if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_180");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_186");

				utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 70);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.som_kenobi_obi_wan");

	ai_lib.setDefaultCalmBehavior (self, ai_lib.BEHAVIOR_SENTINEL);
	setCondition (self, CONDITION_CONVERSABLE);
	ai_lib.setAnimationMood (self, "npc_imperial");
	setInvulnerable (self, true);
	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	ai_lib.setDefaultCalmBehavior (self, ai_lib.BEHAVIOR_SENTINEL);
	setCondition (self, CONDITION_CONVERSABLE);
	ai_lib.setAnimationMood (self, "npc_imperial");
	setInvulnerable (self, true);
	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	setCondition (self, CONDITION_CONVERSABLE);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.som_kenobi_obi_wan");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition_completedAll (player, npc))
	{
		//-- NPC: Good to see you again, %TU. You're a hero unlike any others, my young friend.
		string_id message = new string_id (c_stringFile, "s_333");
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition_atTheEntranceFailed (player, npc))
	{
		//-- NPC: Are you ready to enter the chamber, %TU?
		string_id message = new string_id (c_stringFile, "s_313");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I think so.
		boolean hasResponse0 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Give me a moment to recover.
		boolean hasResponse1 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_315");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_317");

			utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 2);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "som_kenobi_obi_wan", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition_abandonedQuest3 (player, npc))
	{
		//-- NPC: Are you ready to pick up where we left off, %TU?
		string_id message = new string_id (c_stringFile, "s_335");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yes, I feel that I am.
		boolean hasResponse0 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: No. Not yet I'm afraid.
		boolean hasResponse1 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_337");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_339");

			utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 5);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "som_kenobi_obi_wan", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition_atTheEntrance (player, npc))
	{
		//-- NPC: I'm glad to see you made it, %TU. Let me explain how to do this.
		string_id message = new string_id (c_stringFile, "s_162");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What happened to you slowing down these guys?!
		boolean hasResponse0 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Please... I... I can't take much more of this...
		boolean hasResponse1 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_163");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_164");

			utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 8);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "som_kenobi_obi_wan", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition_finishedQuestSpared2 (player, npc))
	{
		//-- NPC: Everything is set, %TU. It is time to end this. You must quickly head to the hidden chamber, before it's too late.
		string_id message = new string_id (c_stringFile, "s_233");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: How do I get there?
		boolean hasResponse0 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Where is it?
		boolean hasResponse1 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_265");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_279");

			utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 14);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "som_kenobi_obi_wan", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition_finishedQuestKilled2 (player, npc))
	{
		//-- NPC: Everything is set, %TU. Now you need to make it to the hidden chamber quickly.
		string_id message = new string_id (c_stringFile, "s_291");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: How do I get there?
		boolean hasResponse0 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Where is it?
		boolean hasResponse1 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_293");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_301");

			utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 19);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "som_kenobi_obi_wan", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition_finishedQuest1 (player, npc))
	{
		//-- NPC: Good, you have the key. We are ready to proceed, %TU.
		string_id message = new string_id (c_stringFile, "s_96");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Good, this thing is strange. I don't like it at all.
		boolean hasResponse0 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_97");

			utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 24);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "som_kenobi_obi_wan", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition_onQuests (player, npc))
	{
		//-- NPC: I can't assist you any further right now, %TU. I have things that have to be done if we are to succeed.
		string_id message = new string_id (c_stringFile, "s_227");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Alright. I will do as you have asked.
		boolean hasResponse0 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I have lost the hermit.
		boolean hasResponse1 = false;
		if (som_kenobi_obi_wan_condition_failedQuest1 (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_349");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_350");

			utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 45);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "som_kenobi_obi_wan", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition_startFirstQuest (player, npc))
	{
		doAnimationAction (npc, "point_forward");

		//-- NPC: I am in dire need of your assistance, %TU. I've been watching you for some time, hoping that you would be the one I could entrust with this difficult task.
		string_id message = new string_id (c_stringFile, "s_106");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What...who are you?
		boolean hasResponse0 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Interesting. Who, or maybe I should say what, are you?
		boolean hasResponse1 = false;
		if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_121");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_152");

			utils.setScriptVar (player, "conversation.som_kenobi_obi_wan.branchId", 48);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "som_kenobi_obi_wan", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_obi_wan_condition__defaultCondition (player, npc))
	{
		//-- NPC: My business is not with you, %TU. Please step aside.
		string_id message = new string_id (c_stringFile, "s_356");
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "som_kenobi_obi_wan")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

	if (branchId == 2 && som_kenobi_obi_wan_handleBranch2 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 5 && som_kenobi_obi_wan_handleBranch5 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 8 && som_kenobi_obi_wan_handleBranch8 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 9 && som_kenobi_obi_wan_handleBranch9 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 10 && som_kenobi_obi_wan_handleBranch10 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 12 && som_kenobi_obi_wan_handleBranch12 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && som_kenobi_obi_wan_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && som_kenobi_obi_wan_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && som_kenobi_obi_wan_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 19 && som_kenobi_obi_wan_handleBranch19 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && som_kenobi_obi_wan_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 22 && som_kenobi_obi_wan_handleBranch22 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 24 && som_kenobi_obi_wan_handleBranch24 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 25 && som_kenobi_obi_wan_handleBranch25 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 26 && som_kenobi_obi_wan_handleBranch26 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 27 && som_kenobi_obi_wan_handleBranch27 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 28 && som_kenobi_obi_wan_handleBranch28 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 30 && som_kenobi_obi_wan_handleBranch30 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 31 && som_kenobi_obi_wan_handleBranch31 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 32 && som_kenobi_obi_wan_handleBranch32 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 34 && som_kenobi_obi_wan_handleBranch34 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 35 && som_kenobi_obi_wan_handleBranch35 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 36 && som_kenobi_obi_wan_handleBranch36 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 37 && som_kenobi_obi_wan_handleBranch37 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 38 && som_kenobi_obi_wan_handleBranch38 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 40 && som_kenobi_obi_wan_handleBranch40 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 41 && som_kenobi_obi_wan_handleBranch41 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 42 && som_kenobi_obi_wan_handleBranch42 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 43 && som_kenobi_obi_wan_handleBranch43 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 45 && som_kenobi_obi_wan_handleBranch45 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 48 && som_kenobi_obi_wan_handleBranch48 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 49 && som_kenobi_obi_wan_handleBranch49 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 50 && som_kenobi_obi_wan_handleBranch50 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 51 && som_kenobi_obi_wan_handleBranch51 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 52 && som_kenobi_obi_wan_handleBranch52 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 53 && som_kenobi_obi_wan_handleBranch53 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 54 && som_kenobi_obi_wan_handleBranch54 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 55 && som_kenobi_obi_wan_handleBranch55 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 56 && som_kenobi_obi_wan_handleBranch56 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 57 && som_kenobi_obi_wan_handleBranch57 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 58 && som_kenobi_obi_wan_handleBranch58 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 59 && som_kenobi_obi_wan_handleBranch59 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 60 && som_kenobi_obi_wan_handleBranch60 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 61 && som_kenobi_obi_wan_handleBranch61 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 62 && som_kenobi_obi_wan_handleBranch62 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 63 && som_kenobi_obi_wan_handleBranch63 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 64 && som_kenobi_obi_wan_handleBranch64 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 65 && som_kenobi_obi_wan_handleBranch65 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 66 && som_kenobi_obi_wan_handleBranch66 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 68 && som_kenobi_obi_wan_handleBranch68 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 69 && som_kenobi_obi_wan_handleBranch69 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 70 && som_kenobi_obi_wan_handleBranch70 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 71 && som_kenobi_obi_wan_handleBranch71 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 72 && som_kenobi_obi_wan_handleBranch72 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 73 && som_kenobi_obi_wan_handleBranch73 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 74 && som_kenobi_obi_wan_handleBranch74 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 75 && som_kenobi_obi_wan_handleBranch75 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 76 && som_kenobi_obi_wan_handleBranch76 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 77 && som_kenobi_obi_wan_handleBranch77 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 78 && som_kenobi_obi_wan_handleBranch78 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 79 && som_kenobi_obi_wan_handleBranch79 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 80 && som_kenobi_obi_wan_handleBranch80 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 81 && som_kenobi_obi_wan_handleBranch81 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 82 && som_kenobi_obi_wan_handleBranch82 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 83 && som_kenobi_obi_wan_handleBranch83 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 84 && som_kenobi_obi_wan_handleBranch84 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 85 && som_kenobi_obi_wan_handleBranch85 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 87 && som_kenobi_obi_wan_handleBranch87 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 88 && som_kenobi_obi_wan_handleBranch88 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 89 && som_kenobi_obi_wan_handleBranch89 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.som_kenobi_obi_wan.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

