// ======================================================================
//
// tatooine_knives_thrust_kavas.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.35 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.features;
include library.groundquests;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/tatooine_knives_thrust_kavas";

// ======================================================================
// Script Conditions
// ======================================================================

boolean tatooine_knives_thrust_kavas_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean tatooine_knives_thrust_kavas_condition_onQuest (obj_id player, obj_id npc)
{

	int questId1 = questGetQuestId("quest/tatooine_knives_thrust");
	
	boolean OnTask= 	(questIsQuestActive(questId1, player));
						
	return OnTask;					
						
	
}

// ----------------------------------------------------------------------

boolean tatooine_knives_thrust_kavas_condition_haveBankaccount (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_thrust");
	int finishBank = groundquests.getTaskId(questId1, "tatooine_knives_thrust_e8"); 
	
	boolean onTask = questIsTaskActive(questId1, finishBank, player);
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_thrust_kavas_condition_questComplete (obj_id player, obj_id npc)
{
	int questId1 = questGetQuestId("quest/tatooine_knives_thrust");
	
	boolean OnTask = 	(questIsQuestComplete(questId1, player));
	
	return OnTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_thrust_kavas_condition_onTorP (obj_id player, obj_id npc)
{

	int questId1 = questGetQuestId("quest/tatoonie_knives_thrust");
	int questId2 = questGetQuestId("quest/tatoonie_knives_parry");
	
	boolean OnTask= 	(questIsQuestActive(questId1, player))||(questIsQuestActive(questId2, player));
						
	return OnTask;					
						
	
}

// ----------------------------------------------------------------------

boolean tatooine_knives_thrust_kavas_condition_haveCash (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_thrust");
	int cashInHand = groundquests.getTaskId(questId1, "tatooine_knives_thrust_e12"); 
	
	boolean onTask = questIsTaskActive(questId1, cashInHand, player);
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_thrust_kavas_condition_haveTools (obj_id player, obj_id npc)
{	
	int questId1 = questGetQuestId("quest/tatooine_knives_thrust");
	int finishBank = groundquests.getTaskId(questId1, "tatooine_knives_thrust_e14"); 
	
	boolean onTask = questIsTaskActive(questId1, finishBank, player);
	
	return onTask;

}

// ----------------------------------------------------------------------

boolean tatooine_knives_thrust_kavas_condition_questBlocked (obj_id player, obj_id npc)
{
	// The quest as a whole has been completed.
	return groundquests.isQuestDisabled ("tatooine_knives_thrust");
}

// ----------------------------------------------------------------------

boolean tatooine_knives_thrust_kavas_condition_isThisDisabled (obj_id player, obj_id npc)
{
	return groundquests.isQuestDisabled ("tatooine_knives_thrust") ||
		groundquests.isQuestDisabled ("tatooine_knives_parry") ||
		groundquests.isQuestDisabled ("tatooine_knives_fencing");
}

// ======================================================================
// Script Actions
// ======================================================================

void tatooine_knives_thrust_kavas_action_facePlayer (obj_id player, obj_id npc)
{
	faceTo(npc, player);
}

// ----------------------------------------------------------------------

void tatooine_knives_thrust_kavas_action_giveQuest (obj_id player, obj_id npc)
{	
	int questId = questGetQuestId("quest/tatooine_knives_thrust");

	groundquests.grantQuest(questId, player, npc, true);

}

// ----------------------------------------------------------------------

void tatooine_knives_thrust_kavas_action_signalBank (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "tatooine_knives_thrust_launch_e9");
}

// ----------------------------------------------------------------------

void tatooine_knives_thrust_kavas_action_signalSlicer (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "tatooine_knives_thrust_launch_e13");
}

// ----------------------------------------------------------------------

void tatooine_knives_thrust_kavas_action_signalReward (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "tatooine_knives_thrust_launch_e15");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int tatooine_knives_thrust_kavas_handleBranch2 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well aren't you good looking? I would really love to chat but things are a bit rushed right now. Come back in a bit though. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will.
	if (response == "s_87")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: I look forward to it.
			string_id message = new string_id (c_stringFile, "s_89");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch4 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] One or both quests are complete
	//-- NPC: I have nothing for you sweetie. Valarian didn't do anything worth mentioning to that idiot Ind. I am enough trouble for trying to make her see what a waste of air Ind truly is.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am sorry to hear that.
	if (response == "s_91")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: I am sure you are.
			string_id message = new string_id (c_stringFile, "s_93");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch6 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Slicer Tools back. Reward
	//-- NPC: Well you have really done well for me. Bleena will be able to get into Ind's accounts and then we will have the evidence that I need.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Glad to hear it. So what do I get?
	if (response == "s_99")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: So you were doing this for the money, rather than your uncontrolled desire to help me in my time of need? I am hurt. I have a payment here for you. And you can help me finish the job.
			string_id message = new string_id (c_stringFile, "s_100");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: How so?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_101");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 7);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch7 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: So you were doing this for the money, rather than your uncontrolled desire to help me in my time of need? I am hurt. I have a payment here for you. And you can help me finish the job.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How so?
	if (response == "s_101")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "taken_aback");

			tatooine_knives_thrust_kavas_action_facePlayer (player, npc);

			//-- NPC: Just go to Valarain and tell her you know what happened to the cash lost when the courier got mug. Tell her that Ind mastermind it all. Can you do that? For me?
			string_id message = new string_id (c_stringFile, "s_102");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: But of course. 
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_103");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 8);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch8 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Just go to Valarain and tell her you know what happened to the cash lost when the courier got mug. Tell her that Ind mastermind it all. Can you do that? For me?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: But of course. 
	if (response == "s_103")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "thank");

			tatooine_knives_thrust_kavas_action_signalReward (player, npc);

			//-- NPC: That's what I wanted to hear. You are such a dear. 
			string_id message = new string_id (c_stringFile, "s_104");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch10 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Player beats up couier and takes their cash. 
	//-- NPC: Good for you. I was worried. I heard that Ind warned the courier to be on the look out for trouble.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Nothing I couldn't handle. Here is the cash. What's next?
	if (response == "s_50")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: Always straight to the heart of the matter. I like someone who sees what they want and goes straight for it. Well, right now there is a small problem.
			string_id message = new string_id (c_stringFile, "s_52");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What problem?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Just tell me what I have to do.
			boolean hasResponse1 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_53");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_55");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 11);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch11 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Always straight to the heart of the matter. I like someone who sees what they want and goes straight for it. Well, right now there is a small problem.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What problem?
	if (response == "s_53")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: Bleena, my slicer, was going to place an equivalent amount of credits equal to the street value of this cash, into Ind's account but now he can't.
			string_id message = new string_id (c_stringFile, "s_84");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Why not?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_86");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Just tell me what I have to do.
	if (response == "s_55")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			tatooine_knives_thrust_kavas_action_signalSlicer (player, npc);

			//-- NPC: Go to the Jawa camp and get my slicer's tools back. Then we can break into Ind's bank account, deposit the stolen cash and have the 'evidence' necessary for Valarian to take action against that nerf herder. Here are the coordinates.
			string_id message = new string_id (c_stringFile, "s_97");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am on my way.
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_111");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 16);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch12 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Bleena, my slicer, was going to place an equivalent amount of credits equal to the street value of this cash, into Ind's account but now he can't.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why not?
	if (response == "s_86")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: Bleena has had his slicer tools stolen. Looks like they got fenced to some Jawas. I need you to go out to the Jawa camp and get Bleena's tool back.
			string_id message = new string_id (c_stringFile, "s_88");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Its a good as done. 
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Not sure this is for me.
			boolean hasResponse1 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_90");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_94");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 13);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch13 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Bleena has had his slicer tools stolen. Looks like they got fenced to some Jawas. I need you to go out to the Jawa camp and get Bleena's tool back.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Its a good as done. 
	if (response == "s_90")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			tatooine_knives_thrust_kavas_action_signalSlicer (player, npc);

			//-- NPC: Great. Bleena has a tracker set up, so he knows exactly where the Jawa's are. Clever thing isn't he?  Now off you go.
			string_id message = new string_id (c_stringFile, "s_92");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Not sure this is for me.
	if (response == "s_94")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "sigh_deeply");

			tatooine_knives_thrust_kavas_action_facePlayer (player, npc);

			//-- NPC: Its ok sweetie. This will keep for a little while. Come back when you are ready.
			string_id message = new string_id (c_stringFile, "s_96");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch16 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Go to the Jawa camp and get my slicer's tools back. Then we can break into Ind's bank account, deposit the stolen cash and have the 'evidence' necessary for Valarian to take action against that nerf herder. Here are the coordinates.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am on my way.
	if (response == "s_111")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: Be safe.
			string_id message = new string_id (c_stringFile, "s_112");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch18 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Player gets the bank account
	//-- NPC: Hope things went smoothly.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Not a problem. What is next?
	if (response == "s_38")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: Next is something easy. A courier will be taking cash from the gambling halls here to the bank to deposit. You just need to make sure that they make the deposit with you.
			string_id message = new string_id (c_stringFile, "s_43");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Got it. Where do I go?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Cash? don't you just transfer the credits directly to the bank?
			boolean hasResponse1 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_45");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_44");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 20);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You didn't tell me about the security droids.
	if (response == "s_29")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "hair_flip");

			//-- NPC: That must have been some Trade Federation junk that Ind bought from the Jawas. Nothing my big strong friend couldn't handle. Right?
			string_id message = new string_id (c_stringFile, "s_31");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Well yes... it wasn't to much trouble. So what is next?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_33");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 19);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch19 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That must have been some Trade Federation junk that Ind bought from the Jawas. Nothing my big strong friend couldn't handle. Right?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Well yes... it wasn't to much trouble. So what is next?
	if (response == "s_33")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: Next is something easy. A courier will be taking cash from the gambling halls here to the bank to deposit. You just need to make sure that they make the deposit with you.
			string_id message = new string_id (c_stringFile, "s_43");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Got it. Where do I go?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Cash? don't you just transfer the credits directly to the bank?
			boolean hasResponse1 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_45");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_44");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 20);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Next is something easy. A courier will be taking cash from the gambling halls here to the bank to deposit. You just need to make sure that they make the deposit with you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Got it. Where do I go?
	if (response == "s_45")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			tatooine_knives_thrust_kavas_action_signalBank (player, npc);

			//-- NPC: The best place to ambush him is near the bank. I have loaded the coordinates up to your data pad. And be careful. Ind uses  a professional for these runs. They will go after you if they spot you first. 
			string_id message = new string_id (c_stringFile, "s_46");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I will be careful.
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_109");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 21);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Cash? don't you just transfer the credits directly to the bank?
	if (response == "s_44")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			tatooine_knives_thrust_kavas_action_facePlayer (player, npc);

			//-- NPC: You haven't been out here on the Rim for long, have you sweetie? there are at least 15 major forms of currency in circulation here, and 5 of those forms are not electronic but based on something that that race values - gold, or platinum. We even take a certain type of tree bark. If they want to gamble it, we will accept it.
			string_id message = new string_id (c_stringFile, "s_47");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: OK so where do I go to take down the courier?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_48");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 23);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch21 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The best place to ambush him is near the bank. I have loaded the coordinates up to your data pad. And be careful. Ind uses  a professional for these runs. They will go after you if they spot you first. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will be careful.
	if (response == "s_109")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "flex3");

			//-- NPC: Good.
			string_id message = new string_id (c_stringFile, "s_110");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch23 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You haven't been out here on the Rim for long, have you sweetie? there are at least 15 major forms of currency in circulation here, and 5 of those forms are not electronic but based on something that that race values - gold, or platinum. We even take a certain type of tree bark. If they want to gamble it, we will accept it.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: OK so where do I go to take down the courier?
	if (response == "s_48")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			tatooine_knives_thrust_kavas_action_signalBank (player, npc);

			//-- NPC: The best place to ambush him is near the bank. I have loaded the coordinates up to your data pad. And be careful. Ind uses  a professional for these runs. They will go after you if they spot you first. 
			string_id message = new string_id (c_stringFile, "s_46");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I will be careful.
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_109");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 21);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch25 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Starting general Node. 
	//-- NPC: What can I do for you?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Well actually the question is whether I can do anything for you?
	if (response == "s_58")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			tatooine_knives_thrust_kavas_action_facePlayer (player, npc);

			//-- NPC: Well there is a proposition if I have ever heard one. You afraid of getting your hands dirty cutie?
			string_id message = new string_id (c_stringFile, "s_60");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Not one bit. What do you need done?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Actually yes I am.
			boolean hasResponse1 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_64");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_77");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 26);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No, nothing comes to mind. 
	if (response == "s_81")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well if you think of something come on back and talk. 
			string_id message = new string_id (c_stringFile, "s_85");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch26 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well there is a proposition if I have ever heard one. You afraid of getting your hands dirty cutie?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Not one bit. What do you need done?
	if (response == "s_64")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			tatooine_knives_thrust_kavas_action_facePlayer (player, npc);

			//-- NPC: I need to expose a colleague for the traitor that I know he is.
			string_id message = new string_id (c_stringFile, "s_66");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Sounds like something I can help with.
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_68");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 27);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Actually yes I am.
	if (response == "s_77")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well if you think of something come on back and talk. 
			string_id message = new string_id (c_stringFile, "s_85");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch27 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I need to expose a colleague for the traitor that I know he is.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Sounds like something I can help with.
	if (response == "s_68")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: The plan is to prove to Lady Valarain that Ind is stealing her gambling profits. I don't have any evidence that he is doing this, so I say we plant some on him. 
			string_id message = new string_id (c_stringFile, "s_70");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: If he is crooked then manufacturing a case against him isn't wrong.... is it?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: We are going to manufacture evidence?  Forget it, I am out of here. 
			boolean hasResponse1 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_72");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_76");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 28);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch28 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The plan is to prove to Lady Valarain that Ind is stealing her gambling profits. I don't have any evidence that he is doing this, so I say we plant some on him. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: If he is crooked then manufacturing a case against him isn't wrong.... is it?
	if (response == "s_72")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			tatooine_knives_thrust_kavas_action_giveQuest (player, npc);

			//-- NPC: No it isn't wrong, just expedient. First you have to break into his rooms and steal his bank access codes. Ind is a very secretive triclops, but I have had a tail on him for the last two days. He will contact you and show you where Ind lives.
			string_id message = new string_id (c_stringFile, "s_74");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: How will he contact me?
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_107");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 29);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: We are going to manufacture evidence?  Forget it, I am out of here. 
	if (response == "s_76")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: Thought you said you didn't mind getting your hands dirty. Well come back and talk if you change your mind. 
			string_id message = new string_id (c_stringFile, "s_78");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I will.
			boolean hasResponse0 = false;
			if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_95");

				utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 31);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

				chat.chat (npc, player, message);
				npcEndConversation (player);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch29 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: No it isn't wrong, just expedient. First you have to break into his rooms and steal his bank access codes. Ind is a very secretive triclops, but I have had a tail on him for the last two days. He will contact you and show you where Ind lives.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How will he contact me?
	if (response == "s_107")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: By a comm.
			string_id message = new string_id (c_stringFile, "s_108");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_knives_thrust_kavas_handleBranch31 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Thought you said you didn't mind getting your hands dirty. Well come back and talk if you change your mind. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will.
	if (response == "s_95")
	{
		//-- [NOTE] 
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			//-- NPC: I will see you then.
			string_id message = new string_id (c_stringFile, "s_106");
			utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

			chat.chat (npc, player, message);
			npcEndConversation (player);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.tatooine_knives_thrust_kavas");

	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);
	setInvulnerable (self, true);
	setName (self, "Kavas");
	ai_lib.setDefaultCalmBehavior( self, ai_lib.BEHAVIOR_SENTINEL );

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);
	setInvulnerable (self, true);
	setName (self, "Kavas");
	ai_lib.setDefaultCalmBehavior( self, ai_lib.BEHAVIOR_SENTINEL );

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	setCondition (self, CONDITION_CONVERSABLE);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.tatooine_knives_thrust_kavas");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (tatooine_knives_thrust_kavas_condition_isThisDisabled (player, npc))
	{
		//-- NPC: Please come back later.
		string_id message = new string_id (c_stringFile, "s_83");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_knives_thrust_kavas_condition_questBlocked (player, npc))
	{
		doAnimationAction (npc, "hair_flip");

		//-- NPC: Well aren't you good looking? I would really love to chat but things are a bit rushed right now. Come back in a bit though. 
		string_id message = new string_id (c_stringFile, "s_79");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I will.
		boolean hasResponse0 = false;
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_87");

			utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 2);

			npcStartConversation (player, npc, "tatooine_knives_thrust_kavas", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] One or both quests are complete
	if (tatooine_knives_thrust_kavas_condition_questComplete (player, npc))
	{
		tatooine_knives_thrust_kavas_action_facePlayer (player, npc);

		//-- NPC: I have nothing for you sweetie. Valarian didn't do anything worth mentioning to that idiot Ind. I am enough trouble for trying to make her see what a waste of air Ind truly is.
		string_id message = new string_id (c_stringFile, "s_105");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I am sorry to hear that.
		boolean hasResponse0 = false;
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_91");

			utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 4);

			npcStartConversation (player, npc, "tatooine_knives_thrust_kavas", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] Slicer Tools back. Reward
	if (tatooine_knives_thrust_kavas_condition_haveTools (player, npc))
	{
		doAnimationAction (npc, "sigh_deeply");

		tatooine_knives_thrust_kavas_action_facePlayer (player, npc);

		//-- NPC: Well you have really done well for me. Bleena will be able to get into Ind's accounts and then we will have the evidence that I need.
		string_id message = new string_id (c_stringFile, "s_98");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Glad to hear it. So what do I get?
		boolean hasResponse0 = false;
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_99");

			utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 6);

			npcStartConversation (player, npc, "tatooine_knives_thrust_kavas", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] Player beats up couier and takes their cash. 
	if (tatooine_knives_thrust_kavas_condition_haveCash (player, npc))
	{
		//-- NPC: Good for you. I was worried. I heard that Ind warned the courier to be on the look out for trouble.
		string_id message = new string_id (c_stringFile, "s_49");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Nothing I couldn't handle. Here is the cash. What's next?
		boolean hasResponse0 = false;
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_50");

			utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 10);

			npcStartConversation (player, npc, "tatooine_knives_thrust_kavas", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] Player gets the bank account
	if (tatooine_knives_thrust_kavas_condition_haveBankaccount (player, npc))
	{
		tatooine_knives_thrust_kavas_action_facePlayer (player, npc);

		//-- NPC: Hope things went smoothly.
		string_id message = new string_id (c_stringFile, "s_40");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Not a problem. What is next?
		boolean hasResponse0 = false;
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: You didn't tell me about the security droids.
		boolean hasResponse1 = false;
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_38");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_29");

			utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 18);

			npcStartConversation (player, npc, "tatooine_knives_thrust_kavas", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] General Why haven't you gotten what I asked for. 
	if (tatooine_knives_thrust_kavas_condition_onQuest (player, npc))
	{
		doAnimationAction (npc, "cough_polite");

		//-- NPC: You agreed to help me. You are in too deep to pull out now, dearie. You want to satisfy me ... don't you?
		string_id message = new string_id (c_stringFile, "s_51");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] Starting general Node. 
	if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
	{
		doAnimationAction (npc, "bow");

		tatooine_knives_thrust_kavas_action_facePlayer (player, npc);

		//-- NPC: What can I do for you?
		string_id message = new string_id (c_stringFile, "s_56");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Well actually the question is whether I can do anything for you?
		boolean hasResponse0 = false;
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: No, nothing comes to mind. 
		boolean hasResponse1 = false;
		if (tatooine_knives_thrust_kavas_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_58");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_81");

			utils.setScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId", 25);

			npcStartConversation (player, npc, "tatooine_knives_thrust_kavas", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "tatooine_knives_thrust_kavas")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

	if (branchId == 2 && tatooine_knives_thrust_kavas_handleBranch2 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 4 && tatooine_knives_thrust_kavas_handleBranch4 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 6 && tatooine_knives_thrust_kavas_handleBranch6 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 7 && tatooine_knives_thrust_kavas_handleBranch7 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 8 && tatooine_knives_thrust_kavas_handleBranch8 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 10 && tatooine_knives_thrust_kavas_handleBranch10 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 11 && tatooine_knives_thrust_kavas_handleBranch11 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 12 && tatooine_knives_thrust_kavas_handleBranch12 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 13 && tatooine_knives_thrust_kavas_handleBranch13 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 16 && tatooine_knives_thrust_kavas_handleBranch16 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 18 && tatooine_knives_thrust_kavas_handleBranch18 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 19 && tatooine_knives_thrust_kavas_handleBranch19 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && tatooine_knives_thrust_kavas_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 21 && tatooine_knives_thrust_kavas_handleBranch21 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 23 && tatooine_knives_thrust_kavas_handleBranch23 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 25 && tatooine_knives_thrust_kavas_handleBranch25 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 26 && tatooine_knives_thrust_kavas_handleBranch26 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 27 && tatooine_knives_thrust_kavas_handleBranch27 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 28 && tatooine_knives_thrust_kavas_handleBranch28 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 29 && tatooine_knives_thrust_kavas_handleBranch29 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 31 && tatooine_knives_thrust_kavas_handleBranch31 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.tatooine_knives_thrust_kavas.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

