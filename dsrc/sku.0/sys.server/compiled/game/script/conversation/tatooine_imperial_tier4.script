// ======================================================================
//
// tatooine_imperial_tier4.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.36 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.factions;
include library.skill;
include library.space_flags;
include library.space_quest;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/tatooine_imperial_tier4";

// ======================================================================
// Script Conditions
// ======================================================================

boolean tatooine_imperial_tier4_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isWrongFaction (obj_id player, obj_id npc)
{
	//check the player has the correct novice skill box for this trainer
	return (!hasSkill(player,"pilot_imperial_navy_novice"));
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasCompletedTier3 (obj_id player, obj_id npc)
{
	/*
	if (!hasSkill( player, "pilot_imperial_navy_starships_03" ))
		return false;
	else if (!hasSkill( player, "pilot_imperial_navy_procedures_03" ))
		return false;
	else if (!hasSkill( player, "pilot_imperial_navy_droid_03" ))
		return false;
	else if (!hasSkill( player, "pilot_imperial_navy_weapons_03" ))
		return false;
	else
		return true;
	*/
	
	return space_flags.hasCompletedTierThree(player);
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isOnMission (obj_id player, obj_id npc)
{
	return ( space_quest.hasQuest(player) );
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_faliedMissionOne (obj_id player, obj_id npc)
{
	if ( space_quest.hasAbortedQuestRecursive( player, "patrol", "tatooine_imperial_tier4_1" ) ||
		 space_quest.hasFailedQuestRecursive( player, "patrol", "tatooine_imperial_tier4_1" ) )
		 return true;

	return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_failedMissionTwo (obj_id player, obj_id npc)
{
	if ( space_quest.hasAbortedQuestRecursive( player, "recovery", "tatooine_imperial_tier4_2" ) ||
		 space_quest.hasFailedQuestRecursive( player, "recovery", "tatooine_imperial_tier4_2" ) )
		 return true;

	return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_failedMissionThree (obj_id player, obj_id npc)
{
	if ( space_quest.hasAbortedQuestRecursive( player, "escort", "tatooine_imperial_tier4_3" ) ||
		 space_quest.hasFailedQuestRecursive( player, "escort", "tatooine_imperial_tier4_3" ) )
		 return true;

	return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_failedMissionFour (obj_id player, obj_id npc)
{
	if ( space_quest.hasAbortedQuestRecursive( player, "assassinate", "tatooine_imperial_tier4_4" ) ||
		 space_quest.hasFailedQuestRecursive( player, "assassinate", "tatooine_imperial_tier4_4" ) )
		 return true;

	return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_failedMasterMission (obj_id player, obj_id npc)
{

	if ( space_quest.hasAbortedQuestRecursive( player, "destroy", "tatooine_imperial_master" ) ||
		 space_quest.hasFailedQuestRecursive( player, "destroy", "tatooine_imperial_master" ) )
		 return true;

	return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isReadyForTraining (obj_id player, obj_id npc)
{
	//see if the player has NOT completed all of tier 4
	//AND has enough XP to buy a tier-4 skill
	if (tatooine_imperial_tier4_condition_hasCompletedTier4(player,npc))
		return false;//you're already done
		
	return ( space_quest.isPlayerQualifiedForSkill( player, "pilot_imperial_navy_starships_04" ) );
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasCompletedTier4 (obj_id player, obj_id npc)
{
	/*
	if (!hasSkill( player, "pilot_imperial_navy_starships_04" ))
		return false;
	else if (!hasSkill( player, "pilot_imperial_navy_procedures_04" ))
		return false;
	else if (!hasSkill( player, "pilot_imperial_navy_droid_04" ))
		return false;
	else if (!hasSkill( player, "pilot_imperial_navy_weapons_04" ))
		return false;
	else
		return true;
	*/
	
	return space_flags.hasCompletedTierFour(player);
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasMasterSkill (obj_id player, obj_id npc)
{
	return (hasSkill( player, "pilot_imperial_navy_master" ));
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isGettingMissionOneReward (obj_id player, obj_id npc)
{
	if (!space_quest.hasCompletedQuestRecursive( player, "patrol", "tatooine_imperial_tier4_1" ))
		return false;//haven't completed it, so no reward
	
	//you've completed it, so you must be here for the reward:
	if (!space_quest.hasReceivedReward( player, "patrol", "tatooine_imperial_tier4_1" ))
		return true;
	else
		return false;	
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isGettingMissionTwoReward (obj_id player, obj_id npc)
{
	if (!space_quest.hasCompletedQuestRecursive( player, "recovery", "tatooine_imperial_tier4_2" ))
		return false;//haven't completed it, so no reward
	
	//you've completed it, so you must be here for the reward:
	if (!space_quest.hasReceivedReward( player, "recovery", "tatooine_imperial_tier4_2" ))
		return true;
	else
		return false;	
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isGettingMissionThreeReward (obj_id player, obj_id npc)
{
	if (!space_quest.hasCompletedQuestRecursive( player, "escort", "tatooine_imperial_tier4_3" ))
		return false;//haven't completed it, so no reward
	
	//you've completed it, so you must be here for the reward:
	if (!space_quest.hasReceivedReward( player, "escort", "tatooine_imperial_tier4_3" ))
		return true;
	else
		return false;	
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isGettingMissionFourReward (obj_id player, obj_id npc)
{
	if (!space_quest.hasCompletedQuestRecursive( player, "assassinate", "tatooine_imperial_tier4_4" ))
		return false;//haven't completed it, so no reward
	
	//you've completed it, so you must be here for the reward:
	if (!space_quest.hasReceivedReward( player, "assassinate", "tatooine_imperial_tier4_4" ))
		return true;
	else
		return false;	
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isGettingMasterMissionReward (obj_id player, obj_id npc)
{
	if (!space_quest.hasCompletedQuestRecursive( player, "destroy", "tatooine_imperial_master" ))
		return false;//haven't completed it, so no reward
	
	//you've completed it, so you must be here for the reward:
	if (!space_quest.hasReceivedReward( player, "destroy", "tatooine_imperial_master" ))
		return true;
	else
		return false;	
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasCompletedMissionOne (obj_id player, obj_id npc)
{
	if (space_quest.hasCompletedQuestRecursive( player, "patrol", "tatooine_imperial_tier4_1" ))
		return true;
		
	else
		return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasCompletedMissionTwo (obj_id player, obj_id npc)
{
	if (space_quest.hasCompletedQuestRecursive( player, "recovery", "tatooine_imperial_tier4_2" ))
		return true;
		
	else
		return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasCompletedMissionThree (obj_id player, obj_id npc)
{
	if (space_quest.hasCompletedQuestRecursive( player, "escort", "tatooine_imperial_tier4_3" ))
		return true;
		
	else
		return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasDroidSkill (obj_id player, obj_id npc)
{
	if(!hasSkill(player, "pilot_imperial_navy_droid_04"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasStarshipSkill (obj_id player, obj_id npc)
{
	if(!hasSkill(player, "pilot_imperial_navy_starships_04"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasProceduresSkill (obj_id player, obj_id npc)
{
	if(!hasSkill(player, "pilot_imperial_navy_procedures_04"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasWeaponSkill (obj_id player, obj_id npc)
{
	if(!hasSkill(player, "pilot_imperial_navy_weapons_04"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isPilot (obj_id player, obj_id npc)
{
	return space_flags.hasAnyPilotSkill(player);
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_onMyTrack (obj_id player, obj_id npc)
{
	return space_flags.isSpaceTrack(player, space_flags.IMPERIAL_TATOOINE);
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_canFlyNonTrackDuty (obj_id player, obj_id npc)
{
	if(space_flags.hasCompletedTierThree(player) && !space_quest.hasQuest(player))
		return true;
		
	return false;
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasMetMe (obj_id player, obj_id npc)
{
	return space_flags.hasSpaceFlag(player, "metTier4");
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_hasNegativeFaction (obj_id player, obj_id npc)
{
	return ( factions.getFactionStanding( player, factions.FACTION_IMPERIAL ) < 0.0f );
}

// ----------------------------------------------------------------------

boolean tatooine_imperial_tier4_condition_isReadyForMission (obj_id player, obj_id npc)
{
	return space_flags.hasSpaceFlag(player, "readyForTier4Mission");
}

// ======================================================================
// Script Actions
// ======================================================================

void tatooine_imperial_tier4_action_grantMissionOne (obj_id player, obj_id npc)
{
	space_quest.grantQuest( player, "patrol", "tatooine_imperial_tier4_1" );
	
	if(space_flags.hasSpaceFlag(player, "readyForTier4Mission"))
		space_flags.removeSpaceFlag(player, "readyForTier4Mission");
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantMissionTwo (obj_id player, obj_id npc)
{
	space_quest.grantQuest( player, "recovery", "tatooine_imperial_tier4_2" );
	
	if(space_flags.hasSpaceFlag(player, "readyForTier4Mission"))
		space_flags.removeSpaceFlag(player, "readyForTier4Mission");
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantMissionThree (obj_id player, obj_id npc)
{
	space_quest.grantQuest( player, "escort", "tatooine_imperial_tier4_3" );
	
	if(space_flags.hasSpaceFlag(player, "readyForTier4Mission"))
		space_flags.removeSpaceFlag(player, "readyForTier4Mission");
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantMissionFour (obj_id player, obj_id npc)
{
	space_quest.grantQuest( player, "assassinate", "tatooine_imperial_tier4_4" );
	
	if(space_flags.hasSpaceFlag(player, "readyForTier4Mission"))
		space_flags.removeSpaceFlag(player, "readyForTier4Mission");
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantDutyMissionOne (obj_id player, obj_id npc)
{
	space_quest.grantQuest( player, "destroy_duty", "tatooine_imperial_tier4_destroyduty_1" );
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantDutyMissionTwo (obj_id player, obj_id npc)
{
	space_quest.grantQuest( player, "escort_duty", "tatooine_imperial_tier4_escortduty_1" );
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantDutyMissionThree (obj_id player, obj_id npc)
{
	space_quest.grantQuest( player, "recovery_duty", "tatooine_imperial_tier4_recoveryduty_1" );
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantDutyMissionFour (obj_id player, obj_id npc)
{
	space_quest.grantQuest( player, "rescue_duty", "tatooine_imperial_tier4_rescueduty_1" );
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_rewardForMissionOne (obj_id player, obj_id npc)
{
	if (!space_quest.hasReceivedReward( player, "patrol", "tatooine_imperial_tier4_1" ))
	{
		space_quest.giveReward( player, "patrol", "tatooine_imperial_tier4_1", 10000, "object/tangible/ship/components/weapon/wpn_mission_reward_imperial_sds_boltdriver.iff" );
		factions.addFactionStanding( player, factions.FACTION_IMPERIAL, 150.0f );
	}
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_rewardForMissionTwo (obj_id player, obj_id npc)
{
	if (!space_quest.hasReceivedReward( player, "recovery", "tatooine_imperial_tier4_2" ))
	{
		space_quest.giveReward( player, "recovery", "tatooine_imperial_tier4_2", 10000, "object/tangible/ship/components/shield_generator/shd_mission_reward_imperial_cygnus_holoscreen.iff" );
		factions.addFactionStanding( player, factions.FACTION_IMPERIAL, 150.0f );
	}
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_rewardForMissionThree (obj_id player, obj_id npc)
{
	if (!space_quest.hasReceivedReward( player, "escort", "tatooine_imperial_tier4_3" ))
	{
		space_quest.giveReward( player, "escort", "tatooine_imperial_tier4_3", 10000, "object/tangible/ship/components/armor/arm_mission_reward_imperial_rss_special_durasteel.iff" );
		factions.addFactionStanding( player, factions.FACTION_IMPERIAL, 150.0f );
	}
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_rewardForMissionFour (obj_id player, obj_id npc)
{
	if (!space_quest.hasReceivedReward( player, "assassinate", "tatooine_imperial_tier4_4" ))
	{
		space_quest.giveReward( player, "assassinate", "tatooine_imperial_tier4_4", 10000, "object/tangible/ship/components/reactor/rct_mission_reward_imperial_rss_advanced_military.iff" );
		factions.addFactionStanding( player, factions.FACTION_IMPERIAL, 150.0f );
	}
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantDroidSkill (obj_id player, obj_id npc)
{
	skill.purchaseSkill( player, "pilot_imperial_navy_droid_04" );	
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantProcedureSkill (obj_id player, obj_id npc)
{
	skill.purchaseSkill( player, "pilot_imperial_navy_procedures_04" );
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantWeaponSkill (obj_id player, obj_id npc)
{
	skill.purchaseSkill( player, "pilot_imperial_navy_weapons_04" );
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_grantStarshipSkill (obj_id player, obj_id npc)
{
	skill.purchaseSkill( player, "pilot_imperial_navy_starships_04" );	
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_setMetMe (obj_id player, obj_id npc)
{
	space_flags.setSpaceFlag(player, "metTier4", true);
}

// ----------------------------------------------------------------------

void tatooine_imperial_tier4_action_setReadyForMission (obj_id player, obj_id npc)
{
	space_flags.setSpaceFlag(player, "readyForTier4Mission", true);
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int tatooine_imperial_tier4_handleBranch3 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: What are you doing here pilot. You are not a part of this unit.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I would like to request a mission.
	if (response == "s_4854758d")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition_canFlyNonTrackDuty (player, npc))
		{
			//-- NPC: I do not have any missions for which you are authorized. But I do have some elective duty tasks if you are interested. Would you like a briefing?
			string_id message = new string_id (c_stringFile, "s_7247f243");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Please.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_8a4f7617");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 4);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: You are not authorized to fly the missions that I have. You would probably have more luck talking to your commanding officer.
			string_id message = new string_id (c_stringFile, "s_e542a06b");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch4 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I do not have any missions for which you are authorized. But I do have some elective duty tasks if you are interested. Would you like a briefing?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Please.
	if (response == "s_8a4f7617")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well. The sitrep is as follows. A pirate clan has foolishly chosen to set up operations in this system. They must be dealt with. 
			string_id message = new string_id (c_stringFile, "s_3e6a4237");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I see.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_61657d0f");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 93);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch6 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: What is your major malfunction, %TU!?  I just got a report that you're under investigation for treason!  Do you realize how this makes ME look?  I should shoot you myself.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What?!
	if (response == "s_7090182")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_disgust");

			//-- NPC: Don't play innocent with me, %TU.  You need to get this situation straightened out.  If you cannot improve your standing with the Empire, then you can't be trusted with any more assignments.  Do I make myself clear?  You are dismissed.
			string_id message = new string_id (c_stringFile, "s_c8003afd");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch10 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] You failed mission 1, do it over.
	//-- NPC: You have not done your job!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I haven't?
	if (response == "s_8f4d001d")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: I should say not! I am unsatisfied! Finish what you have started, imbecile!
			string_id message = new string_id (c_stringFile, "s_898e32ed");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am sorry, it won't happen again.
	if (response == "s_abddb145")
	{
		doAnimationAction (player, "slump_head");

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: See that it doesn't! The Empire only has room for the best. Get back to work.
			string_id message = new string_id (c_stringFile, "s_9da5d80d");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch13 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] You failed mission 2, do it over.
	//-- NPC: You are resting on your laurels, %TU. Do not be so overconfident. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What do you mean?
	if (response == "s_77e48d5b")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Have you completed your mission?
			string_id message = new string_id (c_stringFile, "s_b3c5ff5e");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: No...
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_49237f95");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 14);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I know I have not completed my mission.
	if (response == "s_b3d150e3")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "rub_chin_thoughtful");

			//-- NPC: Ah yes. I know this too. What should we do about this?
			string_id message = new string_id (c_stringFile, "s_eb570c2b");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I should...finish my mission?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_60db9426");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Have you completed your mission?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No...
	if (response == "s_49237f95")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: I would have no problem replacing you with another pilot. And replaced pilots are dead pilots. Am I making myself clear?
			string_id message = new string_id (c_stringFile, "s_83cb9cbb");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Crystal.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_87d4bfc2");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I would have no problem replacing you with another pilot. And replaced pilots are dead pilots. Am I making myself clear?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Crystal.
	if (response == "s_87d4bfc2")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: I suggest you get back to work.
			string_id message = new string_id (c_stringFile, "s_a9fb7454");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Ah yes. I know this too. What should we do about this?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I should...finish my mission?
	if (response == "s_60db9426")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "clap_rousing");

			//-- NPC: Excellent idea! Let's do that. 
			string_id message = new string_id (c_stringFile, "s_661f1464");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch19 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE]  You failed mission 3, do it over.
	//-- NPC: You are drawing the attention of the Inquisition. They are wondering how a pilot like yourself could possibly be an Imperial.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will complete my mission! I swear it!
	if (response == "s_c1ce722e")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Pretty words. I would rather see ugly action, if you know what I mean.
			string_id message = new string_id (c_stringFile, "s_7a3b60ae");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I do.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_6ebb13d3");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 20);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will do my job.
	if (response == "s_e26ff616")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: See that you do. Because, you see, it is also drawing attention to myself. And I do not want that. So do good - for me. 
			string_id message = new string_id (c_stringFile, "s_ee7cbdbe");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Pretty words. I would rather see ugly action, if you know what I mean.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I do.
	if (response == "s_6ebb13d3")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Then show me  that you are a person of your word.
			string_id message = new string_id (c_stringFile, "s_8bcb23a1");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch23 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] You failed mission 4, do it over.
	//-- NPC: Do you REALIZE what will happen if you fail this mission?!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes!
	if (response == "s_ef420789")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: I hope so - for your sake. Return to your duties immediately.
			string_id message = new string_id (c_stringFile, "s_ee15b61");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No.
	if (response == "s_4c695dbd")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: I will kill you myself. Is that enough motivation for you? Return to your duties!
			string_id message = new string_id (c_stringFile, "s_175d585");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch26 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] You have completed mission one and so here is your reward.
	//-- NPC: The Rebels continue to bother us. They are incessant! But you have done well, %TU. You have earned your duty pay.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Thank you.
	if (response == "s_b9b27823")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Life is short - especially for an Imperial pilot. I would enjoy that money if I were you.
			string_id message = new string_id (c_stringFile, "s_b1d99272");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes. I have.
	if (response == "s_71197541")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: There's more where that came from.
			string_id message = new string_id (c_stringFile, "s_cae57de6");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch29 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] You have completed mission two and so here is your reward.
	//-- NPC: Very good, %TU. I have your duty pay.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: The Empire pays well.
	if (response == "s_c90d9b02")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Emperor appreciates your loyalty.
			string_id message = new string_id (c_stringFile, "s_f5ef44e1");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Excellent!
	if (response == "s_a46cdee9")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Don't spend it all in one place.
			string_id message = new string_id (c_stringFile, "s_d7be8f57");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch32 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] You have completed mission three and so here is your reward.
	//-- NPC: Ah. %TU. Hello. I wish to give you your duty pay.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I will accept it.
	if (response == "s_134dd45")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Ha! How very kind of you.
			string_id message = new string_id (c_stringFile, "s_1e4c7d44");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Excellent!
	if (response == "s_56")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: You have earned it.
			string_id message = new string_id (c_stringFile, "s_a5182b84");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch35 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] You have completed mission four and so here is your reward.
	//-- NPC: And so, of course, I will pay you now.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Of course! I did my duty.
	if (response == "s_b474959c")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: You did. And the Emperor thanks you.
			string_id message = new string_id (c_stringFile, "s_1e20c3ab");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I can use the money.
	if (response == "s_5085bdab")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: It's always useful.
			string_id message = new string_id (c_stringFile, "s_2c46518");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch38 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Welcome back, %TU. Your next assignment is waiting. Are you ready?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Of course.
	if (response == "s_52917b0d")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition_hasCompletedMissionThree (player, npc))
		{
			//-- NPC: We continue to pursue these stolen shuttles.
			string_id message = new string_id (c_stringFile, "s_fee3d28f");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Incredible! How can this be? We've been pursuing them at full speed!
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: We'll get them.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_227");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_243");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 45);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition_hasCompletedMissionTwo (player, npc))
		{
			//-- NPC: The Emperor continues to take an interest in this system. He is sending an Inquisitor here.
			string_id message = new string_id (c_stringFile, "s_66bd8046");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: An Inquisitor?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: For what reason?
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_261");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_285");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 54);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition_hasCompletedMissionOne (player, npc))
		{
			//-- NPC: You have earned some of my trust, %NU. Not all, but some. 
			string_id message = new string_id (c_stringFile, "s_4aef73fb");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm flattered.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't tell secrets.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_295");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_319");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 63);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very good! Now you will serve me! I have a mission for you.
			string_id message = new string_id (c_stringFile, "s_f10afb8");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very good.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I am here to serve the Empire.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_337");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_349");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 74);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch39 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We continue to pursue these stolen shuttles.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Incredible! How can this be? We've been pursuing them at full speed!
	if (response == "s_227")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: I am amazed myself. As is the Inquisitor. He is eager to speak to one of these Bothan spies. They've done an amazing job.
			string_id message = new string_id (c_stringFile, "s_229");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'd like to do more than talk.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_231");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 46);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: We'll get them.
	if (response == "s_243")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: We have gathered information from that Rebel shuttle.
			string_id message = new string_id (c_stringFile, "s_245");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Do you know how the Bothans managed to pull this off?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_247");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 50);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch40 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The Emperor continues to take an interest in this system. He is sending an Inquisitor here.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: An Inquisitor?
	if (response == "s_261")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Emperor's most potent weapon - besides myself,  that is. Your fears are well founded.
			string_id message = new string_id (c_stringFile, "s_263");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I have nothing to fear from them, right?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_265");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 55);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: For what reason?
	if (response == "s_285")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: I am sure the Inquisition is interested in Bothan spy activity. This particular - person - is very important to me, which means he is very important to you as well.
			string_id message = new string_id (c_stringFile, "s_287");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Of course.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_289");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 61);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch41 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You have earned some of my trust, %NU. Not all, but some. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm flattered.
	if (response == "s_295")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Don't be. I'm only giving you the information you need to serve the Empire.
			string_id message = new string_id (c_stringFile, "s_297");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I don't know what to say.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_299");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 64);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't tell secrets.
	if (response == "s_319")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: No. Of course not. I am not concerned. You know and I know that if you betrayed the Empire, you would be dead before nightfall.
			string_id message = new string_id (c_stringFile, "s_321");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I would expect nothing less.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_323");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 70);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch42 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Very good! Now you will serve me! I have a mission for you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Very good.
	if (response == "s_337")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Something is knocking our system satellites offline.
			string_id message = new string_id (c_stringFile, "s_339");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Any idea what it could be?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_341");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 75);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am here to serve the Empire.
	if (response == "s_349")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_to_self");

			//-- NPC: And I speak for the Emperor! The Endor system is back under our control. This is as it should be.
			string_id message = new string_id (c_stringFile, "s_351");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: We destroyed the Rebel command ship, but they may still have the stolen information.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_353");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 78);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch43 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] You're ready for a new skill, which would you like?
	//-- NPC: It is essential that all pilots continue their training.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: In what am I to be trained?
	if (response == "s_212")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition_hasStarshipSkill (player, npc))
		{
			//-- NPC: It looks like you are scheduled to learn about experimental TIE vessels.
			string_id message = new string_id (c_stringFile, "s_213");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am ready.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_217");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 44);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition_hasWeaponSkill (player, npc))
		{
			//-- NPC: It looks like you are scheduled to learn about heavy starship component use.
			string_id message = new string_id (c_stringFile, "s_214");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am ready.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_219");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 84);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition_hasProceduresSkill (player, npc))
		{
			//-- NPC: It looks like you are scheduled to learn about TIE guard training.
			string_id message = new string_id (c_stringFile, "s_215");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am ready.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_221");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 85);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: It looks like you are scheduled to learn about droid intelligence theory.
			string_id message = new string_id (c_stringFile, "s_216");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am ready.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_223");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 86);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch44 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It looks like you are scheduled to learn about experimental TIE vessels.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am ready.
	if (response == "s_217")
	{
		tatooine_imperial_tier4_action_grantStarshipSkill (player, npc);

		//-- [NOTE] Now go do Mission Four
		if (tatooine_imperial_tier4_condition_hasCompletedMissionThree (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: We continue to pursue these stolen shuttles.
			string_id message = new string_id (c_stringFile, "s_225");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Incredible! How can this be? We've been pursuing them at full speed!
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: We'll get them.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_227");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_243");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 45);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission Three.
		if (tatooine_imperial_tier4_condition_hasCompletedMissionTwo (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: The Emperor continues to take an interest in this system. He is sending an Inquisitor here.
			string_id message = new string_id (c_stringFile, "s_259");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: An Inquisitor?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: For what reason?
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_261");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_285");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 54);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission Two.
		if (tatooine_imperial_tier4_condition_hasCompletedMissionOne (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: You have earned some of my trust, %NU. Not all, but some. 
			string_id message = new string_id (c_stringFile, "s_293");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm flattered.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't tell secrets.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_295");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_319");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 63);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission One.
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: Very good! Now you will serve me! I have a mission for you.
			string_id message = new string_id (c_stringFile, "s_335");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very good.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I am here to serve the Empire.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_337");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_349");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 74);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch45 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Now go do Mission Four
	//-- NPC: We continue to pursue these stolen shuttles.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Incredible! How can this be? We've been pursuing them at full speed!
	if (response == "s_227")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: I am amazed myself. As is the Inquisitor. He is eager to speak to one of these Bothan spies. They've done an amazing job.
			string_id message = new string_id (c_stringFile, "s_229");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'd like to do more than talk.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_231");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 46);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: We'll get them.
	if (response == "s_243")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: We have gathered information from that Rebel shuttle.
			string_id message = new string_id (c_stringFile, "s_245");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Do you know how the Bothans managed to pull this off?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_247");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 50);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch46 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I am amazed myself. As is the Inquisitor. He is eager to speak to one of these Bothan spies. They've done an amazing job.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'd like to do more than talk.
	if (response == "s_231")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "wave_finger_warning");

			//-- NPC: You must control your temper. If you find these Bothans, you must deliver them to the Inquisitor unharmed. They will know what to do, believe me.
			string_id message = new string_id (c_stringFile, "s_233");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Do you have any more information on the shuttles?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_235");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 47);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch47 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You must control your temper. If you find these Bothans, you must deliver them to the Inquisitor unharmed. They will know what to do, believe me.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Do you have any more information on the shuttles?
	if (response == "s_235")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: The Bothans took the ships to the Dantooine system. They will be transferred to the Rebellion shortly. But that must not happen.
			string_id message = new string_id (c_stringFile, "s_237");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Understood.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_239");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 48);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch48 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The Bothans took the ships to the Dantooine system. They will be transferred to the Rebellion shortly. But that must not happen.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Understood.
	if (response == "s_239")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "pound_fist_palm");

			tatooine_imperial_tier4_action_grantMissionFour (player, npc);

			//-- NPC: Destroy those shuttles!
			string_id message = new string_id (c_stringFile, "s_241");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch50 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We have gathered information from that Rebel shuttle.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Do you know how the Bothans managed to pull this off?
	if (response == "s_247")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "pound_fist_palm");

			//-- NPC: Not yet. But we DO know that the stolen shuttles were taken to the Dantooine system - and will  be transferred to the Rebel Alliance shortly.
			string_id message = new string_id (c_stringFile, "s_249");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: That must not happen!
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_251");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 51);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch51 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Not yet. But we DO know that the stolen shuttles were taken to the Dantooine system - and will  be transferred to the Rebel Alliance shortly.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: That must not happen!
	if (response == "s_251")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: My thoughts exactly. You must make your way to Dantooine and destroy those stolen shuttles.
			string_id message = new string_id (c_stringFile, "s_253");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: It's as good as done.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_255");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 52);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch52 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: My thoughts exactly. You must make your way to Dantooine and destroy those stolen shuttles.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: It's as good as done.
	if (response == "s_255")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantMissionFour (player, npc);

			//-- NPC: I hope so. Dismissed.
			string_id message = new string_id (c_stringFile, "s_257");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch54 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Now go do Mission Three.
	//-- NPC: The Emperor continues to take an interest in this system. He is sending an Inquisitor here.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: An Inquisitor?
	if (response == "s_261")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Emperor's most potent weapon - besides myself,  that is. Your fears are well founded.
			string_id message = new string_id (c_stringFile, "s_263");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I have nothing to fear from them, right?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_265");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 55);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: For what reason?
	if (response == "s_285")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: I am sure the Inquisition is interested in Bothan spy activity. This particular - person - is very important to me, which means he is very important to you as well.
			string_id message = new string_id (c_stringFile, "s_287");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Of course.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_289");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 61);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch55 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The Emperor's most potent weapon - besides myself,  that is. Your fears are well founded.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I have nothing to fear from them, right?
	if (response == "s_265")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "whisper");

			//-- NPC: Why? Have you been naughty?
			string_id message = new string_id (c_stringFile, "s_267");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: No!
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_269");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 56);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch56 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Why? Have you been naughty?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No!
	if (response == "s_269")
	{
		doAnimationAction (player, "nervous");

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well then. There's your answer.
			string_id message = new string_id (c_stringFile, "s_271");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I wish only to serve.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_273");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 57);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch57 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well then. There's your answer.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I wish only to serve.
	if (response == "s_273")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Then continue your search for those shuttles.
			string_id message = new string_id (c_stringFile, "s_275");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I thought I had all of them!
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_277");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 58);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch58 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Then continue your search for those shuttles.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I thought I had all of them!
	if (response == "s_277")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: No. You did not. Several shuttles managed to escape our sensors. 
			string_id message = new string_id (c_stringFile, "s_279");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: The Bothan spies are good pilots after all.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_281");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 59);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch59 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: No. You did not. Several shuttles managed to escape our sensors. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: The Bothan spies are good pilots after all.
	if (response == "s_281")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "dismiss");

			tatooine_imperial_tier4_action_grantMissionThree (player, npc);

			//-- NPC: The Inquisition means to get to the bottom of this. You are to escort their ship to this location. Dismissed.
			string_id message = new string_id (c_stringFile, "s_283");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch61 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I am sure the Inquisition is interested in Bothan spy activity. This particular - person - is very important to me, which means he is very important to you as well.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Of course.
	if (response == "s_289")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "wave_on_dismissing");

			tatooine_imperial_tier4_action_grantMissionThree (player, npc);

			//-- NPC: You will personally escort the Inquisitor's ship to this position. You are to leave at once.
			string_id message = new string_id (c_stringFile, "s_291");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch63 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Now go do Mission Two.
	//-- NPC: You have earned some of my trust, %NU. Not all, but some. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm flattered.
	if (response == "s_295")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Don't be. I'm only giving you the information you need to serve the Empire.
			string_id message = new string_id (c_stringFile, "s_297");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I don't know what to say.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_299");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 64);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't tell secrets.
	if (response == "s_319")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: No. Of course not. I am not concerned. You know and I know that if you betrayed the Empire, you would be dead before nightfall.
			string_id message = new string_id (c_stringFile, "s_321");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I would expect nothing less.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_323");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 70);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch64 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Don't be. I'm only giving you the information you need to serve the Empire.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't know what to say.
	if (response == "s_299")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Then shut your mouth and listen! We have learned that Bothan spies are operating in this system.
			string_id message = new string_id (c_stringFile, "s_301");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Bothan? They usually work with the Rebels.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_303");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 65);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch65 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Then shut your mouth and listen! We have learned that Bothan spies are operating in this system.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Bothan? They usually work with the Rebels.
	if (response == "s_303")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Of that you can be sure.
			string_id message = new string_id (c_stringFile, "s_305");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: How do you know they're here? Bothan spies are usually invisible.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_307");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 66);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch66 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Of that you can be sure.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How do you know they're here? Bothan spies are usually invisible.
	if (response == "s_307")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Not this time. They have captured several of our command shuttles.
			string_id message = new string_id (c_stringFile, "s_309");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What are they doing with them?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_311");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 67);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch67 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Not this time. They have captured several of our command shuttles.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What are they doing with them?
	if (response == "s_311")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: They are attempting to leave this system. But they will not - because you will stop them. 
			string_id message = new string_id (c_stringFile, "s_313");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Can I fire on the ships?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_315");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 68);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch68 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: They are attempting to leave this system. But they will not - because you will stop them. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Can I fire on the ships?
	if (response == "s_315")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantMissionTwo (player, npc);

			//-- NPC: Use extreme prejudice. We'd rather see those ships destroyed than fall into Rebel hands. 
			string_id message = new string_id (c_stringFile, "s_317");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch70 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: No. Of course not. I am not concerned. You know and I know that if you betrayed the Empire, you would be dead before nightfall.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I would expect nothing less.
	if (response == "s_323")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: Bothan spies are operating in this system. They have gone so far as to capture several of our command shuttles.
			string_id message = new string_id (c_stringFile, "s_325");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Incredible! Bothans are rarely so bold.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_327");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 71);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch71 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Bothan spies are operating in this system. They have gone so far as to capture several of our command shuttles.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Incredible! Bothans are rarely so bold.
	if (response == "s_327")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: It is curious, isn't it? But no matter. They won't get far. Bothan spies have no chance against an Imperial pilot such as yourself.
			string_id message = new string_id (c_stringFile, "s_329");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yes sir.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_331");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 72);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch72 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It is curious, isn't it? But no matter. They won't get far. Bothan spies have no chance against an Imperial pilot such as yourself.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes sir.
	if (response == "s_331")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantMissionTwo (player, npc);

			//-- NPC: They are attempting to leave this system. You will stop them. Fire at will.
			string_id message = new string_id (c_stringFile, "s_333");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch74 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] Now go do Mission One.
	//-- NPC: Very good! Now you will serve me! I have a mission for you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Very good.
	if (response == "s_337")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Something is knocking our system satellites offline.
			string_id message = new string_id (c_stringFile, "s_339");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Any idea what it could be?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_341");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 75);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am here to serve the Empire.
	if (response == "s_349")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_to_self");

			//-- NPC: And I speak for the Emperor! The Endor system is back under our control. This is as it should be.
			string_id message = new string_id (c_stringFile, "s_351");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: We destroyed the Rebel command ship, but they may still have the stolen information.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_353");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 78);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch75 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Something is knocking our system satellites offline.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Any idea what it could be?
	if (response == "s_341")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: That is not my concern. It is yours. You will fix the problem. I want you to inspect each satellite personally.
			string_id message = new string_id (c_stringFile, "s_343");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: There must be...How many satellites are there in this system?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_345");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 76);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch76 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That is not my concern. It is yours. You will fix the problem. I want you to inspect each satellite personally.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: There must be...How many satellites are there in this system?
	if (response == "s_345")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "salute1");

			tatooine_imperial_tier4_action_grantMissionOne (player, npc);

			//-- NPC: Enough to keep you busy, I think. You are to leave immediately.
			string_id message = new string_id (c_stringFile, "s_347");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch78 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: And I speak for the Emperor! The Endor system is back under our control. This is as it should be.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: We destroyed the Rebel command ship, but they may still have the stolen information.
	if (response == "s_353")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "wave_on_dismissing");

			//-- NPC: I am not concerned. We took action in time. The Empire may shoot too far or too wide at times - but at least we shoot!
			string_id message = new string_id (c_stringFile, "s_355");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: And that's why we will win.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_357");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 79);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch79 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I am not concerned. We took action in time. The Empire may shoot too far or too wide at times - but at least we shoot!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: And that's why we will win.
	if (response == "s_357")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Exactly. Now listen! Satellites in this system are going offline. There is no reason this should be happening.
			string_id message = new string_id (c_stringFile, "s_359");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Space debris?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_361");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 80);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch80 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Exactly. Now listen! Satellites in this system are going offline. There is no reason this should be happening.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Space debris?
	if (response == "s_361")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: Of course not. Our engineers plan for that kind of logical event. It's something else.
			string_id message = new string_id (c_stringFile, "s_363");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Sabotage?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_365");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 81);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch81 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Of course not. Our engineers plan for that kind of logical event. It's something else.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Sabotage?
	if (response == "s_365")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Unlikely. But whatever it is, it will be corrected. By you. I want you to investigate each satellite personally. 
			string_id message = new string_id (c_stringFile, "s_367");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'll report my findings back to you.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_369");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 82);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch82 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Unlikely. But whatever it is, it will be corrected. By you. I want you to investigate each satellite personally. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'll report my findings back to you.
	if (response == "s_369")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "salute1");

			doAnimationAction (player, "salute1");

			tatooine_imperial_tier4_action_grantMissionOne (player, npc);

			//-- NPC: Dismissed.
			string_id message = new string_id (c_stringFile, "s_371");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch84 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It looks like you are scheduled to learn about heavy starship component use.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am ready.
	if (response == "s_219")
	{
		tatooine_imperial_tier4_action_grantWeaponSkill (player, npc);

		//-- [NOTE] Now go do Mission Four
		if (tatooine_imperial_tier4_condition_hasCompletedMissionThree (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: We continue to pursue these stolen shuttles.
			string_id message = new string_id (c_stringFile, "s_225");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Incredible! How can this be? We've been pursuing them at full speed!
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: We'll get them.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_227");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_243");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 45);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission Three.
		if (tatooine_imperial_tier4_condition_hasCompletedMissionTwo (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: The Emperor continues to take an interest in this system. He is sending an Inquisitor here.
			string_id message = new string_id (c_stringFile, "s_259");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: An Inquisitor?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: For what reason?
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_261");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_285");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 54);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission Two.
		if (tatooine_imperial_tier4_condition_hasCompletedMissionOne (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: You have earned some of my trust, %NU. Not all, but some. 
			string_id message = new string_id (c_stringFile, "s_293");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm flattered.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't tell secrets.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_295");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_319");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 63);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission One.
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: Very good! Now you will serve me! I have a mission for you.
			string_id message = new string_id (c_stringFile, "s_335");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very good.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I am here to serve the Empire.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_337");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_349");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 74);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch85 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It looks like you are scheduled to learn about TIE guard training.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am ready.
	if (response == "s_221")
	{
		tatooine_imperial_tier4_action_grantProcedureSkill (player, npc);

		//-- [NOTE] Now go do Mission Four
		if (tatooine_imperial_tier4_condition_hasCompletedMissionThree (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: We continue to pursue these stolen shuttles.
			string_id message = new string_id (c_stringFile, "s_225");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Incredible! How can this be? We've been pursuing them at full speed!
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: We'll get them.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_227");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_243");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 45);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission Three.
		if (tatooine_imperial_tier4_condition_hasCompletedMissionTwo (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: The Emperor continues to take an interest in this system. He is sending an Inquisitor here.
			string_id message = new string_id (c_stringFile, "s_259");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: An Inquisitor?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: For what reason?
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_261");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_285");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 54);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission Two.
		if (tatooine_imperial_tier4_condition_hasCompletedMissionOne (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: You have earned some of my trust, %NU. Not all, but some. 
			string_id message = new string_id (c_stringFile, "s_293");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm flattered.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't tell secrets.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_295");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_319");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 63);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission One.
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: Very good! Now you will serve me! I have a mission for you.
			string_id message = new string_id (c_stringFile, "s_335");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very good.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I am here to serve the Empire.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_337");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_349");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 74);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch86 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It looks like you are scheduled to learn about droid intelligence theory.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am ready.
	if (response == "s_223")
	{
		tatooine_imperial_tier4_action_grantDroidSkill (player, npc);

		//-- [NOTE] Now go do Mission Four
		if (tatooine_imperial_tier4_condition_hasCompletedMissionThree (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: We continue to pursue these stolen shuttles.
			string_id message = new string_id (c_stringFile, "s_225");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Incredible! How can this be? We've been pursuing them at full speed!
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: We'll get them.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_227");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_243");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 45);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission Three.
		if (tatooine_imperial_tier4_condition_hasCompletedMissionTwo (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: The Emperor continues to take an interest in this system. He is sending an Inquisitor here.
			string_id message = new string_id (c_stringFile, "s_259");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: An Inquisitor?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: For what reason?
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_261");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_285");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 54);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission Two.
		if (tatooine_imperial_tier4_condition_hasCompletedMissionOne (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: You have earned some of my trust, %NU. Not all, but some. 
			string_id message = new string_id (c_stringFile, "s_293");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm flattered.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't tell secrets.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_295");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_319");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 63);

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcSpeak (player, pp);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				prose_package pp = new prose_package ();
				pp.stringId = message;
				pp.actor.set (player);
				pp.target.set (npc);

				npcEndConversationWithMessage (player, pp);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] Now go do Mission One.
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_setReadyForMission (player, npc);

			//-- NPC: Very good! Now you will serve me! I have a mission for you.
			string_id message = new string_id (c_stringFile, "s_335");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very good.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I am here to serve the Empire.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_337");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_349");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 74);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch87 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Oh yes. I was told to expect you. I imagine you fancy yourself quite the pilot. Well I'll make my own judgments once you prove yourself. Now, how about you get to work?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Of course.
	if (response == "s_178")
	{
		tatooine_imperial_tier4_action_setMetMe (player, npc);

		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well. The sitrep is as follows. A pirate clan has foolishly chosen to set up operations in this system. They must be dealt with. 
			string_id message = new string_id (c_stringFile, "s_3e6a4237");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I see.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_61657d0f");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 93);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch88 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] You have not completed tier-4, so do one of these duty missions until you xp your way to a new skill.
	//-- NPC: Always plenty of work for a pilot like you. Are you ready to accept an assignment? Or would you like to hear the briefing again?

	//-- [RESPONSE NOTE] Destroy Duty
	//-- PLAYER: I'd like to take out that pirate clan.
	if (response == "s_cec1f447")
	{
		//-- [NOTE] Get to work
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionOne (player, npc);

			//-- NPC: Excellent. Sometimes I think half the galaxy has taken an interest in this godforsaken little corner. You're free to leave anytime.
			string_id message = new string_id (c_stringFile, "s_f6f97563");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] Escort Duty
	//-- PLAYER: I'll be happy to transport those freighters.
	if (response == "s_7b2d0234")
	{
		//-- [NOTE] Get to work
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionTwo (player, npc);

			//-- NPC: Do so! You're clear to leave.
			string_id message = new string_id (c_stringFile, "s_f4d0ec53");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Somebody's got to recover those freighters.
	if (response == "s_d115dd42")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionThree (player, npc);

			//-- NPC: Looks like that somebody is you, %TU.
			string_id message = new string_id (c_stringFile, "s_31428bf1");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] Rescue Duty
	//-- PLAYER: I can help those damaged freighters.
	if (response == "s_5208f382")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionFour (player, npc);

			//-- NPC: That's very good of you. My men will upload coordinates to your ship.
			string_id message = new string_id (c_stringFile, "s_86c72612");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Can I hear the briefing again?
	if (response == "s_49805f81")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well. The sitrep is as follows. A pirate clan has foolishly chosen to set up operations in this system. They must be dealt with. 
			string_id message = new string_id (c_stringFile, "s_3e6a4237");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I see.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_61657d0f");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 93);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch93 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Very well. The sitrep is as follows. A pirate clan has foolishly chosen to set up operations in this system. They must be dealt with. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I see.
	if (response == "s_61657d0f")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: More supply freighters are arriving every day. They must be transported to headquarters.
			string_id message = new string_id (c_stringFile, "s_77788129");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Mm.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_eef2363b");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 94);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch94 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: More supply freighters are arriving every day. They must be transported to headquarters.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Mm.
	if (response == "s_eef2363b")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: We are also receiving reports that several freighters were attacked by pirate vessels. We need an experienced pilot to retrieve those freighters.
			string_id message = new string_id (c_stringFile, "s_a0bfbb");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yes...
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_7b7590d4");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 95);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch95 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We are also receiving reports that several freighters were attacked by pirate vessels. We need an experienced pilot to retrieve those freighters.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes...
	if (response == "s_7b7590d4")
	{
		//-- [NOTE] don't know how to link it up 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Freighters are also a popular target for Rebel forces. Several have taken damage, and they must be rescued. And that is the situation. Tell me, which one interests you?
			string_id message = new string_id (c_stringFile, "s_2d7a9ef4");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'd like to take out that pirate clan.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I'll be happy to transport those freighters.
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			//-- PLAYER: Somebody's got to recover those freighters.
			boolean hasResponse2 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse2 = true;
			}

			//-- PLAYER: I can help those damaged freighters.
			boolean hasResponse3 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse3 = true;
			}

			//-- PLAYER: Can I hear the briefing again?
			boolean hasResponse4 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse4 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_cec1f447");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_7b2d0234");

				if (hasResponse2)
					responses [responseIndex++] = new string_id (c_stringFile, "s_d115dd42");

				if (hasResponse3)
					responses [responseIndex++] = new string_id (c_stringFile, "s_5208f382");

				if (hasResponse4)
					responses [responseIndex++] = new string_id (c_stringFile, "s_49805f81");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 88);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch96 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] don't know how to link it up 
	//-- NPC: Freighters are also a popular target for Rebel forces. Several have taken damage, and they must be rescued. And that is the situation. Tell me, which one interests you?

	//-- [RESPONSE NOTE] Destroy Duty
	//-- PLAYER: I'd like to take out that pirate clan.
	if (response == "s_cec1f447")
	{
		//-- [NOTE] Get to work
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionOne (player, npc);

			//-- NPC: Excellent. Sometimes I think half the galaxy has taken an interest in this godforsaken little corner. You're free to leave anytime.
			string_id message = new string_id (c_stringFile, "s_f6f97563");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] Escort Duty
	//-- PLAYER: I'll be happy to transport those freighters.
	if (response == "s_7b2d0234")
	{
		//-- [NOTE] Get to work
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionTwo (player, npc);

			//-- NPC: Do so! You're clear to leave.
			string_id message = new string_id (c_stringFile, "s_f4d0ec53");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Somebody's got to recover those freighters.
	if (response == "s_d115dd42")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionThree (player, npc);

			//-- NPC: Looks like that somebody is you, %TU.
			string_id message = new string_id (c_stringFile, "s_31428bf1");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] Rescue Duty
	//-- PLAYER: I can help those damaged freighters.
	if (response == "s_5208f382")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionFour (player, npc);

			//-- NPC: That's very good of you. My men will upload coordinates to your ship.
			string_id message = new string_id (c_stringFile, "s_86c72612");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Can I hear the briefing again?
	if (response == "s_49805f81")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well. The sitrep is as follows. A pirate clan has foolishly chosen to set up operations in this system. They must be dealt with. 
			string_id message = new string_id (c_stringFile, "s_3e6a4237");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I see.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_61657d0f");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 93);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch97 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I just received the orders, you are shipping out. Grand Admiral Nial Declann has ordered that you attend him immediately. The orders come from the Palace at Theed so that is where I expect he wants you to go.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What would a Grand Admiral want with me?
	if (response == "s_333f441a")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: The orders don't say and I don't make a point of sticking my nose in their business. The order simply say that you are being transferred under his command and that you are to report to him immediately. I suggest that you be on your best behavior for this one.
			string_id message = new string_id (c_stringFile, "s_45c5c358");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Why, what sort of man is he?
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_df3eeb29");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 98);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Who is Grand Admiral Nial Declann?
	if (response == "s_7177c3f2")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Grand Admiral Nial Declann is one of the twelve men in charge of the Imperial Navy. From what I have heard he has the Emperor's ear and is definitely not a man to be trifled with. I would suggest that you be on your best behavior because that man will not tolerate any impertinence.
			string_id message = new string_id (c_stringFile, "s_dc219a69");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yes, sir. I will be on my best behavior.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: So I shouldn't call him Nial?
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_bf2260fb");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_613f70ae");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 102);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch98 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The orders don't say and I don't make a point of sticking my nose in their business. The order simply say that you are being transferred under his command and that you are to report to him immediately. I suggest that you be on your best behavior for this one.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why, what sort of man is he?
	if (response == "s_df3eeb29")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: How would I know? I have never had the honor of meeting a Grand Admiral. But your behavior reflects on me. If you screw up  he will probably just have you executed. I on the other hand will probably be put on garbage detail for the rest of my life. So show this Grand Admiral what being a member of Storm Squadron is all about.
			string_id message = new string_id (c_stringFile, "s_a4f1dc7d");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yes, sir. I won't let the squadron down.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: You want me to be lazy and undisciplined?
			boolean hasResponse1 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_b8173a60");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_adcc0a23");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 99);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch99 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: How would I know? I have never had the honor of meeting a Grand Admiral. But your behavior reflects on me. If you screw up  he will probably just have you executed. I on the other hand will probably be put on garbage detail for the rest of my life. So show this Grand Admiral what being a member of Storm Squadron is all about.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, sir. I won't let the squadron down.
	if (response == "s_b8173a60")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good. Now don't keep the Admiral waiting. Get to Theed Palace on the double and report in.
			string_id message = new string_id (c_stringFile, "s_b78b6139");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You want me to be lazy and undisciplined?
	if (response == "s_adcc0a23")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Pilot, if you screw this up, the Grand Admiral won't have a chance to execute you because I will do it myself. And I won't make it all pleasant like he would. You will suffer long, you will suffer hard, and you will live to regret ever messing with my squadron. Now get out of my sight before I have to inform the Grand Admiral that you had a little accident involving my foot.
			string_id message = new string_id (c_stringFile, "s_d669284c");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch102 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Grand Admiral Nial Declann is one of the twelve men in charge of the Imperial Navy. From what I have heard he has the Emperor's ear and is definitely not a man to be trifled with. I would suggest that you be on your best behavior because that man will not tolerate any impertinence.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, sir. I will be on my best behavior.
	if (response == "s_bf2260fb")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good. Remember you reflect on me and the entire squadron. The Grand Admiral has the power to eliminate our entire group with a single order, so don't let us down. Now don't keep the Admiral waiting. Get to Theed Palace and report in right away.
			string_id message = new string_id (c_stringFile, "s_e015cb4");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: So I shouldn't call him Nial?
	if (response == "s_613f70ae")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: You will address him as Grand Admiral or sir! If you lip off to the Grand Admiral he is liable to have you shot on the spot and then he will probably turn his vengeance on me. You are a reflection of our entire squadron so you had better not screw this up. Now get to Theed Palace and report in.
			string_id message = new string_id (c_stringFile, "s_a5827814");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int tatooine_imperial_tier4_handleBranch105 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I understand that you served the Grand Admiral with distinction. You have done well by me and the squadron. Are you just here for more work?  Sure you are.

	//-- [RESPONSE NOTE] Destroy Duty
	//-- PLAYER: I'd like to take out that pirate clan.
	if (response == "s_cec1f447")
	{
		//-- [NOTE] Get to work
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionOne (player, npc);

			//-- NPC: Excellent. Sometimes I think half the galaxy has taken an interest in this godforsaken little corner. You're free to leave anytime.
			string_id message = new string_id (c_stringFile, "s_f6f97563");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] Escort Duty
	//-- PLAYER: I'll be happy to transport those freighters.
	if (response == "s_7b2d0234")
	{
		//-- [NOTE] Get to work
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionTwo (player, npc);

			//-- NPC: Do so! You're clear to leave.
			string_id message = new string_id (c_stringFile, "s_f4d0ec53");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Somebody's got to recover those freighters.
	if (response == "s_d115dd42")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionThree (player, npc);

			//-- NPC: Looks like that somebody is you, %TU.
			string_id message = new string_id (c_stringFile, "s_31428bf1");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcEndConversationWithMessage (player, pp);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] Rescue Duty
	//-- PLAYER: I can help those damaged freighters.
	if (response == "s_5208f382")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			tatooine_imperial_tier4_action_grantDutyMissionFour (player, npc);

			//-- NPC: That's very good of you. My men will upload coordinates to your ship.
			string_id message = new string_id (c_stringFile, "s_86c72612");
			utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Can I hear the briefing again?
	if (response == "s_49805f81")
	{
		//-- [NOTE] 
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			//-- NPC: Very well. The sitrep is as follows. A pirate clan has foolishly chosen to set up operations in this system. They must be dealt with. 
			string_id message = new string_id (c_stringFile, "s_3e6a4237");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I see.
			boolean hasResponse0 = false;
			if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_61657d0f");

				utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 93);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.tatooine_imperial_tier4");

	setCondition (self, CONDITION_CONVERSABLE);
	setCondition( self, CONDITION_SPACE_INTERESTING );
	setInvulnerable(self, true);
	factions.setFaction( self, factions.FACTION_IMPERIAL );

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setName( self, "Admiral Kilnstrider");
	setCondition( self, CONDITION_SPACE_INTERESTING );
	setInvulnerable(self, true);
	factions.setFaction( self, factions.FACTION_IMPERIAL );

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);

	faceTo( self, player );

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.tatooine_imperial_tier4");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (!tatooine_imperial_tier4_condition_isPilot (player, npc))
	{
		//-- NPC: You don't look like much of a pilot.
		string_id message = new string_id (c_stringFile, "s_d318f289");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You're the wrong faction.
	if (tatooine_imperial_tier4_condition_isWrongFaction (player, npc))
	{
		//-- NPC: Get out of my sight immediately!
		string_id message = new string_id (c_stringFile, "s_e16137e8");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (!tatooine_imperial_tier4_condition_onMyTrack (player, npc))
	{
		//-- NPC: What are you doing here pilot. You are not a part of this unit.
		string_id message = new string_id (c_stringFile, "s_50605b35");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I would like to request a mission.
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_4854758d");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 3);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_imperial_tier4_condition_hasNegativeFaction (player, npc))
	{
		doAnimationAction (npc, "point_accusingly");

		//-- NPC: What is your major malfunction, %TU!?  I just got a report that you're under investigation for treason!  Do you realize how this makes ME look?  I should shoot you myself.
		string_id message = new string_id (c_stringFile, "s_f2643fdd");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What?!
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_7090182");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 6);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You're not through tier-3 yet
	if (!tatooine_imperial_tier4_condition_hasCompletedTier3 (player, npc))
	{
		doAnimationAction (npc, "dismiss");

		//-- NPC: I believe your trainer is looking for you.
		string_id message = new string_id (c_stringFile, "s_d3b2272c");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You're busy.  Already doing a mission.  Hup hup, go do it.
	if (tatooine_imperial_tier4_condition_isOnMission (player, npc))
	{
		doAnimationAction (npc, "point_accusingly");

		//-- NPC: This war will be won by pilots who FIGHT, not by  pilots who like to drop by for visits! Begone!
		string_id message = new string_id (c_stringFile, "s_2a35d2fe");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You failed mission 1, do it over.
	if (tatooine_imperial_tier4_condition_faliedMissionOne (player, npc))
	{
		tatooine_imperial_tier4_action_grantMissionOne (player, npc);

		//-- NPC: You have not done your job!
		string_id message = new string_id (c_stringFile, "s_71e775f5");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I haven't?
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I am sorry, it won't happen again.
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_8f4d001d");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_abddb145");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 10);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You failed mission 2, do it over.
	if (tatooine_imperial_tier4_condition_failedMissionTwo (player, npc))
	{
		doAnimationAction (npc, "wave_finger_warning");

		tatooine_imperial_tier4_action_grantMissionTwo (player, npc);

		//-- NPC: You are resting on your laurels, %TU. Do not be so overconfident. 
		string_id message = new string_id (c_stringFile, "s_2eb3aa2");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What do you mean?
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I know I have not completed my mission.
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_77e48d5b");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_b3d150e3");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 13);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE]  You failed mission 3, do it over.
	if (tatooine_imperial_tier4_condition_failedMissionThree (player, npc))
	{
		tatooine_imperial_tier4_action_grantMissionThree (player, npc);

		//-- NPC: You are drawing the attention of the Inquisition. They are wondering how a pilot like yourself could possibly be an Imperial.
		string_id message = new string_id (c_stringFile, "s_e0e28bdb");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I will complete my mission! I swear it!
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I will do my job.
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_c1ce722e");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_e26ff616");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 19);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You failed mission 4, do it over.
	if (tatooine_imperial_tier4_condition_failedMissionFour (player, npc))
	{
		tatooine_imperial_tier4_action_grantMissionFour (player, npc);

		//-- NPC: Do you REALIZE what will happen if you fail this mission?!
		string_id message = new string_id (c_stringFile, "s_3e3689e0");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yes!
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: No.
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_ef420789");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_4c695dbd");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 23);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You have completed mission one and so here is your reward.
	if (tatooine_imperial_tier4_condition_isGettingMissionOneReward (player, npc))
	{
		tatooine_imperial_tier4_action_rewardForMissionOne (player, npc);

		//-- NPC: The Rebels continue to bother us. They are incessant! But you have done well, %TU. You have earned your duty pay.
		string_id message = new string_id (c_stringFile, "s_3ec8b347");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Thank you.
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Yes. I have.
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_b9b27823");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_71197541");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 26);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You have completed mission two and so here is your reward.
	if (tatooine_imperial_tier4_condition_isGettingMissionTwoReward (player, npc))
	{
		tatooine_imperial_tier4_action_rewardForMissionTwo (player, npc);

		//-- NPC: Very good, %TU. I have your duty pay.
		string_id message = new string_id (c_stringFile, "s_a4dd5d0d");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: The Empire pays well.
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Excellent!
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_c90d9b02");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_a46cdee9");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 29);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You have completed mission three and so here is your reward.
	if (tatooine_imperial_tier4_condition_isGettingMissionThreeReward (player, npc))
	{
		tatooine_imperial_tier4_action_rewardForMissionThree (player, npc);

		//-- NPC: Ah. %TU. Hello. I wish to give you your duty pay.
		string_id message = new string_id (c_stringFile, "s_9ff091bd");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I will accept it.
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Excellent!
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_134dd45");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_56");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 32);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You have completed mission four and so here is your reward.
	if (tatooine_imperial_tier4_condition_isGettingMissionFourReward (player, npc))
	{
		tatooine_imperial_tier4_action_rewardForMissionFour (player, npc);

		//-- NPC: And so, of course, I will pay you now.
		string_id message = new string_id (c_stringFile, "s_5066022c");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Of course! I did my duty.
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I can use the money.
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_b474959c");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_5085bdab");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 35);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_imperial_tier4_condition_isReadyForMission (player, npc))
	{
		//-- NPC: Welcome back, %TU. Your next assignment is waiting. Are you ready?
		string_id message = new string_id (c_stringFile, "s_53773f7e");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Of course.
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_52917b0d");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 38);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You're ready for a new skill, which would you like?
	if (tatooine_imperial_tier4_condition_isReadyForTraining (player, npc))
	{
		doAnimationAction (npc, "beckon");

		//-- NPC: It is essential that all pilots continue their training.
		string_id message = new string_id (c_stringFile, "s_d1e73984");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: In what am I to be trained?
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_212");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 43);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (!tatooine_imperial_tier4_condition_hasMetMe (player, npc))
	{
		//-- NPC: Oh yes. I was told to expect you. I imagine you fancy yourself quite the pilot. Well I'll make my own judgments once you prove yourself. Now, how about you get to work?
		string_id message = new string_id (c_stringFile, "s_7f465235");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Of course.
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_178");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 87);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] You have not completed tier-4, so do one of these duty missions until you xp your way to a new skill.
	if (!tatooine_imperial_tier4_condition_hasCompletedTier4 (player, npc))
	{
		//-- NPC: Always plenty of work for a pilot like you. Are you ready to accept an assignment? Or would you like to hear the briefing again?
		string_id message = new string_id (c_stringFile, "s_67f91789");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I'd like to take out that pirate clan.
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I'll be happy to transport those freighters.
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: Somebody's got to recover those freighters.
		boolean hasResponse2 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		//-- PLAYER: I can help those damaged freighters.
		boolean hasResponse3 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse3 = true;
		}

		//-- PLAYER: Can I hear the briefing again?
		boolean hasResponse4 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse4 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_cec1f447");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_7b2d0234");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_d115dd42");

			if (hasResponse3)
				responses [responseIndex++] = new string_id (c_stringFile, "s_5208f382");

			if (hasResponse4)
				responses [responseIndex++] = new string_id (c_stringFile, "s_49805f81");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 88);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (!tatooine_imperial_tier4_condition_hasMasterSkill (player, npc))
	{
		//-- NPC: I just received the orders, you are shipping out. Grand Admiral Nial Declann has ordered that you attend him immediately. The orders come from the Palace at Theed so that is where I expect he wants you to go.
		string_id message = new string_id (c_stringFile, "s_146bc0b9");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What would a Grand Admiral want with me?
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Who is Grand Admiral Nial Declann?
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_333f441a");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_7177c3f2");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 97);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
	{
		//-- NPC: I understand that you served the Grand Admiral with distinction. You have done well by me and the squadron. Are you just here for more work?  Sure you are.
		string_id message = new string_id (c_stringFile, "s_f5e3efbe");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I'd like to take out that pirate clan.
		boolean hasResponse0 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I'll be happy to transport those freighters.
		boolean hasResponse1 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: Somebody's got to recover those freighters.
		boolean hasResponse2 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		//-- PLAYER: I can help those damaged freighters.
		boolean hasResponse3 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse3 = true;
		}

		//-- PLAYER: Can I hear the briefing again?
		boolean hasResponse4 = false;
		if (tatooine_imperial_tier4_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse4 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_cec1f447");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_7b2d0234");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_d115dd42");

			if (hasResponse3)
				responses [responseIndex++] = new string_id (c_stringFile, "s_5208f382");

			if (hasResponse4)
				responses [responseIndex++] = new string_id (c_stringFile, "s_49805f81");

			utils.setScriptVar (player, "conversation.tatooine_imperial_tier4.branchId", 88);

			npcStartConversation (player, npc, "tatooine_imperial_tier4", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "tatooine_imperial_tier4")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

	if (branchId == 3 && tatooine_imperial_tier4_handleBranch3 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 4 && tatooine_imperial_tier4_handleBranch4 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 6 && tatooine_imperial_tier4_handleBranch6 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 10 && tatooine_imperial_tier4_handleBranch10 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 13 && tatooine_imperial_tier4_handleBranch13 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && tatooine_imperial_tier4_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && tatooine_imperial_tier4_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && tatooine_imperial_tier4_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 19 && tatooine_imperial_tier4_handleBranch19 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && tatooine_imperial_tier4_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 23 && tatooine_imperial_tier4_handleBranch23 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 26 && tatooine_imperial_tier4_handleBranch26 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 29 && tatooine_imperial_tier4_handleBranch29 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 32 && tatooine_imperial_tier4_handleBranch32 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 35 && tatooine_imperial_tier4_handleBranch35 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 38 && tatooine_imperial_tier4_handleBranch38 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 39 && tatooine_imperial_tier4_handleBranch39 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 40 && tatooine_imperial_tier4_handleBranch40 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 41 && tatooine_imperial_tier4_handleBranch41 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 42 && tatooine_imperial_tier4_handleBranch42 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 43 && tatooine_imperial_tier4_handleBranch43 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 44 && tatooine_imperial_tier4_handleBranch44 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 45 && tatooine_imperial_tier4_handleBranch45 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 46 && tatooine_imperial_tier4_handleBranch46 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 47 && tatooine_imperial_tier4_handleBranch47 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 48 && tatooine_imperial_tier4_handleBranch48 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 50 && tatooine_imperial_tier4_handleBranch50 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 51 && tatooine_imperial_tier4_handleBranch51 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 52 && tatooine_imperial_tier4_handleBranch52 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 54 && tatooine_imperial_tier4_handleBranch54 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 55 && tatooine_imperial_tier4_handleBranch55 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 56 && tatooine_imperial_tier4_handleBranch56 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 57 && tatooine_imperial_tier4_handleBranch57 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 58 && tatooine_imperial_tier4_handleBranch58 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 59 && tatooine_imperial_tier4_handleBranch59 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 61 && tatooine_imperial_tier4_handleBranch61 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 63 && tatooine_imperial_tier4_handleBranch63 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 64 && tatooine_imperial_tier4_handleBranch64 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 65 && tatooine_imperial_tier4_handleBranch65 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 66 && tatooine_imperial_tier4_handleBranch66 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 67 && tatooine_imperial_tier4_handleBranch67 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 68 && tatooine_imperial_tier4_handleBranch68 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 70 && tatooine_imperial_tier4_handleBranch70 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 71 && tatooine_imperial_tier4_handleBranch71 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 72 && tatooine_imperial_tier4_handleBranch72 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 74 && tatooine_imperial_tier4_handleBranch74 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 75 && tatooine_imperial_tier4_handleBranch75 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 76 && tatooine_imperial_tier4_handleBranch76 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 78 && tatooine_imperial_tier4_handleBranch78 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 79 && tatooine_imperial_tier4_handleBranch79 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 80 && tatooine_imperial_tier4_handleBranch80 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 81 && tatooine_imperial_tier4_handleBranch81 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 82 && tatooine_imperial_tier4_handleBranch82 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 84 && tatooine_imperial_tier4_handleBranch84 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 85 && tatooine_imperial_tier4_handleBranch85 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 86 && tatooine_imperial_tier4_handleBranch86 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 87 && tatooine_imperial_tier4_handleBranch87 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 88 && tatooine_imperial_tier4_handleBranch88 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 93 && tatooine_imperial_tier4_handleBranch93 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 94 && tatooine_imperial_tier4_handleBranch94 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 95 && tatooine_imperial_tier4_handleBranch95 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 96 && tatooine_imperial_tier4_handleBranch96 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 97 && tatooine_imperial_tier4_handleBranch97 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 98 && tatooine_imperial_tier4_handleBranch98 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 99 && tatooine_imperial_tier4_handleBranch99 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 102 && tatooine_imperial_tier4_handleBranch102 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 105 && tatooine_imperial_tier4_handleBranch105 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.tatooine_imperial_tier4.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

