// ======================================================================
//
// generic_newbie_pilot_info_emperors_retreat.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.36 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.features;
include library.skill;
include library.space_flags;
include library.space_quest;
include library.space_skill;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/generic_newbie_pilot_info_emperors_retreat";

// ======================================================================
// Script Conditions
// ======================================================================

boolean generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean generic_newbie_pilot_info_emperors_retreat_condition_remembersPlayer (obj_id player, obj_id npc)
{
	return ( utils.hasScriptVar( player, "metNewbiePilot" ));
}

// ----------------------------------------------------------------------

boolean generic_newbie_pilot_info_emperors_retreat_condition_hasWonAccessQuest (obj_id player, obj_id npc)
{
	if	((space_flags.isSpaceTrack(player, space_flags.IMPERIAL_NABOO) ||
		space_flags.isSpaceTrack(player, space_flags.PRIVATEER_NABOO)) &&
		space_quest.hasWonQuest(player, "destroy_surpriseattack", "naboo_station_emperors_access_quest_6" ))
		
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean generic_newbie_pilot_info_emperors_retreat_condition_hasSpaceAccess (obj_id player, obj_id npc)
{
	return hasObjVar (player, "space_access_imperial");
}

// ----------------------------------------------------------------------

boolean generic_newbie_pilot_info_emperors_retreat_condition_isImperialPilot (obj_id player, obj_id npc)
{
	return ( hasSkill( player, "pilot_imperial_navy_novice" ));
}

// ----------------------------------------------------------------------

boolean generic_newbie_pilot_info_emperors_retreat_condition_isRebelPilot (obj_id player, obj_id npc)
{
	return ( hasSkill( player, "pilot_rebel_navy_novice" ));
}

// ----------------------------------------------------------------------

boolean generic_newbie_pilot_info_emperors_retreat_condition_isPrivateerPilot (obj_id player, obj_id npc)
{
	return hasSkill( player, "pilot_neutral_novice" );
}

// ----------------------------------------------------------------------

boolean generic_newbie_pilot_info_emperors_retreat_condition_hasSpaceExpansion (obj_id player, obj_id npc)
{
	return ( features.isSpaceEdition( player ) );
}

// ----------------------------------------------------------------------

boolean generic_newbie_pilot_info_emperors_retreat_condition_hasSpaceShip (obj_id player, obj_id npc)
{
	return ( space_quest.hasShip( player ) );
}

// ======================================================================
// Script Actions
// ======================================================================

void generic_newbie_pilot_info_emperors_retreat_action_rememberPlayer (obj_id player, obj_id npc)
{
	utils.setScriptVar( player, "metNewbiePilot", true );
}

// ----------------------------------------------------------------------

void generic_newbie_pilot_info_emperors_retreat_action_grantAccess (obj_id player, obj_id npc)
{
	setObjVar (player, "space_access_imperial", 34);
	space_quest.giveReward( player, "space_battle", "naboo_station_emperors_access_quest_1", 10000 );
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int generic_newbie_pilot_info_emperors_retreat_handleBranch2 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Good to see you Sir! Word of your heroics in the Yavin system has spread like wildfire among the ranks.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Really? Me?
	if (response == "s_1ad77c93")
	{
		doAnimationAction (player, "embarrassed");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_multiple");

			//-- NPC: Of course Sir. You helped that freighter without hesitating, apparently shooting down, what was it, 20 of the Rebel scum?
			string_id message = new string_id (c_stringFile, "s_407efa57");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: 20?! I mean, I sure did!
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Oh it was more like 10.
			boolean hasResponse1 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_f184aba");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_c39cfcc5");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 3);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: As it should be!
	if (response == "s_7630ee0a")
	{
		doAnimationAction (player, "pound_fist_palm");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "salute2");

			//-- NPC: Y..yes of course Sir! Amazing performance, shooting down 20 of those Rebel scum in one mission.
			string_id message = new string_id (c_stringFile, "s_6f34494e");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: 20?! It was 40 at least!
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: It's what I do and no one does it better!
			boolean hasResponse1 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_d0d78fed");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_3cc53bb1");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 8);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: It has? Oh of course! A reward was mentioned?
	if (response == "s_9045a59e")
	{
		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			generic_newbie_pilot_info_emperors_retreat_action_grantAccess (player, npc);

			//-- NPC: Indeed Sir. Let me transfer that to your account. I'm also honored to inform you that you have been granted access to most of the Retreat Sir.
			string_id message = new string_id (c_stringFile, "s_9bcb9771");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ohh excellent, yes indeed. Well, I'm going inside then?
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_6403a01d");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch3 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Of course Sir. You helped that freighter without hesitating, apparently shooting down, what was it, 20 of the Rebel scum?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: 20?! I mean, I sure did!
	if (response == "s_f184aba")
	{
		doAnimationAction (player, "taken_aback");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			generic_newbie_pilot_info_emperors_retreat_action_grantAccess (player, npc);

			//-- NPC: Okay..well anyway, let me transfer your reward. I'm also honored to inform you that you have been granted access to most of the Retreat Sir.
			string_id message = new string_id (c_stringFile, "s_cbd17b72");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Really?! Whow! So I can go inside right now?
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_4ed6cafa");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 4);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Oh it was more like 10.
	if (response == "s_c39cfcc5")
	{
		doAnimationAction (player, "refuse_offer_affection");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			generic_newbie_pilot_info_emperors_retreat_action_grantAccess (player, npc);

			//-- NPC: I think you're just being modest Sir. Anyway, let me transfer your reward. I'm also honored to inform you that you have been granted access to most of the Retreat Sir.
			string_id message = new string_id (c_stringFile, "s_29db34e3");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: This is all too much.
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_7d0bf8d");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 6);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch4 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Okay..well anyway, let me transfer your reward. I'm also honored to inform you that you have been granted access to most of the Retreat Sir.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Really?! Whow! So I can go inside right now?
	if (response == "s_4ed6cafa")
	{
		doAnimationAction (player, "applause_excited");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "salute2");

			doAnimationAction (player, "goodbye");

			//-- NPC: Sure can Sir. Take care!
			string_id message = new string_id (c_stringFile, "s_a4069638");
			utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch6 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I think you're just being modest Sir. Anyway, let me transfer your reward. I'm also honored to inform you that you have been granted access to most of the Retreat Sir.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: This is all too much.
	if (response == "s_7d0bf8d")
	{
		doAnimationAction (player, "embarrassed");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "salute2");

			doAnimationAction (player, "goodbye");

			//-- NPC: Nonsense Sir! You should be proud of yourself. Have a great day Sir!
			string_id message = new string_id (c_stringFile, "s_b2fccb6d");
			utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch8 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Y..yes of course Sir! Amazing performance, shooting down 20 of those Rebel scum in one mission.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: 20?! It was 40 at least!
	if (response == "s_d0d78fed")
	{
		doAnimationAction (player, "shakefist");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "squirm");

			//-- NPC: That...that's not possible..Sir..
			string_id message = new string_id (c_stringFile, "s_1f041825");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Are you calling me a liar?!
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_421dc0c2");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 9);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: It's what I do and no one does it better!
	if (response == "s_3cc53bb1")
	{
		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			generic_newbie_pilot_info_emperors_retreat_action_grantAccess (player, npc);

			//-- NPC: Very good Sir, I take your word for that. Anyway, let me transfer your reward. You have also been granted complete access, well almost, to the Retreat Sir.
			string_id message = new string_id (c_stringFile, "s_9dd0fe3d");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What do you mean almost?!
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_29");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 14);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch9 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That...that's not possible..Sir..

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Are you calling me a liar?!
	if (response == "s_421dc0c2")
	{
		doAnimationAction (player, "backhand_threaten");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "taken_aback");

			//-- NPC: Of course not Sir! 40 it was!
			string_id message = new string_id (c_stringFile, "s_d89d15b4");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: At least!
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_745f3194");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 10);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch10 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Of course not Sir! 40 it was!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: At least!
	if (response == "s_745f3194")
	{
		doAnimationAction (player, "wave_finger_warning");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			generic_newbie_pilot_info_emperors_retreat_action_grantAccess (player, npc);

			//-- NPC: At least Sir! Anyway, let me transfer your reward. You have also been granted complete access, well almost, to the Retreat Sir.
			string_id message = new string_id (c_stringFile, "s_b7fac16c");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What do you mean almost?!
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_aede40a6");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 11);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch11 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: At least Sir! Anyway, let me transfer your reward. You have also been granted complete access, well almost, to the Retreat Sir.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What do you mean almost?!
	if (response == "s_aede40a6")
	{
		doAnimationAction (player, "pound_fist_palm");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well I don't think the Emperor would appreciate unannounced visitors in his private quarters Sir.
			string_id message = new string_id (c_stringFile, "s_e1fb0b6a");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Hmm, I suppose you're right. Very well then, get back to work!
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_de1e771");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch12 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well I don't think the Emperor would appreciate unannounced visitors in his private quarters Sir.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Hmm, I suppose you're right. Very well then, get back to work!
	if (response == "s_de1e771")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "salute2");

			doAnimationAction (player, "salute2");

			//-- NPC: Absolutely Sir, right away Sir!
			string_id message = new string_id (c_stringFile, "s_8054081f");
			utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Very good Sir, I take your word for that. Anyway, let me transfer your reward. You have also been granted complete access, well almost, to the Retreat Sir.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What do you mean almost?!
	if (response == "s_29")
	{
		doAnimationAction (player, "pound_fist_palm");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well I don't think the Emperor would appreciate unannounced visitors in his private quarters Sir.
			string_id message = new string_id (c_stringFile, "s_31");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Hmm, I suppose you're right. Very well then, get back to work!
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_33");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well I don't think the Emperor would appreciate unannounced visitors in his private quarters Sir.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Hmm, I suppose you're right. Very well then, get back to work!
	if (response == "s_33")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "salute2");

			doAnimationAction (player, "salute2");

			//-- NPC: Absolutely Sir, right away Sir!
			string_id message = new string_id (c_stringFile, "s_35");
			utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Indeed Sir. Let me transfer that to your account. I'm also honored to inform you that you have been granted access to most of the Retreat Sir.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ohh excellent, yes indeed. Well, I'm going inside then?
	if (response == "s_6403a01d")
	{
		doAnimationAction (player, "thumb_up");

		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "salute2");

			doAnimationAction (player, "goodbye");

			//-- NPC: Of course, go right ahead Sir.
			string_id message = new string_id (c_stringFile, "s_8c3b7af1");
			utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch19 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Who are you? What are you doing here?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I need to get into the Emperor's Retreat.
	if (response == "s_742f54a5")
	{
		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: Then you should become a friend of the Empire and further your training as an Imperial pilot, should you not?
			string_id message = new string_id (c_stringFile, "s_27fddd0");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Of course!
			boolean hasResponse0 = false;
			if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_6adec6b0");

				utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 20);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Nothing. Sorry to bother you.
	if (response == "s_ca992d2c")
	{
		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "goodbye");

			//-- NPC: Farewell.
			string_id message = new string_id (c_stringFile, "s_c8f2f3db");
			utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int generic_newbie_pilot_info_emperors_retreat_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Then you should become a friend of the Empire and further your training as an Imperial pilot, should you not?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Of course!
	if (response == "s_6adec6b0")
	{
		//-- [NOTE] 
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: Then good luck to you, friend.
			string_id message = new string_id (c_stringFile, "s_4d15b266");
			utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.generic_newbie_pilot_info_emperors_retreat");

	setCondition (self, CONDITION_CONVERSABLE);
	setInvulnerable( self, true );
	setCondition( self, CONDITION_SPACE_INTERESTING );
	setName (self, "Imperial Pilot");

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setInvulnerable( self, true );
	setCondition( self, CONDITION_SPACE_INTERESTING );
	setName (self, "Imperial Pilot");

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);

	faceTo( self, player );
	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.generic_newbie_pilot_info_emperors_retreat");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (generic_newbie_pilot_info_emperors_retreat_condition_hasSpaceAccess (player, npc))
	{
		doAnimationAction (npc, "salute2");

		doAnimationAction (player, "salute2");

		//-- NPC: Good to see you Sir!
		string_id message = new string_id (c_stringFile, "s_c6cd8614");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (generic_newbie_pilot_info_emperors_retreat_condition_hasWonAccessQuest (player, npc))
	{
		doAnimationAction (npc, "salute2");

		//-- NPC: Good to see you Sir! Word of your heroics in the Yavin system has spread like wildfire among the ranks.
		string_id message = new string_id (c_stringFile, "s_421b07a8");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Really? Me?
		boolean hasResponse0 = false;
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: As it should be!
		boolean hasResponse1 = false;
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: It has? Oh of course! A reward was mentioned?
		boolean hasResponse2 = false;
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_1ad77c93");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_7630ee0a");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_9045a59e");

			utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 2);

			npcStartConversation (player, npc, "generic_newbie_pilot_info_emperors_retreat", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
	{
		doAnimationAction (npc, "greet");

		//-- NPC: Who are you? What are you doing here?
		string_id message = new string_id (c_stringFile, "s_1093ddb2");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I need to get into the Emperor's Retreat.
		boolean hasResponse0 = false;
		if (generic_newbie_pilot_info_emperors_retreat_condition_hasSpaceShip (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Nothing. Sorry to bother you.
		boolean hasResponse1 = false;
		if (generic_newbie_pilot_info_emperors_retreat_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_742f54a5");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_ca992d2c");

			utils.setScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId", 19);

			npcStartConversation (player, npc, "generic_newbie_pilot_info_emperors_retreat", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "generic_newbie_pilot_info_emperors_retreat")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

	if (branchId == 2 && generic_newbie_pilot_info_emperors_retreat_handleBranch2 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 3 && generic_newbie_pilot_info_emperors_retreat_handleBranch3 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 4 && generic_newbie_pilot_info_emperors_retreat_handleBranch4 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 6 && generic_newbie_pilot_info_emperors_retreat_handleBranch6 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 8 && generic_newbie_pilot_info_emperors_retreat_handleBranch8 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 9 && generic_newbie_pilot_info_emperors_retreat_handleBranch9 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 10 && generic_newbie_pilot_info_emperors_retreat_handleBranch10 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 11 && generic_newbie_pilot_info_emperors_retreat_handleBranch11 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 12 && generic_newbie_pilot_info_emperors_retreat_handleBranch12 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && generic_newbie_pilot_info_emperors_retreat_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && generic_newbie_pilot_info_emperors_retreat_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && generic_newbie_pilot_info_emperors_retreat_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 19 && generic_newbie_pilot_info_emperors_retreat_handleBranch19 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && generic_newbie_pilot_info_emperors_retreat_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.generic_newbie_pilot_info_emperors_retreat.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

