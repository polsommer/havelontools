// ======================================================================
//
// ep3_trandoshan_mosolium_zssik_03.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.36 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.groundquests;
include library.space_quest;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/ep3_trandoshan_mosolium_zssik_03";

// ======================================================================
// Script Conditions
// ======================================================================

boolean ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_isOnTask01 (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "ep3_trando_mololium_zssik_goto", 0);
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_isOnSpaceMission (obj_id player, obj_id npc)
{
	return space_quest.hasQuest( player );
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_hasWonSpaceMission (obj_id player, obj_id npc)
{
	if( space_quest.hasWonQuest( player, "inspect", "ep3_trando_mosolium_zssik_04" ) &&
	!space_quest.hasReceivedReward( player, "inspect", "ep3_trando_mosolium_zssik_04" ))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_hasFailedSpaceMission (obj_id player, obj_id npc)
{
	if ( space_quest.hasFailedQuest( player, "inspect", "ep3_trando_mosolium_zssik_04" ) ||
		space_quest.hasAbortedQuest( player, "inspect", "ep3_trando_mosolium_zssik_04" ) )
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_isOnQuest01 (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "ep3_trando_mosolium_zssik_05");
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_isOnTask02 (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "ep3_trando_mosolium_zssik_05", 2);
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_isOnTask03 (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "ep3_trando_mosolium_zssik_07", 4);
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_isOnQuest02 (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "ep3_trando_mosolium_zssik_07");
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_hasCompletedMosolium (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "ep3_trando_mosolium_zssik_05");
}

// ----------------------------------------------------------------------

boolean ep3_trandoshan_mosolium_zssik_03_condition_mosoliumReady (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "ep3_trando_dakar_zssik_03");
}

// ======================================================================
// Script Actions
// ======================================================================

void ep3_trandoshan_mosolium_zssik_03_action_doSignal01 (obj_id player, obj_id npc)
{
	if(groundquests.isQuestActive(player, "ep3_trando_mololium_zssik_goto"))
	{
		groundquests.sendSignal(player, "readyForMosoliumMission");
	}
}

// ----------------------------------------------------------------------

void ep3_trandoshan_mosolium_zssik_03_action_grantSpaceMission (obj_id player, obj_id npc)
{
	space_quest.grantQuest( player, "inspect", "ep3_trando_mosolium_zssik_04" );
}

// ----------------------------------------------------------------------

void ep3_trandoshan_mosolium_zssik_03_action_grantGroundMission01 (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "ep3_trando_mosolium_zssik_05");
}

// ----------------------------------------------------------------------

void ep3_trandoshan_mosolium_zssik_03_action_doSignal02 (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "rewardMosolium01");
	groundquests.grantQuest(player, "ep3_trando_mosolium_transfer");
}

// ----------------------------------------------------------------------

void ep3_trandoshan_mosolium_zssik_03_action_doSignal03 (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "rewardMosolium02");
	groundquests.grantQuest(player, "ep3_trando_mosolium_transfer");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int ep3_trandoshan_mosolium_zssik_03_handleBranch2 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Nicely done. With that pass code we now have full access to the Avatar Space Platform. And you have recovered the codes just in time, Chawroo has sent word to Orooroo that the Wookiees are ready to speak with you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Great, so what do I do.
	if (response == "s_1043")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_away");

			ep3_trandoshan_mosolium_zssik_03_action_doSignal02 (player, npc);

			//-- NPC: Turn around, walk over to Orooroo, and talk to him. Orooroo may be a Wookiee but he knows a winning team when he sees one. I have no doubts that he will guide you down the correct path.
			string_id message = new string_id (c_stringFile, "s_1045");
			utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I have to take care of something first.
	if (response == "s_1047")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shrug_hands");

			//-- NPC: Alright. We should be okay. I doubt that the Blackscale will notice one of their slave masters gone for a while so there isn't much chance of them disabling the key card.
			string_id message = new string_id (c_stringFile, "s_1049");
			utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch6 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You have made it back. How interesting. I was certain that you were just as soft as you look, but maybe you do have something to you. The codes appear to be in order and now we move onto the next stage of our operation. Now we need to get the Avatar's access keys.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Isn't that what I just got?
	if (response == "s_1055")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_disgust");

			//-- NPC: Of course not. All you stole from the flight leader was the landing codes. You still need to get the codes that will actually let you inside the station itself. You will need to get that from a Blackscale who has access.
			string_id message = new string_id (c_stringFile, "s_1057");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ok, how do I get the Avatar's access keys?
			boolean hasResponse0 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1059");

				utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 7);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch7 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Of course not. All you stole from the flight leader was the landing codes. You still need to get the codes that will actually let you inside the station itself. You will need to get that from a Blackscale who has access.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ok, how do I get the Avatar's access keys?
	if (response == "s_1059")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: By stealing a special key card that their slave masters carry. There is one in particular that I want you to make disappear. He goes by the name of Klesk and is currently working down south in Etyyy. There are rumors that the Blackscales maintain a small slaver camp in the southern portion of the area. You should start your search for him there.
			string_id message = new string_id (c_stringFile, "s_1061");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: There certainly are a lot of keys and codes involved in getting in there.
			boolean hasResponse0 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1063");

				utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 8);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch8 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: By stealing a special key card that their slave masters carry. There is one in particular that I want you to make disappear. He goes by the name of Klesk and is currently working down south in Etyyy. There are rumors that the Blackscales maintain a small slaver camp in the southern portion of the area. You should start your search for him there.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: There certainly are a lot of keys and codes involved in getting in there.
	if (response == "s_1063")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "sigh_deeply");

			//-- NPC: Did you expect it to be protected by a rusty screen door? Of course, when we take over, the entire system will be overhauled and we will use DNA scanners to determine who should be allowed inside. Are you ready to get started?
			string_id message = new string_id (c_stringFile, "s_1065");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yes, I am ready to begin.
			boolean hasResponse0 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I need to take care of some other business first.
			boolean hasResponse1 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1067");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1071");

				utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 9);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch9 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Did you expect it to be protected by a rusty screen door? Of course, when we take over, the entire system will be overhauled and we will use DNA scanners to determine who should be allowed inside. Are you ready to get started?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, I am ready to begin.
	if (response == "s_1067")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "slit_throat");

			ep3_trandoshan_mosolium_zssik_03_action_grantGroundMission01 (player, npc);

			//-- NPC: Good. And feel free to make Klesk suffer a little before you put him down. Once you have his pass stop by and I will give you further instructions.
			string_id message = new string_id (c_stringFile, "s_1069");
			utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I need to take care of some other business first.
	if (response == "s_1071")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "wave_on_dismissing");

			//-- NPC: Very well. Come back and talk to me again when you think you are ready. Make it quick...I do not want to lose this chance to take Klesk out.
			string_id message = new string_id (c_stringFile, "s_1073");
			utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch12 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: So, you failed to steal the landing access codes. Don't look so surprised...we have monitoring stations all through this station.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: A minor set back. I will get it right this time.
	if (response == "s_1077")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "wave_on_dismissing");

			ep3_trandoshan_mosolium_zssik_03_action_grantSpaceMission (player, npc);

			//-- NPC: I am sure you will. My confidence is soaring. Just go get me the access codes from a Blackscale flight leader.
			string_id message = new string_id (c_stringFile, "s_1079");
			utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am going to have to try again later.
	if (response == "s_1081")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "wave_on_dismissing");

			//-- NPC: Why am I not surprised at your reluctance? Fine, come back to see me later...if I still have need of you, I will let you know then.
			string_id message = new string_id (c_stringFile, "s_1083");
			utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch16 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I thought I told you that I didn't want to buy any of tha...oh, it's you. Listen, I am going to be honest with you...I don't like you. I don't like all this sneaking around. If I had my way we would solve the Blackscale issue in combat like true Trandoshans. But Hssissk has strictly forbidden that so I guess I will have to make due with you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am not too thrilled with you either.
	if (response == "s_1089")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: You do not have to like me. You just need to do what I tell you to. I have been charged with preparing you for your meeting with the resistance. You will need to bring them a few...eh, gifts.
			string_id message = new string_id (c_stringFile, "s_1091");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What do I need to bring them gifts for?
			boolean hasResponse0 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1093");

				utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You do not have to like me. You just need to do what I tell you to. I have been charged with preparing you for your meeting with the resistance. You will need to bring them a few...eh, gifts.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What do I need to bring them gifts for?
	if (response == "s_1093")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_accusingly");

			//-- NPC: Fool! What did you think we were setting this meeting up for anyways? An afternoon brunch? We are going to supply them with the access codes to the Avatar Space Platform. Of course, we do not have the access codes...yet. But I know how to get them and you will get them for me. Understood?
			string_id message = new string_id (c_stringFile, "s_1095");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Just point me in the right direction.
			boolean hasResponse0 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't like your attitude. Get them yourself.
			boolean hasResponse1 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1097");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1109");

				utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 18);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch18 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Fool! What did you think we were setting this meeting up for anyways? An afternoon brunch? We are going to supply them with the access codes to the Avatar Space Platform. Of course, we do not have the access codes...yet. But I know how to get them and you will get them for me. Understood?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Just point me in the right direction.
	if (response == "s_1097")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: Well, the first step is that we need to get landing access. Nothing else matters unless we can get a crew to actually land on the station. You will have to steal a set of access keys. Fortunately for us the Blackscale have gotten very lax on security and hardly ever change their passcodes anymore.
			string_id message = new string_id (c_stringFile, "s_1099");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Sure. How do I steal a landing access code?
			boolean hasResponse0 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1101");

				utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 19);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't like your attitude. Get them yourself.
	if (response == "s_1109")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_accusingly");

			//-- NPC: You are already in this too deep to just quit now. Why don't you take a few moments and think about it. Come back and see me when you are ready to fulfill your promise to us.
			string_id message = new string_id (c_stringFile, "s_1111");
			utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch19 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well, the first step is that we need to get landing access. Nothing else matters unless we can get a crew to actually land on the station. You will have to steal a set of access keys. Fortunately for us the Blackscale have gotten very lax on security and hardly ever change their passcodes anymore.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Sure. How do I steal a landing access code?
	if (response == "s_1101")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: All flight leaders of the Blackscale have them in their ship computers. You will intercept a flight leader, disable his fighter, and steal the codes directly from his computer banks. When you are done, do what you will with the flight leader. Naturally, I recommend you vaporize him.
			string_id message = new string_id (c_stringFile, "s_1103");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ok, and where can I find these flight leaders?
			boolean hasResponse0 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1105");

				utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 20);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: All flight leaders of the Blackscale have them in their ship computers. You will intercept a flight leader, disable his fighter, and steal the codes directly from his computer banks. When you are done, do what you will with the flight leader. Naturally, I recommend you vaporize him.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ok, and where can I find these flight leaders?
	if (response == "s_1105")
	{
		ep3_trandoshan_mosolium_zssik_03_action_doSignal01 (player, npc);

		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "dismiss");

			ep3_trandoshan_mosolium_zssik_03_action_grantSpaceMission (player, npc);

			//-- NPC: Obviously, they are somewhere in orbit above the planet. They do not file flight plans with us, so I am afraid you are just going to have to do some old fashioned searching. When you have the codes come back and see me again. I have more work for you to do.
			string_id message = new string_id (c_stringFile, "s_1107");
			utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int ep3_trandoshan_mosolium_zssik_03_handleBranch23 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Listen up %NU. I am going to be honest with you...I don't like you. I don't like all this sneaking around. If I had my way we would solve the Blackscale issue in combat like true Trandoshans. But Hssissk has strictly forbidden that so I guess I will have to make due with you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am not too thrilled with you either.
	if (response == "s_1089")
	{
		//-- [NOTE] 
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: You do not have to like me. You just need to do what I tell you to. I have been charged with preparing you for your meeting with the resistance. You will need to bring them a few...eh, gifts.
			string_id message = new string_id (c_stringFile, "s_1091");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What do I need to bring them gifts for?
			boolean hasResponse0 = false;
			if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_1093");

				utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.ep3_trandoshan_mosolium_zssik_03");

	setCondition (self, CONDITION_CONVERSABLE);
	setInvulnerable( self, true );
	setCondition( self, CONDITION_INTERESTING );
	setName(self, "Mosolium");

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setInvulnerable( self, true );
	setCondition( self, CONDITION_INTERESTING );
	setName(self, "Mosolium");
	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	setCondition (self, CONDITION_CONVERSABLE);
	faceTo(self, player);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.ep3_trandoshan_mosolium_zssik_03");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (ep3_trandoshan_mosolium_zssik_03_condition_hasCompletedMosolium (player, npc))
	{
		doAnimationAction (npc, "point_away");

		//-- NPC: You should speak to Orooroo because I have no further use for you.
		string_id message = new string_id (c_stringFile, "s_1039");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_trandoshan_mosolium_zssik_03_condition_isOnTask02 (player, npc))
	{
		doAnimationAction (npc, "nod_head_once");

		//-- NPC: Nicely done. With that pass code we now have full access to the Avatar Space Platform. And you have recovered the codes just in time, Chawroo has sent word to Orooroo that the Wookiees are ready to speak with you.
		string_id message = new string_id (c_stringFile, "s_1041");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Great, so what do I do.
		boolean hasResponse0 = false;
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I have to take care of something first.
		boolean hasResponse1 = false;
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_1043");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_1047");

			utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 2);

			npcStartConversation (player, npc, "ep3_trandoshan_mosolium_zssik_03", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_trandoshan_mosolium_zssik_03_condition_isOnQuest01 (player, npc))
	{
		doAnimationAction (npc, "point_accusingly");

		//-- NPC: What are you doing talking to me? I told you to go kill Klesk in Etyyy and take his key card. Do not come back to me until you have done so.
		string_id message = new string_id (c_stringFile, "s_1051");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_trandoshan_mosolium_zssik_03_condition_hasWonSpaceMission (player, npc))
	{
		doAnimationAction (npc, "rub_chin_thoughtful");

		//-- NPC: You have made it back. How interesting. I was certain that you were just as soft as you look, but maybe you do have something to you. The codes appear to be in order and now we move onto the next stage of our operation. Now we need to get the Avatar's access keys.
		string_id message = new string_id (c_stringFile, "s_1053");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Isn't that what I just got?
		boolean hasResponse0 = false;
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_1055");

			utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 6);

			npcStartConversation (player, npc, "ep3_trandoshan_mosolium_zssik_03", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_trandoshan_mosolium_zssik_03_condition_hasFailedSpaceMission (player, npc))
	{
		doAnimationAction (npc, "shake_head_disgust");

		//-- NPC: So, you failed to steal the landing access codes. Don't look so surprised...we have monitoring stations all through this station.
		string_id message = new string_id (c_stringFile, "s_1075");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: A minor set back. I will get it right this time.
		boolean hasResponse0 = false;
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I am going to have to try again later.
		boolean hasResponse1 = false;
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_1077");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_1081");

			utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 12);

			npcStartConversation (player, npc, "ep3_trandoshan_mosolium_zssik_03", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_trandoshan_mosolium_zssik_03_condition_isOnSpaceMission (player, npc))
	{
		doAnimationAction (npc, "dismiss");

		//-- NPC: Maybe you should think about finishing the mission you have already started before trying to take another one. When I hire a pilot I want their absolute concentration.
		string_id message = new string_id (c_stringFile, "s_1085");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_trandoshan_mosolium_zssik_03_condition_isOnTask01 (player, npc))
	{
		doAnimationAction (npc, "point_accusingly");

		//-- NPC: I thought I told you that I didn't want to buy any of tha...oh, it's you. Listen, I am going to be honest with you...I don't like you. I don't like all this sneaking around. If I had my way we would solve the Blackscale issue in combat like true Trandoshans. But Hssissk has strictly forbidden that so I guess I will have to make due with you.
		string_id message = new string_id (c_stringFile, "s_1087");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I am not too thrilled with you either.
		boolean hasResponse0 = false;
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_1089");

			utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 16);

			npcStartConversation (player, npc, "ep3_trandoshan_mosolium_zssik_03", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_trandoshan_mosolium_zssik_03_condition_mosoliumReady (player, npc))
	{
		//-- NPC: Listen up %NU. I am going to be honest with you...I don't like you. I don't like all this sneaking around. If I had my way we would solve the Blackscale issue in combat like true Trandoshans. But Hssissk has strictly forbidden that so I guess I will have to make due with you.
		string_id message = new string_id (c_stringFile, "s_148");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I am not too thrilled with you either.
		boolean hasResponse0 = false;
		if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_1089");

			utils.setScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId", 16);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "ep3_trandoshan_mosolium_zssik_03", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (ep3_trandoshan_mosolium_zssik_03_condition__defaultCondition (player, npc))
	{
		doAnimationAction (npc, "wave_on_dismissing");

		//-- NPC: What do you want? Do I look like someone who would want to talk with the likes of you? Perhaps you should go talk to Boshaz. He seems to enjoy talking to offworlders.
		string_id message = new string_id (c_stringFile, "s_1113");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "ep3_trandoshan_mosolium_zssik_03")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

	if (branchId == 2 && ep3_trandoshan_mosolium_zssik_03_handleBranch2 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 6 && ep3_trandoshan_mosolium_zssik_03_handleBranch6 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 7 && ep3_trandoshan_mosolium_zssik_03_handleBranch7 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 8 && ep3_trandoshan_mosolium_zssik_03_handleBranch8 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 9 && ep3_trandoshan_mosolium_zssik_03_handleBranch9 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 12 && ep3_trandoshan_mosolium_zssik_03_handleBranch12 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 16 && ep3_trandoshan_mosolium_zssik_03_handleBranch16 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && ep3_trandoshan_mosolium_zssik_03_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 18 && ep3_trandoshan_mosolium_zssik_03_handleBranch18 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 19 && ep3_trandoshan_mosolium_zssik_03_handleBranch19 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && ep3_trandoshan_mosolium_zssik_03_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 23 && ep3_trandoshan_mosolium_zssik_03_handleBranch23 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.ep3_trandoshan_mosolium_zssik_03.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

