// ======================================================================
//
// corellia_cb_cora.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.36 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.groundquests;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/corellia_cb_cora";

// ======================================================================
// Script Conditions
// ======================================================================

boolean corellia_cb_cora_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean corellia_cb_cora_condition_offerQuest (obj_id player, obj_id npc)
{
	if (groundquests.isTaskActive(player, "quest/corellia_cb_2_pointer", "pointer"))
	{
		return true;
	}
	
	if (groundquests.hasCompletedQuest(player, "quest/corellia_cb_1"))
	{
		if (!groundquests.isQuestActiveOrComplete(player, "quest/corellia_cb_2"))
		{
			return true;
		}	
	}
	
	return false;
}

// ----------------------------------------------------------------------

boolean corellia_cb_cora_condition_onQuest1 (obj_id player, obj_id npc)
{
	if (groundquests.isQuestActive(player, "quest/corellia_cb_2"))
	{
		return true;
	}	
		
	return false;
}

// ----------------------------------------------------------------------

boolean corellia_cb_cora_condition_cb2_finish (obj_id player, obj_id npc)
{
	if (groundquests.isTaskActive(player, "corellia_cb_2", "cb_2_cora_finish"))
	{
		return true;
	}
	
	return false;
}

// ----------------------------------------------------------------------

boolean corellia_cb_cora_condition_offerQuest3 (obj_id player, obj_id npc)
{
	if (groundquests.hasCompletedQuest(player, "quest/corellia_cb_2"))
	{
		if (!groundquests.isQuestActive(player, "quest/corellia_cb_3"))
		{
			if (!groundquests.hasCompletedQuest(player, "quest/corellia_cb_3"))
			{
				return true;
			}
		}	
	}
	
	return false;
}

// ----------------------------------------------------------------------

boolean corellia_cb_cora_condition_onQuest3 (obj_id player, obj_id npc)
{
	if (groundquests.isQuestActive(player, "quest/corellia_cb_3"))
	{
		return true;
	}
	return false;
}

// ----------------------------------------------------------------------

boolean corellia_cb_cora_condition_cb3_finish (obj_id player, obj_id npc)
{
	if (groundquests.isTaskActive(player, "corellia_cb_3", "cb_3_return_cora"))
	{
		return true;
	}
	
	return false;
}	

// ----------------------------------------------------------------------

boolean corellia_cb_cora_condition_offerPointer4 (obj_id player, obj_id npc)
{
	if (groundquests.hasCompletedQuest(player, "quest/corellia_cb_3"))
	{
		if ( !groundquests.isQuestActive(player, "quest/corellia_cb_4_pointer") &&
		!groundquests.isQuestActiveOrComplete(player, "quest/corellia_cb_4") )
		{
			return true;
		}	
	}
	
	return false;
}

// ----------------------------------------------------------------------

boolean corellia_cb_cora_condition_cb_finished (obj_id player, obj_id npc)
{
	if (groundquests.hasCompletedQuest(player, "quest/corellia_cb_3"))
	{
		return true;
	}	
	
	return false;
}	

// ----------------------------------------------------------------------

boolean corellia_cb_cora_condition_offerSideQuest (obj_id player, obj_id npc)
{
	if (!groundquests.isQuestActiveOrComplete(player, "quest/corellia_cb_side_1"))
	{
			return true;
	}
	return false;	
}

// ======================================================================
// Script Actions
// ======================================================================

void corellia_cb_cora_action_sendPointerSignal (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "cb_2_cora");
	return;
}

// ----------------------------------------------------------------------

void corellia_cb_cora_action_grantSecondQuest (obj_id player, obj_id npc)
{
	groundquests.grantQuest (player, "quest/corellia_cb_2");
	return;
}

// ----------------------------------------------------------------------

void corellia_cb_cora_action_sendFinishSignal (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "cb_2_cora_complete");
	return;
}

// ----------------------------------------------------------------------

void corellia_cb_cora_action_grantThirdQuest (obj_id player, obj_id npc)
{
	groundquests.grantQuest (player, "quest/corellia_cb_3");
	return;
}

// ----------------------------------------------------------------------

void corellia_cb_cora_action_sendFinish3Signal (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "cb_3_finish");
	return;
}

// ----------------------------------------------------------------------

void corellia_cb_cora_action_grantPointerQuest (obj_id player, obj_id npc)
{
	groundquests.grantQuest (player, "quest/corellia_cb_4_pointer");
	return;
}

// ----------------------------------------------------------------------

void corellia_cb_cora_action_grantSideQuest (obj_id player, obj_id npc)
{
		groundquests.grantQuest (player, "quest/corellia_cb_side_1");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int corellia_cb_cora_handleBranch1 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: What is the nature of your business here? This is an official investigation. You are keeping me from my work.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am here to help. I found the flight recorder from that ship.
	if (response == "s_6")
	{
		corellia_cb_cora_action_sendPointerSignal (player, npc);

		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Ah, yes, I have spoken to Sinis about this. Though I appreciate his need to recover his equipment, he should have gone through me. However, you have had success and my boss wants this matter resolved as there are other important concerns beyond Sinis's cargo.
			string_id message = new string_id (c_stringFile, "s_8");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Other concerns? Such as...
			boolean hasResponse0 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_10");

				utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 2);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Oh, never mind. Sorry to bother you.
	if (response == "s_26")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Move on and stay clear of the ship. We need room to work here.
			string_id message = new string_id (c_stringFile, "s_28");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch2 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Ah, yes, I have spoken to Sinis about this. Though I appreciate his need to recover his equipment, he should have gone through me. However, you have had success and my boss wants this matter resolved as there are other important concerns beyond Sinis's cargo.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Other concerns? Such as...
	if (response == "s_10")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: I probably shouldn't be telling you this, but Captain Donovan was piloting this ship and I want to know what happened to him. I cannot believe he would be mixed up in this. From what Sinis told me, his cargo is accounted for which means either it was looted by these scavengers or something more sinister is at work here.
			string_id message = new string_id (c_stringFile, "s_12");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am happy to help. What more can you tell me?
			boolean hasResponse0 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_14");

				utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 3);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch3 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I probably shouldn't be telling you this, but Captain Donovan was piloting this ship and I want to know what happened to him. I cannot believe he would be mixed up in this. From what Sinis told me, his cargo is accounted for which means either it was looted by these scavengers or something more sinister is at work here.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am happy to help. What more can you tell me?
	if (response == "s_14")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: That's all I can say for now: finding Captain Donovan is the first order of business. I understand you found Sinis's cargo at a Deflarian camp west of here. I think returning to that camp again is in order. Perhaps in your haste to recover the cargo, you missed something important.
			string_id message = new string_id (c_stringFile, "s_16");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ok, I will go back there and check it out.
			boolean hasResponse0 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No thanks. I have really had enough of these Deflarians for now. Thanks anyway.
			boolean hasResponse1 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_18");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_22");

				utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 4);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch4 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That's all I can say for now: finding Captain Donovan is the first order of business. I understand you found Sinis's cargo at a Deflarian camp west of here. I think returning to that camp again is in order. Perhaps in your haste to recover the cargo, you missed something important.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ok, I will go back there and check it out.
	if (response == "s_18")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			corellia_cb_cora_action_grantSecondQuest (player, npc);

			//-- NPC: Excellent-- I look forward to an update soon. Now I have to complete this inspection and examine the contents of this ship. Good luck!
			string_id message = new string_id (c_stringFile, "s_20");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No thanks. I have really had enough of these Deflarians for now. Thanks anyway.
	if (response == "s_22")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well, like I said, this probably should be handled by my officers anyway. Please keep out of our way.
			string_id message = new string_id (c_stringFile, "s_24");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch8 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Excellent work! Thanks to you, Donovan is safe and some of this mystery has been unraveled. If you are interested in more work, there is more to be done.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Is there anything else you need me to take care of for you?
	if (response == "s_67")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well now that you mention it, these scavengers are bothersome and interfering. Can you eliminate some for me?
			string_id message = new string_id (c_stringFile, "s_68");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Sure -- glad to help!
			boolean hasResponse0 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_69");

				utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 9);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch9 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well now that you mention it, these scavengers are bothersome and interfering. Can you eliminate some for me?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Sure -- glad to help!
	if (response == "s_69")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			corellia_cb_cora_action_grantSideQuest (player, npc);

			//-- NPC: Alright, kill 15 Deflarian scavengers. When this is done, I will transfer some credits to your account for your time. Thank you!
			string_id message = new string_id (c_stringFile, "s_70");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch11 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Let me know when you have more information on Captain Donovan.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Is there anything else you need me to take care of for you?
	if (response == "s_62")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well now that you mention it, these scavengers are bothersome and interfering can you eliminate some for me?
			string_id message = new string_id (c_stringFile, "s_63");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Sure -- glad to help!
			boolean hasResponse0 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_64");

				utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch12 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well now that you mention it, these scavengers are bothersome and interfering can you eliminate some for me?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Sure -- glad to help!
	if (response == "s_64")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			corellia_cb_cora_action_grantSideQuest (player, npc);

			//-- NPC: Alright, kill 15 Deflarian scavengers. When this is done, I will transfer some credits to your account for your time. Thank you!
			string_id message = new string_id (c_stringFile, "s_65");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I have spoken with Donovan, and from what he has told me, we think we know where the hijacked ship is located. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Hijacked ship?
	if (response == "s_44")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Yes, Donovan's ship did not crash -- the Deflarians have it. The ship over there is of the same model made to look like Donovan's to cover the Deflarians' theft of its cargo. At least that is my theory. We still need proof.
			string_id message = new string_id (c_stringFile, "s_46");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What cargo? I already recovered Sinis's medical shipment.
			boolean hasResponse0 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_48");

				utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, Donovan's ship did not crash -- the Deflarians have it. The ship over there is of the same model made to look like Donovan's to cover the Deflarians' theft of its cargo. At least that is my theory. We still need proof.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What cargo? I already recovered Sinis's medical shipment.
	if (response == "s_48")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Donovan was also delivering some weapons to the local police force here in Tyrena. With all of the recent criminal activity, it's obvious why these weapons are important to us. Recovering the ship may lead us to where the weapons are, so that is the first order of business.
			string_id message = new string_id (c_stringFile, "s_50");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ok. Where is the ship located? I am ready to help.
			boolean hasResponse0 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_52");

				utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 16);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch16 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Donovan was also delivering some weapons to the local police force here in Tyrena. With all of the recent criminal activity, it's obvious why these weapons are important to us. Recovering the ship may lead us to where the weapons are, so that is the first order of business.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ok. Where is the ship located? I am ready to help.
	if (response == "s_52")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			corellia_cb_cora_action_grantThirdQuest (player, npc);

			//-- NPC: Here are the coordinates Donovan gave me. Investigate this area and I will contact you with further instructions.
			string_id message = new string_id (c_stringFile, "s_54");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch18 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I just got word my team has recovered the ship and all of the weapons are accounted for! You have proven yourself again. I will have to thank Sinis for getting you involved in this. My superior has asked me to have you talk to him. Let me know when you are ready for more details.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm ready now.
	if (response == "s_85")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Captain Jark, who assigned me to investigate this, has asked to speak to you. I told him of the help you have been to me. If you want more work, head over to Tyrena and speak with him.
			string_id message = new string_id (c_stringFile, "s_86");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ok, I will.
			boolean hasResponse0 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_72");

				utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 21);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'll speak with you again when I'm ready.
	if (response == "s_87")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: I'll be here.
			string_id message = new string_id (c_stringFile, "s_88");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch19 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Captain Jark, who assigned me to investigate this, has asked to speak to you. I told him of the help you have been to me. If you want more work, head over to Tyrena and speak with him.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ok, I will.
	if (response == "s_72")
	{
		corellia_cb_cora_action_grantPointerQuest (player, npc);

		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good luck! and thanks again.
			string_id message = new string_id (c_stringFile, "s_74");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch21 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Captain Jark, who assigned me to investigate this, has asked to speak to you. I told him of the help you have been to me. If you want more work, head over to Tyrena and speak with him.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ok, I will.
	if (response == "s_72")
	{
		corellia_cb_cora_action_grantPointerQuest (player, npc);

		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good luck! and thanks again.
			string_id message = new string_id (c_stringFile, "s_74");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch24 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I will be in contact with you when you make further progress with your task.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Is there anything else you need me to take care of for you?
	if (response == "s_80")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition_offerSideQuest (player, npc))
		{
			//-- NPC: Well, now that you mention it, these scavengers are bothersome and interfering. Can you eliminate some for me?
			string_id message = new string_id (c_stringFile, "s_82");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Sure -- glad to help!
			boolean hasResponse0 = false;
			if (corellia_cb_cora_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_84");

				utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 25);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			//-- NPC: I just need you to finish what you have already started.
			string_id message = new string_id (c_stringFile, "s_93");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int corellia_cb_cora_handleBranch25 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well, now that you mention it, these scavengers are bothersome and interfering. Can you eliminate some for me?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Sure -- glad to help!
	if (response == "s_84")
	{
		//-- [NOTE] 
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			corellia_cb_cora_action_grantSideQuest (player, npc);

			//-- NPC: Alright, kill 15 Deflarian scavengers. When this is done, I will transfer some credits to your account for your time. Thank you!
			string_id message = new string_id (c_stringFile, "s_90");
			utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isTangible (self)) || (isPlayer (self)))
		detachScript(self, "conversation.corellia_cb_cora");

	setCondition (self, CONDITION_CONVERSABLE);
	setCondition(self, CONDITION_INTERESTING);
	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setCondition(self, CONDITION_INTERESTING);
	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	setCondition (self, CONDITION_CONVERSABLE);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.corellia_cb_cora");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (corellia_cb_cora_condition_offerQuest (player, npc))
	{
		//-- NPC: What is the nature of your business here? This is an official investigation. You are keeping me from my work.
		string_id message = new string_id (c_stringFile, "s_4");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I am here to help. I found the flight recorder from that ship.
		boolean hasResponse0 = false;
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Oh, never mind. Sorry to bother you.
		boolean hasResponse1 = false;
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_6");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_26");

			utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 1);

			npcStartConversation (player, npc, "corellia_cb_cora", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_cb_cora_condition_cb2_finish (player, npc))
	{
		corellia_cb_cora_action_sendFinishSignal (player, npc);

		//-- NPC: Excellent work! Thanks to you, Donovan is safe and some of this mystery has been unraveled. If you are interested in more work, there is more to be done.
		string_id message = new string_id (c_stringFile, "s_30");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Is there anything else you need me to take care of for you?
		boolean hasResponse0 = false;
		if (corellia_cb_cora_condition_offerSideQuest (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_67");

			utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 8);

			npcStartConversation (player, npc, "corellia_cb_cora", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_cb_cora_condition_onQuest1 (player, npc))
	{
		//-- NPC: Let me know when you have more information on Captain Donovan.
		string_id message = new string_id (c_stringFile, "s_36");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Is there anything else you need me to take care of for you?
		boolean hasResponse0 = false;
		if (corellia_cb_cora_condition_offerSideQuest (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_62");

			utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 11);

			npcStartConversation (player, npc, "corellia_cb_cora", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_cb_cora_condition_offerQuest3 (player, npc))
	{
		//-- NPC: I have spoken with Donovan, and from what he has told me, we think we know where the hijacked ship is located. 
		string_id message = new string_id (c_stringFile, "s_42");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Hijacked ship?
		boolean hasResponse0 = false;
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_44");

			utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 14);

			npcStartConversation (player, npc, "corellia_cb_cora", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_cb_cora_condition_cb3_finish (player, npc))
	{
		corellia_cb_cora_action_sendFinish3Signal (player, npc);

		//-- NPC: I just got word my team has recovered the ship and all of the weapons are accounted for! You have proven yourself again. I will have to thank Sinis for getting you involved in this. My superior has asked me to have you talk to him. Let me know when you are ready for more details.
		string_id message = new string_id (c_stringFile, "s_56");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I'm ready now.
		boolean hasResponse0 = false;
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I'll speak with you again when I'm ready.
		boolean hasResponse1 = false;
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_85");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_87");

			utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 18);

			npcStartConversation (player, npc, "corellia_cb_cora", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_cb_cora_condition_offerPointer4 (player, npc))
	{
		//-- NPC: Captain Jark, who assigned me to investigate this, has asked to speak to you. I told him of the help you have been to me. If you want more work, head over to Tyrena and speak with him.
		string_id message = new string_id (c_stringFile, "s_66");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Ok, I will.
		boolean hasResponse0 = false;
		if (corellia_cb_cora_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_72");

			utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 21);

			npcStartConversation (player, npc, "corellia_cb_cora", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_cb_cora_condition_cb_finished (player, npc))
	{
		//-- NPC: Thank you for all your help with the investigation. Good luck!
		string_id message = new string_id (c_stringFile, "s_76");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_cb_cora_condition_onQuest3 (player, npc))
	{
		//-- NPC: I will be in contact with you when you make further progress with your task.
		string_id message = new string_id (c_stringFile, "s_78");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Is there anything else you need me to take care of for you?
		boolean hasResponse0 = false;
		if (corellia_cb_cora_condition_onQuest3 (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_80");

			utils.setScriptVar (player, "conversation.corellia_cb_cora.branchId", 24);

			npcStartConversation (player, npc, "corellia_cb_cora", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (corellia_cb_cora_condition__defaultCondition (player, npc))
	{
		//-- NPC: We are very busy right now conducting an investigation. Please move along.
		string_id message = new string_id (c_stringFile, "s_94");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "corellia_cb_cora")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.corellia_cb_cora.branchId");

	if (branchId == 1 && corellia_cb_cora_handleBranch1 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 2 && corellia_cb_cora_handleBranch2 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 3 && corellia_cb_cora_handleBranch3 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 4 && corellia_cb_cora_handleBranch4 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 8 && corellia_cb_cora_handleBranch8 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 9 && corellia_cb_cora_handleBranch9 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 11 && corellia_cb_cora_handleBranch11 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 12 && corellia_cb_cora_handleBranch12 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && corellia_cb_cora_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && corellia_cb_cora_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 16 && corellia_cb_cora_handleBranch16 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 18 && corellia_cb_cora_handleBranch18 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 19 && corellia_cb_cora_handleBranch19 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 21 && corellia_cb_cora_handleBranch21 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 24 && corellia_cb_cora_handleBranch24 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 25 && corellia_cb_cora_handleBranch25 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.corellia_cb_cora.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

