// ======================================================================
//
// c_story1_5.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.36 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.factions;
include library.groundquests;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/c_story1_5";

// ======================================================================
// Script Conditions
// ======================================================================

boolean c_story1_5_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean c_story1_5_condition_finishedQuest (obj_id player, obj_id npc)
{
	if (groundquests.hasCompletedQuest (player, "quest/c_syren5"))
	{
		return true;
	}
	return false;
}

// ----------------------------------------------------------------------

boolean c_story1_5_condition_isOnQuest (obj_id player, obj_id npc)
{
	if (groundquests.isQuestActive(player, "quest/c_syren5"))
	{
		return true;
	}
	return false;		
}

// ----------------------------------------------------------------------

boolean c_story1_5_condition_isQualified (obj_id player, obj_id npc)
{
	if (factions.isImperial(player))
	{
		if (groundquests.hasCompletedQuest(player, "c_story1_4b_imperial"))
			return true;
	}	
	return false;	
}

// ----------------------------------------------------------------------

boolean c_story1_5_condition_isThisDisabled (obj_id player, obj_id npc)
{
	return groundquests.isQuestDisabled ("c_syren5");
}

// ======================================================================
// Script Actions
// ======================================================================

void c_story1_5_action_grantSyren5Quest (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "quest/c_syren5");
	return;
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int c_story1_5_handleBranch2 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The Emperor himself personally sent a message through one of his top aides to one of my superiors asking that we make sure to thank the person responsible for taking care of this nagging problem. That would be you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What?
	if (response == "s_40")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: The Emperor thanks you.
			string_id message = new string_id (c_stringFile, "s_41");
			utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch5 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: So, you're the one that took down Cal Handro?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I guess you could say that.
	if (response == "s_11")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well, whatever you did, the Empire appreciates your help. There is just one little problem though.
			string_id message = new string_id (c_stringFile, "s_13");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What's the problem?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_15");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 6);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Who's Cal Handro?
	if (response == "s_34")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Don't play dumb with me. Cal Handro was a smuggler and a traitor to the Empire, as you well know. If you have any friends now would be a good time to call them. We'll be dealing with a large number of rebels.
			string_id message = new string_id (c_stringFile, "s_37");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm capable and have plenty of friends.
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Why would I need friends?
			boolean hasResponse1 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_43");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_75");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 11);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch6 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well, whatever you did, the Empire appreciates your help. There is just one little problem though.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What's the problem?
	if (response == "s_15")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Someone's still using Handro's ship. They're still making all his deliveries. The issue is still unresolved.
			string_id message = new string_id (c_stringFile, "s_17");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: That's not possible!
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: He must have had a partner.
			boolean hasResponse1 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_19");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_29");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 7);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch7 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Someone's still using Handro's ship. They're still making all his deliveries. The issue is still unresolved.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: That's not possible!
	if (response == "s_19")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Well, possible or not, it's happening.
			string_id message = new string_id (c_stringFile, "s_21");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What now?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_23");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 8);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: He must have had a partner.
	if (response == "s_29")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: That's what we're thinking. It's time to wrap this mess up once and for all, before it becomes embarrassing to the Imperial Command.
			string_id message = new string_id (c_stringFile, "s_31");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'll do whatever it takes. Where do I start?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_35");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 10);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch8 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Well, possible or not, it's happening.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What now?
	if (response == "s_23")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: We have to seriously consider the possibility that someone else has just stepped into Handro's place. Perhaps someone familiar with it already. 
			string_id message = new string_id (c_stringFile, "s_25");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: You're saying he had a partner?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_27");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 9);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch9 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We have to seriously consider the possibility that someone else has just stepped into Handro's place. Perhaps someone familiar with it already. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You're saying he had a partner?
	if (response == "s_27")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: That's what we're thinking. It's time to wrap this mess up once and for all, before it becomes embarrassing to the Imperial Command.
			string_id message = new string_id (c_stringFile, "s_31");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'll do whatever it takes. Where do I start?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_35");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 10);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch10 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That's what we're thinking. It's time to wrap this mess up once and for all, before it becomes embarrassing to the Imperial Command.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'll do whatever it takes. Where do I start?
	if (response == "s_35")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Excellent. This is what we know for sure. Imperial intelligence indicates that Handro is working with the rebels to protect a shield generator he developed specifically for his ship. Before the situation in space can be handled we'll need you to disrupt the signal from that generator.
			string_id message = new string_id (c_stringFile, "s_45");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: A shield generator? How does that work?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Point me to the Rebel scum and they'll be handled.
			boolean hasResponse1 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_47");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_53");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch11 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Don't play dumb with me. Cal Handro was a smuggler and a traitor to the Empire, as you well know. If you have any friends now would be a good time to call them. We'll be dealing with a large number of rebels.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm capable and have plenty of friends.
	if (response == "s_43")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Excellent. This is what we know for sure. Imperial intelligence indicates that Handro is working with the rebels to protect a shield generator he developed specifically for his ship. Before the situation in space can be handled we'll need you to disrupt the signal from that generator.
			string_id message = new string_id (c_stringFile, "s_45");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: A shield generator? How does that work?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Point me to the Rebel scum and they'll be handled.
			boolean hasResponse1 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_47");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_53");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Why would I need friends?
	if (response == "s_75")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: First of all, the rebels have a fairly well-guarded base. But even if you were capable of taking it out alone you'll need someone in a ship in space ready to take out Handro's ship as soon as the shield is down.
			string_id message = new string_id (c_stringFile, "s_77");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Ok, tell me exactly what needs to be done.
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_79");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 19);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch12 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Excellent. This is what we know for sure. Imperial intelligence indicates that Handro is working with the rebels to protect a shield generator he developed specifically for his ship. Before the situation in space can be handled we'll need you to disrupt the signal from that generator.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: A shield generator? How does that work?
	if (response == "s_47")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: We're not sure. But we are sure that by intercepting the signal we can make his ship vulnerable in space. You,personally, won't have enough time to disrupt the signal and destroy his ship, however. That's where your friends will come in.
			string_id message = new string_id (c_stringFile, "s_49");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Tell me what to do and it will get done.
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_51");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 13);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Point me to the Rebel scum and they'll be handled.
	if (response == "s_53")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: It encourages me to see someone like you serving the Emperor. I'll mark the location of their base on Talus in your datapad. You'll need to do two things once you're inside. The first is to find the communications array. Use it to disrupt the false signals that it's sending so you can locate his ship.
			string_id message = new string_id (c_stringFile, "s_55");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What's the second thing?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_57");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 14);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch13 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We're not sure. But we are sure that by intercepting the signal we can make his ship vulnerable in space. You,personally, won't have enough time to disrupt the signal and destroy his ship, however. That's where your friends will come in.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Tell me what to do and it will get done.
	if (response == "s_51")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Excellent. This is what we know for sure. Imperial intelligence indicates that Handro is working with the rebels to protect a shield generator he developed specifically for his ship. Before the situation in space can be handled we'll need you to disrupt the signal from that generator.
			string_id message = new string_id (c_stringFile, "s_45");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: A shield generator? How does that work?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Point me to the Rebel scum and they'll be handled.
			boolean hasResponse1 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_47");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_53");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It encourages me to see someone like you serving the Emperor. I'll mark the location of their base on Talus in your datapad. You'll need to do two things once you're inside. The first is to find the communications array. Use it to disrupt the false signals that it's sending so you can locate his ship.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What's the second thing?
	if (response == "s_57")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Second, turn off the shield generator. Once the generator is disrupted your friends in space can take down the ship.
			string_id message = new string_id (c_stringFile, "s_59");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm on it.
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I'll just take the shield down then kill him myself.
			boolean hasResponse1 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_61");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_65");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Second, turn off the shield generator. Once the generator is disrupted your friends in space can take down the ship.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm on it.
	if (response == "s_61")
	{
		c_story1_5_action_grantSyren5Quest (player, npc);

		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good. Long live the Emperor!
			string_id message = new string_id (c_stringFile, "s_63");
			utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'll just take the shield down then kill him myself.
	if (response == "s_65")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: That won't work. As soon as the pilot realizes his ship is vulnerable he'll begin making calculations for a lightspeed jump. We've estimated that once the communication array is disrupted, you will have 10 minutes to complete your mission.
			string_id message = new string_id (c_stringFile, "s_67");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Oh. I'd better bring some friends then.
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_69");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: That won't work. As soon as the pilot realizes his ship is vulnerable he'll begin making calculations for a lightspeed jump. We've estimated that once the communication array is disrupted, you will have 10 minutes to complete your mission.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Oh. I'd better bring some friends then.
	if (response == "s_69")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Exactly the point. Are you up for this assignment?
			string_id message = new string_id (c_stringFile, "s_71");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Bring it on.
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_73");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 18);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch18 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Exactly the point. Are you up for this assignment?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Bring it on.
	if (response == "s_73")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Excellent. This is what we know for sure. Imperial intelligence indicates that Handro is working with the rebels to protect a shield generator he developed specifically for his ship. Before the situation in space can be handled we'll need you to disrupt the signal from that generator.
			string_id message = new string_id (c_stringFile, "s_45");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: A shield generator? How does that work?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Point me to the Rebel scum and they'll be handled.
			boolean hasResponse1 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_47");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_53");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int c_story1_5_handleBranch19 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: First of all, the rebels have a fairly well-guarded base. But even if you were capable of taking it out alone you'll need someone in a ship in space ready to take out Handro's ship as soon as the shield is down.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Ok, tell me exactly what needs to be done.
	if (response == "s_79")
	{
		//-- [NOTE] 
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			//-- NPC: Excellent. This is what we know for sure. Imperial intelligence indicates that Handro is working with the rebels to protect a shield generator he developed specifically for his ship. Before the situation in space can be handled we'll need you to disrupt the signal from that generator.
			string_id message = new string_id (c_stringFile, "s_45");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: A shield generator? How does that work?
			boolean hasResponse0 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Point me to the Rebel scum and they'll be handled.
			boolean hasResponse1 = false;
			if (c_story1_5_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_47");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_53");

				utils.setScriptVar (player, "conversation.c_story1_5.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.c_story1_5");

	setCondition (self, CONDITION_CONVERSABLE);
	ai_lib.setDefaultCalmBehavior (self, ai_lib.BEHAVIOR_SENTINEL);
	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	ai_lib.setDefaultCalmBehavior (self, ai_lib.BEHAVIOR_SENTINEL);
	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	setCondition (self, CONDITION_CONVERSABLE);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.c_story1_5");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (c_story1_5_condition__defaultCondition (player, npc))
	{
		//-- NPC: There's nothing you could say that would possibly interest me.
		string_id message = new string_id (c_stringFile, "s_82");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (c_story1_5_condition_finishedQuest (player, npc))
	{
		//-- NPC: The Emperor himself personally sent a message through one of his top aides to one of my superiors asking that we make sure to thank the person responsible for taking care of this nagging problem. That would be you.
		string_id message = new string_id (c_stringFile, "s_38");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What?
		boolean hasResponse0 = false;
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_40");

			utils.setScriptVar (player, "conversation.c_story1_5.branchId", 2);

			npcStartConversation (player, npc, "c_story1_5", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (c_story1_5_condition_isOnQuest (player, npc))
	{
		//-- NPC: Are you having trouble with the rebels? Perhaps you should find more friends. Don't forget that you'll have to use a two pronged attack, your group on the ground, another group in space.
		string_id message = new string_id (c_stringFile, "s_39");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (c_story1_5_condition_isQualified (player, npc))
	{
		//-- NPC: So, you're the one that took down Cal Handro?
		string_id message = new string_id (c_stringFile, "s_9");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I guess you could say that.
		boolean hasResponse0 = false;
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Who's Cal Handro?
		boolean hasResponse1 = false;
		if (c_story1_5_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_11");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_34");

			utils.setScriptVar (player, "conversation.c_story1_5.branchId", 5);

			npcStartConversation (player, npc, "c_story1_5", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "c_story1_5")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.c_story1_5.branchId");

	if (branchId == 2 && c_story1_5_handleBranch2 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 5 && c_story1_5_handleBranch5 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 6 && c_story1_5_handleBranch6 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 7 && c_story1_5_handleBranch7 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 8 && c_story1_5_handleBranch8 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 9 && c_story1_5_handleBranch9 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 10 && c_story1_5_handleBranch10 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 11 && c_story1_5_handleBranch11 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 12 && c_story1_5_handleBranch12 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 13 && c_story1_5_handleBranch13 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && c_story1_5_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && c_story1_5_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && c_story1_5_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 18 && c_story1_5_handleBranch18 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 19 && c_story1_5_handleBranch19 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.c_story1_5.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

