// ======================================================================
//
// som_kenobi_pwwoz_pwwa.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.35 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.groundquests;
include library.jedi;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/som_kenobi_pwwoz_pwwa";

// ======================================================================
// Script Conditions
// ======================================================================

boolean som_kenobi_pwwoz_pwwa_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean som_kenobi_pwwoz_pwwa_condition_playerJedi (obj_id player, obj_id npc)
{
	return jedi.isForceSensitive (player);
}

// ----------------------------------------------------------------------

boolean som_kenobi_pwwoz_pwwa_condition_foundCrystal (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "som_kenobi_samaritan_1", "returnPwwoz");
}

// ----------------------------------------------------------------------

boolean som_kenobi_pwwoz_pwwa_condition_onQuest (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "som_kenobi_samaritan_1");
}

// ----------------------------------------------------------------------

boolean som_kenobi_pwwoz_pwwa_condition_keptCrystal (obj_id player, obj_id npc)
{
	if (groundquests.isQuestActive(player, "som_kenobi_samaritan_2")||
		groundquests.hasCompletedQuest(player, "som_kenobi_samaritan_2"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean som_kenobi_pwwoz_pwwa_condition_gaveCrystal (obj_id player, obj_id npc)
{
	if (groundquests.hasCompletedQuest(player, "som_kenobi_samaritan_1")&&
		!groundquests.hasCompletedQuest(player, "som_kenobi_samaritan_2"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean som_kenobi_pwwoz_pwwa_condition_killPwwoz (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "som_kenobi_samaritan_1", "killIthorian");
}

// ======================================================================
// Script Actions
// ======================================================================

void som_kenobi_pwwoz_pwwa_action_giveQuest1 (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "som_kenobi_samaritan_1");
}

// ----------------------------------------------------------------------

void som_kenobi_pwwoz_pwwa_action_removeInvuln (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "giveCrystal");
	setInvulnerable (npc, false);
	clearCondition (npc, CONDITION_INTERESTING);
}

// ----------------------------------------------------------------------

void som_kenobi_pwwoz_pwwa_action_attack (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "giveCrystal");
	startCombat(npc, player);
	clearCondition(npc, CONDITION_CONVERSABLE);
}

// ----------------------------------------------------------------------

void som_kenobi_pwwoz_pwwa_action_signalKeep (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "keepCrystal");
}

// ----------------------------------------------------------------------

void som_kenobi_pwwoz_pwwa_action_secondAttack (obj_id player, obj_id npc)
{
	clearCondition(npc, CONDITION_CONVERSABLE);
	startCombat(npc, player);
}

// ----------------------------------------------------------------------

void som_kenobi_pwwoz_pwwa_action_removeInvuln2 (obj_id player, obj_id npc)
{
	setInvulnerable (npc, false);
	clearCondition (npc, CONDITION_INTERESTING);
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int som_kenobi_pwwoz_pwwa_handleBranch1 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You will not escape my wrath, %TU!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: If you think you can take me. Let's do this!
	if (response == "s_84")
	{
		som_kenobi_pwwoz_pwwa_action_removeInvuln2 (player, npc);

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			som_kenobi_pwwoz_pwwa_action_secondAttack (player, npc);

			//-- NPC: Prepare yourself! I will not be denied.
			string_id message = new string_id (c_stringFile, "s_85");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch4 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, I'm still alive, friend. The Mustafarians managed to save me despite the serious injuries. Don't worry, I hold no grudge. You did what you had to do. I think that crystal was taking me over. It was evil.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm glad you are okay, Pwwoz, and I'm sorry for what I had to do.
	if (response == "s_227")
	{
		doAnimationAction (player, "hug_tandem");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_no");

			//-- NPC: As I said, you did what you had to do, my friend. No worries at all.
			string_id message = new string_id (c_stringFile, "s_229");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Thank you and take care of yourself, Pwwoz.
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Last I saw you, you kept talking about some ghost?
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_230");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_231");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 5);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I must be getting sloppy...thought you were dead for sure.
	if (response == "s_228")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "belly_laugh");

			//-- NPC: Yes, well, lucky for me. I'm tougher than I look.
			string_id message = new string_id (c_stringFile, "s_237");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yes, lucky indeed. Well, stay out of trouble.
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: What was that ghost thing you kept talking about, by the way?
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_238");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_239");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 9);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch5 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: As I said, you did what you had to do, my friend. No worries at all.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Thank you and take care of yourself, Pwwoz.
	if (response == "s_230")
	{
		doAnimationAction (player, "goodbye");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "bow");

			doAnimationAction (player, "goodbye");

			//-- NPC: You too, my friend. Be careful out there.
			string_id message = new string_id (c_stringFile, "s_236");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Last I saw you, you kept talking about some ghost?
	if (response == "s_231")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "rub_chin_thoughtful");

			//-- NPC: Yes, I have a vague memory of that. One night in the wild, after I had found the crystal but before I lost it, I could have sworn that a spirit came to me. He looked like an old human. He appeared troubled but I could feel that he possessed great wisdom. He urged me to throw the crystal into the lava, but in my crazed state, I ignored him.
			string_id message = new string_id (c_stringFile, "s_232");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Very interesting. Well, take care of yourself, Pwwoz.
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_233");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 7);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch7 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, I have a vague memory of that. One night in the wild, after I had found the crystal but before I lost it, I could have sworn that a spirit came to me. He looked like an old human. He appeared troubled but I could feel that he possessed great wisdom. He urged me to throw the crystal into the lava, but in my crazed state, I ignored him.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Very interesting. Well, take care of yourself, Pwwoz.
	if (response == "s_233")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "bow");

			doAnimationAction (player, "goodbye");

			//-- NPC: You too, my friend. Be careful out there.
			string_id message = new string_id (c_stringFile, "s_234");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch9 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, well, lucky for me. I'm tougher than I look.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, lucky indeed. Well, stay out of trouble.
	if (response == "s_238")
	{
		doAnimationAction (player, "goodbye");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			//-- NPC: You too, friend. Be careful out there.
			string_id message = new string_id (c_stringFile, "s_240");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What was that ghost thing you kept talking about, by the way?
	if (response == "s_239")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "rub_chin_thoughtful");

			//-- NPC: Hmm, oh yes, I remember that vaguely. One night in the wild, after I had found the crystal but before I lost it, I could have sworn that a spirit came to me. He looked like an old human. He appeared troubled but I could feel that he possessed great wisdom. He urged me to throw the crystal into the lava, but in my crazed state, I ignored him.
			string_id message = new string_id (c_stringFile, "s_242");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Strange. Well, stay out of trouble.
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_244");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 11);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch11 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Hmm, oh yes, I remember that vaguely. One night in the wild, after I had found the crystal but before I lost it, I could have sworn that a spirit came to me. He looked like an old human. He appeared troubled but I could feel that he possessed great wisdom. He urged me to throw the crystal into the lava, but in my crazed state, I ignored him.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Strange. Well, stay out of trouble.
	if (response == "s_244")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "bow");

			doAnimationAction (player, "goodbye");

			//-- NPC: You too, friend. Be careful out there.
			string_id message = new string_id (c_stringFile, "s_246");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch13 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You are back! Where is it?! Give it to me!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You seem a little obsessed. Are you sure it's healthy for you?
	if (response == "s_174")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "stamp_feet");

			//-- NPC: You just want it for yourself! Now give it to me. Don't you want that reward?!
			string_id message = new string_id (c_stringFile, "s_178");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Fine, as you wish. Here you go.
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No, I'm sorry. I can't have that on my conscience.
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			//-- PLAYER: [Use the Force] You don't really want it. I should keep it.
			boolean hasResponse2 = false;
			if (som_kenobi_pwwoz_pwwa_condition_playerJedi (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse2 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_179");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_180");

				if (hasResponse2)
					responses [responseIndex++] = new string_id (c_stringFile, "s_181");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 14);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm sorry, friend. I couldn't find it. Maybe it's for the best...
	if (response == "s_175")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "gesticulate_wildly");

			//-- NPC: What?! I know you have it! You're lying to me and want to keep it yourself! Give it to me now!
			string_id message = new string_id (c_stringFile, "s_187");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Fine, as you wish. Here you go.
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: As I said, I don't have it. I'm sorry, Pwwoz.
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			//-- PLAYER: [Use the Force] I don't have it. You should give up now.
			boolean hasResponse2 = false;
			if (som_kenobi_pwwoz_pwwa_condition_playerJedi (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse2 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_189");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_191");

				if (hasResponse2)
					responses [responseIndex++] = new string_id (c_stringFile, "s_193");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 18);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yeah, yeah. Calm down! There was talk of a reward?
	if (response == "s_176")
	{
		doAnimationAction (player, "slow_down");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "squirm");

			//-- NPC: Yes, of course! But first, the crystal. Now!
			string_id message = new string_id (c_stringFile, "s_205");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Fine, but you better have my reward ready!
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't think there's a reward at all. I will just keep this.
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			//-- PLAYER: [Use the Force] You should show me the reward first.
			boolean hasResponse2 = false;
			if (som_kenobi_pwwoz_pwwa_condition_playerJedi (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse2 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_206");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_207");

				if (hasResponse2)
					responses [responseIndex++] = new string_id (c_stringFile, "s_208");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 20);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I didn't find the darn thing and I'm tired of this.
	if (response == "s_177")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			//-- NPC: What?! I know you're lying. You have it on you. I can feel it! Now give it to me!
			string_id message = new string_id (c_stringFile, "s_212");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Fine, but you better have my reward ready!
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't think there's a reward at all. I will just keep this.
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			//-- PLAYER: [Use the Force] You should show me the reward first.
			boolean hasResponse2 = false;
			if (som_kenobi_pwwoz_pwwa_condition_playerJedi (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse2 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_214");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_216");

				if (hasResponse2)
					responses [responseIndex++] = new string_id (c_stringFile, "s_218");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 22);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You just want it for yourself! Now give it to me. Don't you want that reward?!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Fine, as you wish. Here you go.
	if (response == "s_179")
	{
		doAnimationAction (player, "sigh_deeply");

		som_kenobi_pwwoz_pwwa_action_removeInvuln (player, npc);

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "heavy_cough_vomit");

			som_kenobi_pwwoz_pwwa_action_attack (player, npc);

			//-- NPC: Yes, yes! Finally it's mine! I will show that ghost how wrong he was. All the power will be mine! < Pwwoz takes the crystal in his hand, kneels down, and smashes it on the ground, laughing hysterically > Hahaha, he's all mine now! And for you, foolish mortal, kneel and accept your reward!
			string_id message = new string_id (c_stringFile, "s_186");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No, I'm sorry. I can't have that on my conscience.
	if (response == "s_180")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_accusingly");

			som_kenobi_pwwoz_pwwa_action_signalKeep (player, npc);

			//-- NPC: You, you bastard! It's that ghost telling you to give it to him instead, isn't it?! I will get my revenge. Mark my words!
			string_id message = new string_id (c_stringFile, "s_185");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: [Use the Force] You don't really want it. I should keep it.
	if (response == "s_181")
	{
		doAnimationAction (player, "wave_finger_warning");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "twitch");

			//-- NPC: I... I don't really want...yes, yes I do! What are you doing to me?! Hand me the crystal. Now!
			string_id message = new string_id (c_stringFile, "s_182");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Fine, as you wish. Here you go.
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No, I'm sorry. I can't have that on my conscience.
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_183");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_184");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I... I don't really want...yes, yes I do! What are you doing to me?! Hand me the crystal. Now!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Fine, as you wish. Here you go.
	if (response == "s_183")
	{
		doAnimationAction (player, "sigh_deeply");

		som_kenobi_pwwoz_pwwa_action_removeInvuln (player, npc);

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "heavy_cough_vomit");

			som_kenobi_pwwoz_pwwa_action_attack (player, npc);

			//-- NPC: Yes, yes! Finally it's mine! I will show that ghost how wrong he was. All the power will be mine! < Pwwoz takes the crystal in his hand, kneels down, and smashes it on the ground, laughing hysterically > Hahaha, he's all mine now! And for you, foolish mortal, kneel and accept your reward!
			string_id message = new string_id (c_stringFile, "s_186");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No, I'm sorry. I can't have that on my conscience.
	if (response == "s_184")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_accusingly");

			som_kenobi_pwwoz_pwwa_action_signalKeep (player, npc);

			//-- NPC: You, you bastard! It's that ghost telling you to give it to him instead, isn't it?! I will get my revenge. Mark my words!
			string_id message = new string_id (c_stringFile, "s_185");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch18 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: What?! I know you have it! You're lying to me and want to keep it yourself! Give it to me now!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Fine, as you wish. Here you go.
	if (response == "s_189")
	{
		doAnimationAction (player, "sigh_deeply");

		som_kenobi_pwwoz_pwwa_action_removeInvuln (player, npc);

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "heavy_cough_vomit");

			som_kenobi_pwwoz_pwwa_action_attack (player, npc);

			//-- NPC: Yes, yes! Finally it's mine! I will show that ghost how wrong he was. All the power will be mine! < Pwwoz takes the crystal in his hand, kneels down, and smashes it on the ground, laughing hysterically > Hahaha, he's all mine now! And for you, foolish mortal, kneel and accept your reward!
			string_id message = new string_id (c_stringFile, "s_186");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: As I said, I don't have it. I'm sorry, Pwwoz.
	if (response == "s_191")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_accusingly");

			som_kenobi_pwwoz_pwwa_action_signalKeep (player, npc);

			//-- NPC: You, you bastard! It's that ghost telling you to give it to him instead, isn't it?! I will get my revenge. Mark my words!
			string_id message = new string_id (c_stringFile, "s_185");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: [Use the Force] I don't have it. You should give up now.
	if (response == "s_193")
	{
		doAnimationAction (player, "wave_finger_warning");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "twitch");

			som_kenobi_pwwoz_pwwa_action_signalKeep (player, npc);

			//-- NPC: You don't ha...have it... No! I know you do! You are trying to trick me! It's that ghost telling you to give it to him, isn't it?! You demon! I will have my revenge. Mark my words!
			string_id message = new string_id (c_stringFile, "s_195");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, of course! But first, the crystal. Now!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Fine, but you better have my reward ready!
	if (response == "s_206")
	{
		doAnimationAction (player, "sigh_deeply");

		som_kenobi_pwwoz_pwwa_action_removeInvuln (player, npc);

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "heavy_cough_vomit");

			som_kenobi_pwwoz_pwwa_action_attack (player, npc);

			//-- NPC: Yes, yes! Finally it's mine! I will show that ghost how wrong he was. All the power will be mine! < Pwwoz takes the crystal in his hand, kneels down, and smashes it on the ground, laughing hysterically > Hahaha, he's all mine now! And for you, foolish mortal, kneel and accept your reward!
			string_id message = new string_id (c_stringFile, "s_186");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't think there's a reward at all. I will just keep this.
	if (response == "s_207")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_accusingly");

			som_kenobi_pwwoz_pwwa_action_signalKeep (player, npc);

			//-- NPC: You, you bastard! It's that ghost telling you to give it to him instead, isn't it?! I will get my revenge. Mark my words!
			string_id message = new string_id (c_stringFile, "s_185");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: [Use the Force] You should show me the reward first.
	if (response == "s_208")
	{
		doAnimationAction (player, "wave_finger_warning");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_disgust");

			//-- NPC: I... I should show...no, there is no reward, you fool! Just give me the blasted thing!
			string_id message = new string_id (c_stringFile, "s_209");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: As I thought: no reward, no crystal. I'm keeping it.
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Yeah, whatever. I don't want it anyway.
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_210");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_211");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 21);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch21 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I... I should show...no, there is no reward, you fool! Just give me the blasted thing!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: As I thought: no reward, no crystal. I'm keeping it.
	if (response == "s_210")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_accusingly");

			som_kenobi_pwwoz_pwwa_action_signalKeep (player, npc);

			//-- NPC: You, you bastard! It's that ghost telling you to give it to him instead, isn't it?! I will get my revenge. Mark my words!
			string_id message = new string_id (c_stringFile, "s_185");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yeah, whatever. I don't want it anyway.
	if (response == "s_211")
	{
		doAnimationAction (player, "sigh_deeply");

		som_kenobi_pwwoz_pwwa_action_removeInvuln (player, npc);

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "heavy_cough_vomit");

			som_kenobi_pwwoz_pwwa_action_attack (player, npc);

			//-- NPC: Yes, yes! Finally it's mine! I will show that ghost how wrong he was. All the power will be mine! < Pwwoz takes the crystal in his hand, kneels down, and smashes it on the ground, laughing hysterically > Hahaha, he's all mine now! And for you, foolish mortal, kneel and accept your reward!
			string_id message = new string_id (c_stringFile, "s_186");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch22 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: What?! I know you're lying. You have it on you. I can feel it! Now give it to me!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Fine, but you better have my reward ready!
	if (response == "s_214")
	{
		doAnimationAction (player, "sigh_deeply");

		som_kenobi_pwwoz_pwwa_action_removeInvuln (player, npc);

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "heavy_cough_vomit");

			som_kenobi_pwwoz_pwwa_action_attack (player, npc);

			//-- NPC: Yes, yes! Finally it's mine! I will show that ghost how wrong he was. All the power will be mine! < Pwwoz takes the crystal in his hand, kneels down, and smashes it on the ground, laughing hysterically > Hahaha, he's all mine now! And for you, foolish mortal, kneel and accept your reward!
			string_id message = new string_id (c_stringFile, "s_186");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't think there's a reward at all. I will just keep this.
	if (response == "s_216")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_accusingly");

			som_kenobi_pwwoz_pwwa_action_signalKeep (player, npc);

			//-- NPC: You, you bastard! It's that ghost telling you to give it to him instead, isn't it?! I will get my revenge. Mark my words!
			string_id message = new string_id (c_stringFile, "s_185");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: [Use the Force] You should show me the reward first.
	if (response == "s_218")
	{
		doAnimationAction (player, "wave_finger_warning");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shake_head_disgust");

			//-- NPC: I... I should show...no, there is no reward, you fool! Just give me the blasted thing!
			string_id message = new string_id (c_stringFile, "s_220");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: As I thought: no reward, no crystal. I'm keeping it.
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Yeah, whatever. I don't want it anyway.
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_222");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_224");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 23);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch23 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: I... I should show...no, there is no reward, you fool! Just give me the blasted thing!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: As I thought: no reward, no crystal. I'm keeping it.
	if (response == "s_222")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "point_accusingly");

			som_kenobi_pwwoz_pwwa_action_signalKeep (player, npc);

			//-- NPC: You, you bastard! It's that ghost telling you to give it to him instead, isn't it?! I will get my revenge. Mark my words!
			string_id message = new string_id (c_stringFile, "s_185");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yeah, whatever. I don't want it anyway.
	if (response == "s_224")
	{
		doAnimationAction (player, "sigh_deeply");

		som_kenobi_pwwoz_pwwa_action_removeInvuln (player, npc);

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "heavy_cough_vomit");

			som_kenobi_pwwoz_pwwa_action_attack (player, npc);

			//-- NPC: Yes, yes! Finally it's mine! I will show that ghost how wrong he was. All the power will be mine! < Pwwoz takes the crystal in his hand, kneels down, and smashes it on the ground, laughing hysterically > Hahaha, he's all mine now! And for you, foolish mortal, kneel and accept your reward!
			string_id message = new string_id (c_stringFile, "s_186");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch25 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Greetings, friend. I am Pwwoz Pwwa, geologist and ambassador for the Ithorian people on Mustafar. I'm looking for someone to assist me in a most important matter. Maybe you are this someone?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I have some time to spare. How may I assist?
	if (response == "s_111")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			//-- NPC: Good, good. My predicament is this. About a week ago, when I was out taking soil samples, I came across a little strange trinket. On that night, as I was sleeping out in the wild, I awoke to lava fleas rummaging through my belongings. I chased them off but afterwards noticed that the little trinket was gone.
			string_id message = new string_id (c_stringFile, "s_115");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: You think the lava fleas took it? Sounds unlikely...
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_116");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 26);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How am I supposed to know? What is it you need help with?
	if (response == "s_112")
	{
		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			//-- NPC: Oh, let me get right to the point. About a week ago, when I was out taking soil samples, I came across a little strange trinket. On that night, as I was sleeping out in the wild, I awoke to lava fleas rummaging through my belongings. I chased them off but afterwards noticed that the little trinket was gone.
			string_id message = new string_id (c_stringFile, "s_151");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: You're not going to tell me the fleas took it?
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_153");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 32);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm a bit busy at the moment, sorry.
	if (response == "s_113")
	{
		doAnimationAction (player, "shakefist");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "bow");

			//-- NPC: Bah! What could be more...ex.. excuse me, where's my manners. Have a nice day.
			string_id message = new string_id (c_stringFile, "s_114");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch26 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Good, good. My predicament is this. About a week ago, when I was out taking soil samples, I came across a little strange trinket. On that night, as I was sleeping out in the wild, I awoke to lava fleas rummaging through my belongings. I chased them off but afterwards noticed that the little trinket was gone.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You think the lava fleas took it? Sounds unlikely...
	if (response == "s_116")
	{
		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod");

			//-- NPC: The only explanation I can think of is that one of them swallowed it while going through my belongings. I've been out hunting them for days in that area now, but I've had no luck. Violence is difficult for me and I'm not a hunter. It's my hope that you can do better.
			string_id message = new string_id (c_stringFile, "s_117");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Perhaps. What is the trinket? What does it look like?
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_118");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 27);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch27 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The only explanation I can think of is that one of them swallowed it while going through my belongings. I've been out hunting them for days in that area now, but I've had no luck. Violence is difficult for me and I'm not a hunter. It's my hope that you can do better.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Perhaps. What is the trinket? What does it look like?
	if (response == "s_118")
	{
		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shrug_hands");

			//-- NPC: Oh, it's just a small red crystal.
			string_id message = new string_id (c_stringFile, "s_119");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: And you're going through all this trouble for a piece of crystal?
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_120");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 28);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch28 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Oh, it's just a small red crystal.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: And you're going through all this trouble for a piece of crystal?
	if (response == "s_120")
	{
		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "implore");

			//-- NPC: It is very dear to me. I don't want to lose it, ever! Please help me find it. I beg of you. I will pay a reward...everything I have!
			string_id message = new string_id (c_stringFile, "s_121");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Calm down, I'll do it. Where did you lose it?
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: Settle down, friend. I'm afraid I can't right now.
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_122");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_123");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 29);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch29 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It is very dear to me. I don't want to lose it, ever! Please help me find it. I beg of you. I will pay a reward...everything I have!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Calm down, I'll do it. Where did you lose it?
	if (response == "s_122")
	{
		doAnimationAction (player, "slow_down");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "offer_affection");

			som_kenobi_pwwoz_pwwa_action_giveQuest1 (player, npc);

			//-- NPC: Thank you, thank you! Let me mark down the location in your datapad. There, now please hurry!
			string_id message = new string_id (c_stringFile, "s_124");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Settle down, friend. I'm afraid I can't right now.
	if (response == "s_123")
	{
		doAnimationAction (player, "slow_down");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "stamp_feet");

			doAnimationAction (player, "taken_aback");

			//-- NPC: But you must! I need it back. Don't you understand?! Come back here! You will do this for me!
			string_id message = new string_id (c_stringFile, "s_125");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch32 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Oh, let me get right to the point. About a week ago, when I was out taking soil samples, I came across a little strange trinket. On that night, as I was sleeping out in the wild, I awoke to lava fleas rummaging through my belongings. I chased them off but afterwards noticed that the little trinket was gone.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You're not going to tell me the fleas took it?
	if (response == "s_153")
	{
		doAnimationAction (player, "laugh");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod");

			//-- NPC: The only explanation I can think of is that one of them swallowed it while going through my belongings. I've been out hunting them for days in that area now, but I've had no luck. Violence is difficult for me and I'm not a hunter. It's my hope that you can do better.
			string_id message = new string_id (c_stringFile, "s_155");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Oh, I can guarantee that. Now what is this thing I need to find?
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_157");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 33);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch33 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: The only explanation I can think of is that one of them swallowed it while going through my belongings. I've been out hunting them for days in that area now, but I've had no luck. Violence is difficult for me and I'm not a hunter. It's my hope that you can do better.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Oh, I can guarantee that. Now what is this thing I need to find?
	if (response == "s_157")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shrug_hands");

			//-- NPC: Oh, it's just a small red crystal.
			string_id message = new string_id (c_stringFile, "s_159");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What? Crystals are everywhere. Just go buy one from a Mustafarian!
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_161");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 34);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch34 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Oh, it's just a small red crystal.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What? Crystals are everywhere. Just go buy one from a Mustafarian!
	if (response == "s_161")
	{
		doAnimationAction (player, "wtf");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "implore");

			//-- NPC: No, it has to be this one! It is very dear to me. I don't want to lose it, ever! Please help me find it. I beg of you. I will pay a reward...everything I have!
			string_id message = new string_id (c_stringFile, "s_163");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Gee, calm down. I'll do it! Where did you lose it?
			boolean hasResponse0 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't have time for this nonsense!
			boolean hasResponse1 = false;
			if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_165");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_169");

				utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 35);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int som_kenobi_pwwoz_pwwa_handleBranch35 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: No, it has to be this one! It is very dear to me. I don't want to lose it, ever! Please help me find it. I beg of you. I will pay a reward...everything I have!

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Gee, calm down. I'll do it! Where did you lose it?
	if (response == "s_165")
	{
		doAnimationAction (player, "slow_down");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "offer_affection");

			doAnimationAction (player, "refuse_offer_affection");

			som_kenobi_pwwoz_pwwa_action_giveQuest1 (player, npc);

			//-- NPC: Thank you, thank you! Let me mark down the location in your datapad. There, now please hurry!
			string_id message = new string_id (c_stringFile, "s_167");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't have time for this nonsense!
	if (response == "s_169")
	{
		doAnimationAction (player, "shake_head_disgust");

		//-- [NOTE] 
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "stamp_feet");

			doAnimationAction (player, "cuckoo");

			//-- NPC: But you must! I need it back. Don't you understand?! Come back here! You will do this for me!
			string_id message = new string_id (c_stringFile, "s_171");
			utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.som_kenobi_pwwoz_pwwa");

	ai_lib.setMood (self, "nervous");
	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	ai_lib.setMood (self, "nervous");
	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);
	setInvulnerable (self, true);
	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.som_kenobi_pwwoz_pwwa");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (som_kenobi_pwwoz_pwwa_condition_killPwwoz (player, npc))
	{
		//-- NPC: You will not escape my wrath, %TU!
		string_id message = new string_id (c_stringFile, "s_82");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: If you think you can take me. Let's do this!
		boolean hasResponse0 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_84");

			utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 1);

			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			npcStartConversation (player, npc, "som_kenobi_pwwoz_pwwa", null, pp, responses);
		}
		else
		{
			prose_package pp = new prose_package ();
			pp.stringId = message;
			pp.actor.set (player);
			pp.target.set (npc);

			chat.chat (npc, player, null, null, pp);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_pwwoz_pwwa_condition_keptCrystal (player, npc))
	{
		doAnimationAction (npc, "point_accusingly");

		doAnimationAction (player, "sigh_deeply");

		//-- NPC: You! You better watch where you are going, thief! One day, when you least expect it, I will get my crystal back!
		string_id message = new string_id (c_stringFile, "s_225");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_pwwoz_pwwa_condition_gaveCrystal (player, npc))
	{
		doAnimationAction (npc, "bow");

		//-- NPC: Yes, I'm still alive, friend. The Mustafarians managed to save me despite the serious injuries. Don't worry, I hold no grudge. You did what you had to do. I think that crystal was taking me over. It was evil.
		string_id message = new string_id (c_stringFile, "s_226");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I'm glad you are okay, Pwwoz, and I'm sorry for what I had to do.
		boolean hasResponse0 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I must be getting sloppy...thought you were dead for sure.
		boolean hasResponse1 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_227");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_228");

			utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 4);

			npcStartConversation (player, npc, "som_kenobi_pwwoz_pwwa", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_pwwoz_pwwa_condition_foundCrystal (player, npc))
	{
		doAnimationAction (npc, "celebrate");

		doAnimationAction (player, "greet");

		//-- NPC: You are back! Where is it?! Give it to me!
		string_id message = new string_id (c_stringFile, "s_173");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: You seem a little obsessed. Are you sure it's healthy for you?
		boolean hasResponse0 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: I'm sorry, friend. I couldn't find it. Maybe it's for the best...
		boolean hasResponse1 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: Yeah, yeah. Calm down! There was talk of a reward?
		boolean hasResponse2 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		//-- PLAYER: I didn't find the darn thing and I'm tired of this.
		boolean hasResponse3 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse3 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_174");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_175");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_176");

			if (hasResponse3)
				responses [responseIndex++] = new string_id (c_stringFile, "s_177");

			utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 13);

			npcStartConversation (player, npc, "som_kenobi_pwwoz_pwwa", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_pwwoz_pwwa_condition_onQuest (player, npc))
	{
		doAnimationAction (npc, "stamp_feet");

		//-- NPC: What are you doing back here?! You need to find that crystal. Now!
		string_id message = new string_id (c_stringFile, "s_172");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
	{
		doAnimationAction (npc, "bow");

		doAnimationAction (player, "greet");

		//-- NPC: Greetings, friend. I am Pwwoz Pwwa, geologist and ambassador for the Ithorian people on Mustafar. I'm looking for someone to assist me in a most important matter. Maybe you are this someone?
		string_id message = new string_id (c_stringFile, "s_110");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I have some time to spare. How may I assist?
		boolean hasResponse0 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: How am I supposed to know? What is it you need help with?
		boolean hasResponse1 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		//-- PLAYER: I'm a bit busy at the moment, sorry.
		boolean hasResponse2 = false;
		if (som_kenobi_pwwoz_pwwa_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse2 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_111");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_112");

			if (hasResponse2)
				responses [responseIndex++] = new string_id (c_stringFile, "s_113");

			utils.setScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId", 25);

			npcStartConversation (player, npc, "som_kenobi_pwwoz_pwwa", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "som_kenobi_pwwoz_pwwa")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

	if (branchId == 1 && som_kenobi_pwwoz_pwwa_handleBranch1 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 4 && som_kenobi_pwwoz_pwwa_handleBranch4 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 5 && som_kenobi_pwwoz_pwwa_handleBranch5 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 7 && som_kenobi_pwwoz_pwwa_handleBranch7 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 9 && som_kenobi_pwwoz_pwwa_handleBranch9 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 11 && som_kenobi_pwwoz_pwwa_handleBranch11 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 13 && som_kenobi_pwwoz_pwwa_handleBranch13 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && som_kenobi_pwwoz_pwwa_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && som_kenobi_pwwoz_pwwa_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 18 && som_kenobi_pwwoz_pwwa_handleBranch18 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && som_kenobi_pwwoz_pwwa_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 21 && som_kenobi_pwwoz_pwwa_handleBranch21 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 22 && som_kenobi_pwwoz_pwwa_handleBranch22 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 23 && som_kenobi_pwwoz_pwwa_handleBranch23 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 25 && som_kenobi_pwwoz_pwwa_handleBranch25 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 26 && som_kenobi_pwwoz_pwwa_handleBranch26 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 27 && som_kenobi_pwwoz_pwwa_handleBranch27 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 28 && som_kenobi_pwwoz_pwwa_handleBranch28 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 29 && som_kenobi_pwwoz_pwwa_handleBranch29 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 32 && som_kenobi_pwwoz_pwwa_handleBranch32 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 33 && som_kenobi_pwwoz_pwwa_handleBranch33 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 34 && som_kenobi_pwwoz_pwwa_handleBranch34 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 35 && som_kenobi_pwwoz_pwwa_handleBranch35 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.som_kenobi_pwwoz_pwwa.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

