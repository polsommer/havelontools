// ======================================================================
//
// story_arc_prelude_chivos.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.35 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.chat;
include library.groundquests;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/story_arc_prelude_chivos";

// ======================================================================
// Script Conditions
// ======================================================================

boolean story_arc_prelude_chivos_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean story_arc_prelude_chivos_condition_isOnMissionOne (obj_id player, obj_id npc)
{
	if (groundquests.isQuestActive(player, "som_story_arc_prelude_01") || groundquests.isQuestActive(player, "som_story_arc_prelude_02"))
		return true;
	else
		return false;
}

// ----------------------------------------------------------------------

boolean story_arc_prelude_chivos_condition_hasCleanedVents (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "som_story_arc_prelude_02", "mustafar_air_filter_five");
}

// ----------------------------------------------------------------------

boolean story_arc_prelude_chivos_condition_hasWonVentMission (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "som_story_arc_prelude_02");
}

// ----------------------------------------------------------------------

boolean story_arc_prelude_chivos_condition_isOnMissionTwo (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "som_story_arc_prelude_03");
}

// ----------------------------------------------------------------------

boolean story_arc_prelude_chivos_condition_hasCollectedRods (obj_id player, obj_id npc)
{
	return groundquests.isTaskActive(player, "som_story_arc_prelude_03", "mustafar_rod_four");
}

// ----------------------------------------------------------------------

boolean story_arc_prelude_chivos_condition_hasWonAllMissions (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "som_story_arc_prelude_03");
}

// ----------------------------------------------------------------------

boolean story_arc_prelude_chivos_condition_hasCompletedSupply (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "som_story_arc_prelude_01");
}

// ======================================================================
// Script Actions
// ======================================================================

void story_arc_prelude_chivos_action_grantMissionOne (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "som_story_arc_prelude_01");
}

// ----------------------------------------------------------------------

void story_arc_prelude_chivos_action_grantVentReward (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "mustafar_air_filter_reward");
}

// ----------------------------------------------------------------------

void story_arc_prelude_chivos_action_grantMissionTwo (obj_id player, obj_id npc)
{
	groundquests.grantQuest(player, "som_story_arc_prelude_03");
}

// ----------------------------------------------------------------------

void story_arc_prelude_chivos_action_grantRodReward (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "mustafar_rod_reward");
}

// ----------------------------------------------------------------------

void story_arc_prelude_chivos_action_grantVentQuest (obj_id player, obj_id npc)
{
	if(!groundquests.isQuestActive(player, "som_story_arc_prelude_02"))
	{
		groundquests.grantQuest(player, "som_story_arc_prelude_02");
	}
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int story_arc_prelude_chivos_handleBranch2 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Do you have the power rods for me?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, here they are.
	if (response == "s_28")
	{
		doAnimationAction (player, "manipulate_medium");

		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "thank");

			story_arc_prelude_chivos_action_grantRodReward (player, npc);

			//-- NPC: You did a great job. As promised, here is your payment for saving us all. I knew you were going places when we first talked...Milo Mensix wants to talk to you.
			string_id message = new string_id (c_stringFile, "s_29");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Who is Milo Mensix?
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_84");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 3);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch3 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You did a great job. As promised, here is your payment for saving us all. I knew you were going places when we first talked...Milo Mensix wants to talk to you.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Who is Milo Mensix?
	if (response == "s_84")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "taken_aback");

			//-- NPC: Only the head of Mensix Corp. If he wants to see you, it is about something big. You should go see him right away. Thanks again for coming through.
			string_id message = new string_id (c_stringFile, "s_85");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch5 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Did you manage to get all of my power rods yet?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Not yet. I am still working on getting them.
	if (response == "s_25")
	{
		doAnimationAction (player, "shake_head_no");

		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			//-- NPC: Ok, keep up the good work.
			string_id message = new string_id (c_stringFile, "s_26");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch7 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: So, are you interested in working freelance for us yet?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yeah, I can use the work now.
	if (response == "s_21")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "sweat");

			//-- NPC: Whew! I am glad you said that because we have a major problem that needs to be solved immediately. The way you took care of the other jobs makes me sure that you are just the person we need.
			string_id message = new string_id (c_stringFile, "s_36");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What is the job?
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_69");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 11);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Nope, I will come back later.
	if (response == "s_22")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			//-- NPC: Have it your way. See you around.
			string_id message = new string_id (c_stringFile, "s_24");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch9 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Miners restocked...check. Vents nice and clean...check. Good work out there. I knew you were the type of person to get things done. Mensix has need of good people like you. Granted, our company bylaws forbid us to officially hire anyone who isn't a Mustafarian, but we do occasionally hire freelancers.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What does being hired as a freelancer mean?
	if (response == "s_30")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			story_arc_prelude_chivos_action_grantVentReward (player, npc);

			//-- NPC: Just what it implies. When we have issues that need to get done but no one on staff who can do them, we call in one of our freelancers to get it done. We pay per job and usually the compensation is well worth the effort. Would you be interested in something like that?
			string_id message = new string_id (c_stringFile, "s_32");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yeah, I could use the occasional work.
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No, I am sorry but I can't.
			boolean hasResponse1 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_34");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_83");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 10);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch10 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Just what it implies. When we have issues that need to get done but no one on staff who can do them, we call in one of our freelancers to get it done. We pay per job and usually the compensation is well worth the effort. Would you be interested in something like that?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yeah, I could use the occasional work.
	if (response == "s_34")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "sweat");

			//-- NPC: Whew! I am glad you said that because we have a major problem that needs to be solved immediately. The way you took care of the other jobs makes me sure that you are just the person we need.
			string_id message = new string_id (c_stringFile, "s_36");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What is the job?
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_69");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 11);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No, I am sorry but I can't.
	if (response == "s_83")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			//-- NPC: Ok, if you change your mind, come and talk to me. I promise you...we will make it worth your while.
			string_id message = new string_id (c_stringFile, "s_124");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch11 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Whew! I am glad you said that because we have a major problem that needs to be solved immediately. The way you took care of the other jobs makes me sure that you are just the person we need.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What is the job?
	if (response == "s_69")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: It's our reactor. We have been pushing it way too hard lately trying to fill our latest contract. This facility has been running at close to 200 percent capacity for far too long. Anyways, the reactor's power rods have all but decayed, and we have been shutting down secondary systems in order to keep operating at this pace.
			string_id message = new string_id (c_stringFile, "s_70");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: So, that is why your facility is having trouble?
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_71");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 12);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch12 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It's our reactor. We have been pushing it way too hard lately trying to fill our latest contract. This facility has been running at close to 200 percent capacity for far too long. Anyways, the reactor's power rods have all but decayed, and we have been shutting down secondary systems in order to keep operating at this pace.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: So, that is why your facility is having trouble?
	if (response == "s_71")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			//-- NPC: Yeah. We were getting by, but the rods have now decayed to the point where there is a threat that the entire facility will shut down. If that happens, we are in big trouble. We are already behind schedule and if we fall further behind it...well it wouldn't be good.
			string_id message = new string_id (c_stringFile, "s_72");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Get some new rods.
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_73");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 13);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch13 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yeah. We were getting by, but the rods have now decayed to the point where there is a threat that the entire facility will shut down. If that happens, we are in big trouble. We are already behind schedule and if we fall further behind it...well it wouldn't be good.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Get some new rods.
	if (response == "s_73")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shrug_hands");

			//-- NPC: We ordered them. The problem is that this facility was built based off of the old Klegger station, which was built during the days of the Old Republic. No one manufactures power rods for technology that old anymore, so we have to get the rods specially made. By the time the rods get here, we will have already been shut down for too long to make up the difference.
			string_id message = new string_id (c_stringFile, "s_74");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I am not sure how I will be able to help speed that up.
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_75");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 14);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch14 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: We ordered them. The problem is that this facility was built based off of the old Klegger station, which was built during the days of the Old Republic. No one manufactures power rods for technology that old anymore, so we have to get the rods specially made. By the time the rods get here, we will have already been shut down for too long to make up the difference.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I am not sure how I will be able to help speed that up.
	if (response == "s_75")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "standing_placate");

			//-- NPC: You won't have to. A couple of months ago, one of our field crews discovered a wreck on the slopes of the central volcano. This wreck is a large capital cruiser that easily dates back to the Old Republic. We are pretty sure that it used the same power rod system as this facility does. If any of those rods can be found, our engineers are sure they could rig them up to get us through until the new rods can be delivered.
			string_id message = new string_id (c_stringFile, "s_76");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER:  Will those old rods even be any good?
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_77");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 15);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You won't have to. A couple of months ago, one of our field crews discovered a wreck on the slopes of the central volcano. This wreck is a large capital cruiser that easily dates back to the Old Republic. We are pretty sure that it used the same power rod system as this facility does. If any of those rods can be found, our engineers are sure they could rig them up to get us through until the new rods can be delivered.

	//-- [RESPONSE NOTE] 
	//-- PLAYER:  Will those old rods even be any good?
	if (response == "s_77")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_multiple");

			//-- NPC: Hey, they made things to last in the old days. If they are still in their core housing, those power rods will be good virtually forever. As long as they survived the crash, they should have more than enough juice left to suit our purpose. Our engineers say they just need four of those rods to keep us in power. So, what do you say? Will you pull us out of the fire?
			string_id message = new string_id (c_stringFile, "s_78");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: How do I get to this crash site?
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_115");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 16);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch16 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Hey, they made things to last in the old days. If they are still in their core housing, those power rods will be good virtually forever. As long as they survived the crash, they should have more than enough juice left to suit our purpose. Our engineers say they just need four of those rods to keep us in power. So, what do you say? Will you pull us out of the fire?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How do I get to this crash site?
	if (response == "s_115")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: It isn't easy. Like I said, the cruiser was found on the slopes of the central volcano. There is a bridge that connects the volcano to the burning plains, which you will probably have to use unless you have some other way of crossing the lava pools. So how about it?
			string_id message = new string_id (c_stringFile, "s_116");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yeah, I will see if I can find any.
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No, I am sorry, but I just can't right now.
			boolean hasResponse1 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_118");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_122");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It isn't easy. Like I said, the cruiser was found on the slopes of the central volcano. There is a bridge that connects the volcano to the burning plains, which you will probably have to use unless you have some other way of crossing the lava pools. So how about it?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yeah, I will see if I can find any.
	if (response == "s_118")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "rub_chin_thoughtful");

			story_arc_prelude_chivos_action_grantMissionTwo (player, npc);

			//-- NPC: You have not only my thanks but the company's thanks as well. Look around the wreckage of the crash on the slopes of the central volcano. When our crew was there, they reported seeing a bunch of salvage bandits crawling all over the ship, so watch your back. Those Mustafarians don't work for any company and will do anything to make a buck...including shooting anyone they don't know.
			string_id message = new string_id (c_stringFile, "s_120");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No, I am sorry, but I just can't right now.
	if (response == "s_122")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			//-- NPC: Ok, if you change your mind, come and talk to me. I promise you...we will make it worth your while.
			string_id message = new string_id (c_stringFile, "s_124");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Have you finish those tasks I asked you to do?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Not yet.
	if (response == "s_57")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shoo");

			//-- NPC: Ok, you should get back to work then. Come back and talk to me when you are done. Thanks again.
			string_id message = new string_id (c_stringFile, "s_59");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch22 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You shouldn't be back here. I thought I asked you to clean out those air vents which are around the facility.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yeah, where were those vents again?
	if (response == "s_102")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: There are four of them that surround the facility. None of them are very far from here, so you shouldn't have that much trouble finding them. So are you going to take care of this little matter for me now?
			string_id message = new string_id (c_stringFile, "s_103");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Sure, I will clean them right away.
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I need to take care of some other business first.
			boolean hasResponse1 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_104");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_105");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 23);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch23 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: There are four of them that surround the facility. None of them are very far from here, so you shouldn't have that much trouble finding them. So are you going to take care of this little matter for me now?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Sure, I will clean them right away.
	if (response == "s_104")
	{
		doAnimationAction (player, "nod");

		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			story_arc_prelude_chivos_action_grantVentQuest (player, npc);

			//-- NPC: Great. Come back and see me again when you have finished up.
			string_id message = new string_id (c_stringFile, "s_107");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I need to take care of some other business first.
	if (response == "s_105")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			//-- NPC: Fine. I suppose the vents can wait a little bit longer.
			string_id message = new string_id (c_stringFile, "s_106");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch26 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Welcome to Mensix Corp. Is there anything that I can do for you? Or maybe there is something that you can do for me.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What is Mensix Corp?
	if (response == "s_80")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: Mensix is the largest mining corporation on Mustafar. We have been the biggest supplier of raw metals and minerals ever since Klegger Corp went bust just before the end of the Clone Wars. Something happened to their main plant...not sure what, but most of it ended up falling into the lava pool. They just never recovered from that incident and we took over.
			string_id message = new string_id (c_stringFile, "s_87");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What do you mine here?
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_89");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 27);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch27 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Mensix is the largest mining corporation on Mustafar. We have been the biggest supplier of raw metals and minerals ever since Klegger Corp went bust just before the end of the Clone Wars. Something happened to their main plant...not sure what, but most of it ended up falling into the lava pool. They just never recovered from that incident and we took over.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What do you mine here?
	if (response == "s_89")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "explain");

			//-- NPC: Mustafar's unique nature makes it easy for us to extract ore, carbon, and aluminum. Those minerals just bubble right up to the surface. There is a fairly healthy market for these raw materials. For example, we just signed a large contract that will ensure the financial security of Mensix for a long time to come. Hmmm, not sure if that is supposed to be leaked out or not. Oh, well...too late now.
			string_id message = new string_id (c_stringFile, "s_91");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: You mentioned that you needed some help?
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_93");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 28);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch28 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Mustafar's unique nature makes it easy for us to extract ore, carbon, and aluminum. Those minerals just bubble right up to the surface. There is a fairly healthy market for these raw materials. For example, we just signed a large contract that will ensure the financial security of Mensix for a long time to come. Hmmm, not sure if that is supposed to be leaked out or not. Oh, well...too late now.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You mentioned that you needed some help?
	if (response == "s_93")
	{
		doAnimationAction (player, "rub_chin_thoughtful");

		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_multiple");

			//-- NPC: Yes, actually we do. Naturally, we will pay for your services. We have a number of mining crews out in the field looking for new hot spots of minerals. Usually these crews are resupplied at a steady rate by droids. The droids pick up the supplies for the miners, fly out to their base camp, and drop the supplies off. The problem is that the droids haven't been recharging properly and we have been losing them.
			string_id message = new string_id (c_stringFile, "s_95");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Not recharging properly?
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_97");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 29);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch29 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes, actually we do. Naturally, we will pay for your services. We have a number of mining crews out in the field looking for new hot spots of minerals. Usually these crews are resupplied at a steady rate by droids. The droids pick up the supplies for the miners, fly out to their base camp, and drop the supplies off. The problem is that the droids haven't been recharging properly and we have been losing them.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Not recharging properly?
	if (response == "s_97")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "shrug_hands");

			//-- NPC: It has something to do with the amount of power that the reactor is producing. The engineers could explain it better, but the bottom line is we don't have enough charged droids to supply all the miners we have in the field. We also do not have the manpower to resupply the field crews manually, so I have been authorized to hire outside help to restock the base camps. How would you like to be a courier for a while?
			string_id message = new string_id (c_stringFile, "s_99");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: You said you would pay? Sure, I would like a job.
			boolean hasResponse0 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No thanks. I have other things I need to take care of.
			boolean hasResponse1 = false;
			if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_108");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_112");

				utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 30);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int story_arc_prelude_chivos_handleBranch30 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: It has something to do with the amount of power that the reactor is producing. The engineers could explain it better, but the bottom line is we don't have enough charged droids to supply all the miners we have in the field. We also do not have the manpower to resupply the field crews manually, so I have been authorized to hire outside help to restock the base camps. How would you like to be a courier for a while?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: You said you would pay? Sure, I would like a job.
	if (response == "s_108")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "thank");

			story_arc_prelude_chivos_action_grantMissionOne (player, npc);

			//-- NPC: That is great news. Here are the supplies that need to be delivered, and I will put the location of the camp that they need to be delivered to in your datapad. All you need to do is find the supply locker and put the goods directly in there. If you do a good enough job, maybe I will have another job for you. Oh, watch your step out there. Mustafar is not a gentle world, but I guess you could tell that just by looking around.
			string_id message = new string_id (c_stringFile, "s_110");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No thanks. I have other things I need to take care of.
	if (response == "s_112")
	{
		//-- [NOTE] 
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "tap_head");

			//-- NPC: Too bad. I will have to find someone else then. Well, thanks for your time and good luck to you.
			string_id message = new string_id (c_stringFile, "s_114");
			utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.story_arc_prelude_chivos");

	setCondition (self, CONDITION_CONVERSABLE);
	setInvulnerable (self, true);
	setCondition( self, CONDITION_INTERESTING );
	setName (self, "Foreman Chivos");

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setInvulnerable (self, true);
	setCondition( self, CONDITION_INTERESTING );
	setName (self, "Foreman Chivos");

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	setCondition (self, CONDITION_CONVERSABLE);
	faceTo(self, player);

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.story_arc_prelude_chivos");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (story_arc_prelude_chivos_condition_hasWonAllMissions (player, npc))
	{
		//-- NPC: I don't have any more work for you, but the big boss wanted to talk to you about something that was really important.
		string_id message = new string_id (c_stringFile, "s_27");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (story_arc_prelude_chivos_condition_hasCollectedRods (player, npc))
	{
		//-- NPC: Do you have the power rods for me?
		string_id message = new string_id (c_stringFile, "s_5");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yes, here they are.
		boolean hasResponse0 = false;
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_28");

			utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 2);

			npcStartConversation (player, npc, "story_arc_prelude_chivos", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (story_arc_prelude_chivos_condition_isOnMissionTwo (player, npc))
	{
		//-- NPC: Did you manage to get all of my power rods yet?
		string_id message = new string_id (c_stringFile, "s_11");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Not yet. I am still working on getting them.
		boolean hasResponse0 = false;
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_25");

			utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 5);

			npcStartConversation (player, npc, "story_arc_prelude_chivos", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (story_arc_prelude_chivos_condition_hasWonVentMission (player, npc))
	{
		//-- NPC: So, are you interested in working freelance for us yet?
		string_id message = new string_id (c_stringFile, "s_15");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yeah, I can use the work now.
		boolean hasResponse0 = false;
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: Nope, I will come back later.
		boolean hasResponse1 = false;
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_21");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_22");

			utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 7);

			npcStartConversation (player, npc, "story_arc_prelude_chivos", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (story_arc_prelude_chivos_condition_hasCleanedVents (player, npc))
	{
		doAnimationAction (npc, "nod_head_multiple");

		//-- NPC: Miners restocked...check. Vents nice and clean...check. Good work out there. I knew you were the type of person to get things done. Mensix has need of good people like you. Granted, our company bylaws forbid us to officially hire anyone who isn't a Mustafarian, but we do occasionally hire freelancers.
		string_id message = new string_id (c_stringFile, "s_20");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What does being hired as a freelancer mean?
		boolean hasResponse0 = false;
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_30");

			utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 9);

			npcStartConversation (player, npc, "story_arc_prelude_chivos", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (story_arc_prelude_chivos_condition_isOnMissionOne (player, npc))
	{
		//-- NPC: Have you finish those tasks I asked you to do?
		string_id message = new string_id (c_stringFile, "s_55");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Not yet.
		boolean hasResponse0 = false;
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_57");

			utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 20);

			npcStartConversation (player, npc, "story_arc_prelude_chivos", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (story_arc_prelude_chivos_condition_hasCompletedSupply (player, npc))
	{
		doAnimationAction (npc, "taken_aback");

		//-- NPC: You shouldn't be back here. I thought I asked you to clean out those air vents which are around the facility.
		string_id message = new string_id (c_stringFile, "s_101");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yeah, where were those vents again?
		boolean hasResponse0 = false;
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_102");

			utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 22);

			npcStartConversation (player, npc, "story_arc_prelude_chivos", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
	{
		doAnimationAction (npc, "bow4");

		//-- NPC: Welcome to Mensix Corp. Is there anything that I can do for you? Or maybe there is something that you can do for me.
		string_id message = new string_id (c_stringFile, "s_68");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: What is Mensix Corp?
		boolean hasResponse0 = false;
		if (story_arc_prelude_chivos_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_80");

			utils.setScriptVar (player, "conversation.story_arc_prelude_chivos.branchId", 26);

			npcStartConversation (player, npc, "story_arc_prelude_chivos", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "story_arc_prelude_chivos")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

	if (branchId == 2 && story_arc_prelude_chivos_handleBranch2 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 3 && story_arc_prelude_chivos_handleBranch3 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 5 && story_arc_prelude_chivos_handleBranch5 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 7 && story_arc_prelude_chivos_handleBranch7 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 9 && story_arc_prelude_chivos_handleBranch9 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 10 && story_arc_prelude_chivos_handleBranch10 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 11 && story_arc_prelude_chivos_handleBranch11 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 12 && story_arc_prelude_chivos_handleBranch12 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 13 && story_arc_prelude_chivos_handleBranch13 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 14 && story_arc_prelude_chivos_handleBranch14 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && story_arc_prelude_chivos_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 16 && story_arc_prelude_chivos_handleBranch16 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && story_arc_prelude_chivos_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && story_arc_prelude_chivos_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 22 && story_arc_prelude_chivos_handleBranch22 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 23 && story_arc_prelude_chivos_handleBranch23 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 26 && story_arc_prelude_chivos_handleBranch26 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 27 && story_arc_prelude_chivos_handleBranch27 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 28 && story_arc_prelude_chivos_handleBranch28 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 29 && story_arc_prelude_chivos_handleBranch29 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 30 && story_arc_prelude_chivos_handleBranch30 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.story_arc_prelude_chivos.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

