// ======================================================================
//
// naboo_legacy_wilson_tchorshel.script
// Copyright 2004, Sony Online Entertainment
// All Rights Reserved.
//
// Created with SwgConversationEditor 1.36 - DO NOT EDIT THIS AUTO-GENERATED FILE!
//
// ======================================================================

// ======================================================================
// Library Includes
// ======================================================================

include library.ai_lib;
include library.badge;
include library.chat;
include library.content;
include library.groundquests;
include library.space_quest;
include library.utils;

// ======================================================================
// Script Constants
// ======================================================================

string c_stringFile = "conversation/naboo_legacy_wilson_tchorshel";

// ======================================================================
// Script Conditions
// ======================================================================

boolean naboo_legacy_wilson_tchorshel_condition__defaultCondition (obj_id player, obj_id npc)
{
	return true;
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_kickQuestActive_Imp (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "legacy_naboo_kick_imp") ||
	( (groundquests.hasCompletedQuest(player, "legacy_together") || groundquests.hasCompletedQuest(player, "legacy_together_2")) &&
	hasObjVar(player, content.IMPERIAL_PATH_OBJVAR_NAME) );
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_kickQuestActive_Rebel (obj_id player, obj_id npc)
{
	return groundquests.isQuestActive(player, "legacy_naboo_kick_reb") ||
	( (groundquests.hasCompletedQuest(player, "legacy_together") || groundquests.hasCompletedQuest(player, "legacy_together_2")) &&
	hasObjVar(player, content.REBEL_PATH_OBJVAR_NAME) );
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_seekingDroidParts_Rebel (obj_id player, obj_id npc)
{
	return ( !groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_1") ||
	!groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_2") ||
	!groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_3_pt2") ||
	!groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_4") ) &&
	badge.hasBadge (player, "bdg_content_rsf_clearance_7") &&
	hasObjVar(player, content.REBEL_PATH_OBJVAR_NAME);
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_seekingRSFComputerAccess (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "naboo_kadaraa_tipping_the_balance_2") &&
	!badge.hasBadge (player, "bdg_content_rsf_clearance_7");
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_hasAllDroidParts_Rebel (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_1") &&
	groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_2") &&
	groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_3_pt2") &&
	groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_4") &&
	hasObjVar(player, content.REBEL_PATH_OBJVAR_NAME);
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_onPanakaQuest_Rebel (obj_id player, obj_id npc)
{
	return ( groundquests.isQuestActive(player, "naboo_kadaraa_tipping_the_balance_1") ||
	groundquests.hasCompletedQuest(player, "naboo_kadaraa_tipping_the_balance_1") ||
	groundquests.isQuestActive(player, "naboo_kadaraa_tipping_the_balance_2") ) &&
	hasObjVar(player, content.REBEL_PATH_OBJVAR_NAME);
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_onPanakaQuest_Imp (obj_id player, obj_id npc)
{
	return ( groundquests.isQuestActive(player, "naboo_kadaraa_tipping_the_balance_1") ||
	groundquests.hasCompletedQuest(player, "naboo_kadaraa_tipping_the_balance_1") ||
	groundquests.isQuestActive(player, "naboo_kadaraa_tipping_the_balance_2") ) &&
	hasObjVar(player, content.IMPERIAL_PATH_OBJVAR_NAME);
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_hasAllDroidParts_Imp (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_1") &&
	groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_2") &&
	groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_3_pt2") &&
	groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_4") &&
	hasObjVar(player, content.IMPERIAL_PATH_OBJVAR_NAME);
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_seekingDroidParts_Imp (obj_id player, obj_id npc)
{
	return ( !groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_1") ||
	!groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_2") ||
	!groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_3_pt2") ||
	!groundquests.hasCompletedQuest(player, "legacy_naboo_droid_module_4") ) &&
	badge.hasBadge (player, "bdg_content_rsf_clearance_7") &&
	hasObjVar(player, content.IMPERIAL_PATH_OBJVAR_NAME);
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_completedNaboo_Imperial (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "legacy_naboo_imperial_final_reward");
}

// ----------------------------------------------------------------------

boolean naboo_legacy_wilson_tchorshel_condition_completedNaboo_Rebel (obj_id player, obj_id npc)
{
	return groundquests.hasCompletedQuest(player, "legacy_naboo_rebel_final_reward");
}

// ======================================================================
// Script Actions
// ======================================================================

void naboo_legacy_wilson_tchorshel_action_givePointerToCorellia (obj_id player, obj_id npc)
{
	if(!groundquests.isQuestActive(player, "naboo_send_to_lt_jasper") && !groundquests.isQuestActiveOrComplete(player, "corellia_coronet_capitol_problems_missing_shipment_intro"))
	{
		groundquests.grantQuest(player, "naboo_send_to_lt_jasper");
	}
}

// ----------------------------------------------------------------------

void naboo_legacy_wilson_tchorshel_action_grantKadaaraQuest (obj_id player, obj_id npc)
{
	if ( hasObjVar(player, content.IMPERIAL_PATH_OBJVAR_NAME) )
	{
		removeObjVar(player, content.IMPERIAL_PATH_OBJVAR_NAME);
	}
	
	if ( !hasObjVar(player, content.REBEL_PATH_OBJVAR_NAME) )
	{
		setObjVar(player, content.REBEL_PATH_OBJVAR_NAME, true);
	}
	
	groundquests.requestGrantQuest(player, "naboo_kadaraa_tipping_the_balance_1");
	return;
}

// ----------------------------------------------------------------------

void naboo_legacy_wilson_tchorshel_action_grantFinalReward_Rebel (obj_id player, obj_id npc)
{
	if ( hasObjVar(player, content.IMPERIAL_PATH_OBJVAR_NAME) )
	{
		removeObjVar(player, content.IMPERIAL_PATH_OBJVAR_NAME);
	}

	if ( !hasObjVar(player, content.REBEL_PATH_OBJVAR_NAME) )
	{
		setObjVar(player, content.REBEL_PATH_OBJVAR_NAME, true);
	}
	
	groundquests.sendSignal(player, "returnToLegacyContact");
	groundquests.requestGrantQuest(player, "legacy_naboo_rebel_final_reward");
	return;
}

// ----------------------------------------------------------------------

void naboo_legacy_wilson_tchorshel_action_endFindDroidParts (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "returnToImperilOrRebelContact");
}

// ----------------------------------------------------------------------

void naboo_legacy_wilson_tchorshel_action_endGotoKadaara (obj_id player, obj_id npc)
{
	groundquests.sendSignal(player, "naboo_from_tatooine_kick");
}

// ======================================================================
// Script %TO Tokens
// ======================================================================

// ======================================================================
// Script %DI Tokens
// ======================================================================

// ======================================================================
// Script %DF Tokens
// ======================================================================

// ======================================================================
// handleBranch<n> Functions 
// ======================================================================

int naboo_legacy_wilson_tchorshel_handleBranch3 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: You there. I know you're working for the Empire. Have you found the droid AI?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: As a matter of fact, I have.
	if (response == "s_90")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			naboo_legacy_wilson_tchorshel_action_endFindDroidParts (player, npc);

			//-- NPC: Yes. Good. If you would be so kind, please deliver that AI to me. You cannot turn it over to the Empire.
			string_id message = new string_id (c_stringFile, "s_92");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: [hand over the droid AI]
			boolean hasResponse0 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No, I need to think about this a bit more.
			boolean hasResponse1 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_83");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_87");

				utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 7);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: That is none of your concern, sir.
	if (response == "s_91")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			//-- NPC: I see. Well, if you find it, please consider speaking with me about it. That AI must not fall into the hands of the Empire.
			string_id message = new string_id (c_stringFile, "s_93");
			utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch4 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Yes. Good. If you would be so kind, please deliver that AI to me. You cannot turn it over to the Empire.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: [hand over the droid AI]
	if (response == "s_83")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			naboo_legacy_wilson_tchorshel_action_grantFinalReward_Rebel (player, npc);

			//-- NPC: Thank you! You have done the right thing. The galaxy will be free from tyranny, and this seemingly small choice on your part could potentially pave the way.
			string_id message = new string_id (c_stringFile, "s_85");
			utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No, I need to think about this a bit more.
	if (response == "s_87")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			//-- NPC: Tarry not long, my friend, but I trust you'll come to the right conclusion soon enough. I'll be waiting.
			string_id message = new string_id (c_stringFile, "s_89");
			utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch6 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Do you have the droid AI? All four parts of it?

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I do. I have it all.
	if (response == "s_80")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			naboo_legacy_wilson_tchorshel_action_endFindDroidParts (player, npc);

			//-- NPC: Oh, well done. Very well done. Please turn it over to me at once. I must leave this planet and get to our research base immediately.
			string_id message = new string_id (c_stringFile, "s_81");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: [hand over the droid AI]
			boolean hasResponse0 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: No, I need to think about this a bit more.
			boolean hasResponse1 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_83");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_87");

				utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 7);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch7 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Oh, well done. Very well done. Please turn it over to me at once. I must leave this planet and get to our research base immediately.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: [hand over the droid AI]
	if (response == "s_83")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			naboo_legacy_wilson_tchorshel_action_grantFinalReward_Rebel (player, npc);

			//-- NPC: Thank you! You have done the right thing. The galaxy will be free from tyranny, and this seemingly small choice on your part could potentially pave the way.
			string_id message = new string_id (c_stringFile, "s_85");
			utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: No, I need to think about this a bit more.
	if (response == "s_87")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			//-- NPC: Tarry not long, my friend, but I trust you'll come to the right conclusion soon enough. I'll be waiting.
			string_id message = new string_id (c_stringFile, "s_89");
			utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch15 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Listen to me for a minute. I know you think you're doing the right thing, but you're not. The Empire will to terrible things with that droid technology if they get their hands onto it.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes, I think I agree.
	if (response == "s_53")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			//-- NPC: Of course you agree. There's no denying such an obvious truth. Work with me. Help me to stop the Empire from getting yet another weapon with which to destroy innocent people.
			string_id message = new string_id (c_stringFile, "s_55");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: How do I help?
			boolean hasResponse0 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_57");

				utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 16);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: And you won't?
	if (response == "s_59")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			//-- NPC: No, we won't. We are not in the business of attacking civilians. Killing innocent people. The Empire cannot make such a claim as they have already proven their willingness to destroy anyone and anything for any reason.
			string_id message = new string_id (c_stringFile, "s_61");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Maybe you're right.
			boolean hasResponse0 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			//-- PLAYER: I don't believe you.
			boolean hasResponse1 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse1 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_63");

				if (hasResponse1)
					responses [responseIndex++] = new string_id (c_stringFile, "s_69");

				utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 17);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch16 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Of course you agree. There's no denying such an obvious truth. Work with me. Help me to stop the Empire from getting yet another weapon with which to destroy innocent people.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: How do I help?
	if (response == "s_57")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			naboo_legacy_wilson_tchorshel_action_endGotoKadaara (player, npc);

			//-- NPC: There is an old war bunker on the beach near here. Rumor is that experimentation was conducted on Trade Federation droids at this bunker leading up to the Battle of Naboo. Go to that bunker and search for any remnants of those droids or clues as to where to find an example of their AI.
			string_id message = new string_id (c_stringFile, "s_86");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm on my way.
			boolean hasResponse0 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_94");

				utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 22);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch17 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: No, we won't. We are not in the business of attacking civilians. Killing innocent people. The Empire cannot make such a claim as they have already proven their willingness to destroy anyone and anything for any reason.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Maybe you're right.
	if (response == "s_63")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			//-- NPC: Of course I'm right. Work with me. Help me to stop the Empire from getting yet another weapon with which to destroy innocent people.
			string_id message = new string_id (c_stringFile, "s_65");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: What do I do?
			boolean hasResponse0 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_67");

				utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 18);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I don't believe you.
	if (response == "s_69")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			//-- NPC: So be it, but please think on what I've said.
			string_id message = new string_id (c_stringFile, "s_71");
			utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch18 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Of course I'm right. Work with me. Help me to stop the Empire from getting yet another weapon with which to destroy innocent people.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: What do I do?
	if (response == "s_67")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			naboo_legacy_wilson_tchorshel_action_endGotoKadaara (player, npc);

			//-- NPC: There is an old war bunker on the beach near here. Rumor is that experimentation was conducted on Trade Federation droids at this bunker leading up to the Battle of Naboo. Go to that bunker and search for any remnants of those droids or clues as to where to find an example of their AI.
			string_id message = new string_id (c_stringFile, "s_86");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm on my way.
			boolean hasResponse0 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_94");

				utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 22);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch20 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: Over here, but keep your voice low. 

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Carh'la Bastra sent me to you.
	if (response == "s_76")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			doAnimationAction (npc, "nod_head_once");

			//-- NPC: She told me to expect you. She says you've done good work for our cause thus far. That is good news, but we're not done yet. The droid that you assembled on Tatooine is missing critical components.  It is an obscure Old Republic model, but you may find some of the parts here on Naboo.
			string_id message = new string_id (c_stringFile, "s_78");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: Yes. What is the next step?
			boolean hasResponse0 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_82");

				utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 21);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch21 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: She told me to expect you. She says you've done good work for our cause thus far. That is good news, but we're not done yet. The droid that you assembled on Tatooine is missing critical components.  It is an obscure Old Republic model, but you may find some of the parts here on Naboo.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: Yes. What is the next step?
	if (response == "s_82")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			naboo_legacy_wilson_tchorshel_action_endGotoKadaara (player, npc);

			//-- NPC: There is an old war bunker on the beach near here. Rumor is that experimentation was conducted on Trade Federation droids at this bunker leading up to the Battle of Naboo. Go to that bunker and search for any remnants of those droids or clues as to where to find an example of their AI.
			string_id message = new string_id (c_stringFile, "s_86");
			int numberOfResponses = 0;

			boolean hasResponse = false;

			//-- PLAYER: I'm on my way.
			boolean hasResponse0 = false;
			if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
			{
				++numberOfResponses;
				hasResponse = true;
				hasResponse0 = true;
			}

			if (hasResponse)
			{
				int responseIndex = 0;
				string_id responses [] = new string_id [numberOfResponses];

				if (hasResponse0)
					responses [responseIndex++] = new string_id (c_stringFile, "s_94");

				utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 22);

				npcSpeak (player, message);
				npcSetConversationResponses (player, responses);
			}
			else
			{
				utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

				npcEndConversationWithMessage (player, message);
			}

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

int naboo_legacy_wilson_tchorshel_handleBranch22 (obj_id player, obj_id npc, string_id response)
{
	//-- [BRANCH NOTE] 
	//-- NPC: There is an old war bunker on the beach near here. Rumor is that experimentation was conducted on Trade Federation droids at this bunker leading up to the Battle of Naboo. Go to that bunker and search for any remnants of those droids or clues as to where to find an example of their AI.

	//-- [RESPONSE NOTE] 
	//-- PLAYER: I'm on my way.
	if (response == "s_94")
	{
		//-- [NOTE] 
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			naboo_legacy_wilson_tchorshel_action_grantKadaaraQuest (player, npc);

			//-- NPC: Excellent. Return to me once you've found any information about the Old Republic experimental droid AI.
			string_id message = new string_id (c_stringFile, "s_96");
			utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

			npcEndConversationWithMessage (player, message);

			return SCRIPT_CONTINUE;
		}

	}

	return SCRIPT_DEFAULT;
}

// ----------------------------------------------------------------------

// ======================================================================
// User Script Triggers
// ======================================================================

trigger OnInitialize ()
{
	if ((!isMob (self)) || (isPlayer (self)))
		detachScript(self, "conversation.naboo_legacy_wilson_tchorshel");

	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);
	setInvulnerable (self, true);
	
	ai_lib.setDefaultCalmBehavior(self, ai_lib.BEHAVIOR_SENTINEL);

	return SCRIPT_CONTINUE;
}

trigger OnAttach ()
{
	setCondition (self, CONDITION_CONVERSABLE);
	setCondition (self, CONDITION_INTERESTING);
	setInvulnerable (self, true);

	ai_lib.setDefaultCalmBehavior(self, ai_lib.BEHAVIOR_SENTINEL);

	return SCRIPT_CONTINUE;
}

trigger OnObjectMenuRequest (obj_id player, menu_info menuInfo)
{
	int menu = menuInfo.addRootMenu (menu_info_types.CONVERSE_START, null);
	menu_info_data menuInfoData = menuInfo.getMenuItemById (menu);
	menuInfoData.setServerNotify (false);
	
	faceTo( self, player );

	return SCRIPT_CONTINUE;
}

trigger OnIncapacitated (obj_id killer)
{
	clearCondition (self, CONDITION_CONVERSABLE);
	detachScript (self, "conversation.naboo_legacy_wilson_tchorshel");

	return SCRIPT_CONTINUE;
}

// ======================================================================
// Script Triggers
// ======================================================================

//-- This function should move to base_class.java
boolean npcStartConversation(obj_id player, obj_id npc, string convoName, string_id greetingId, prose_package greetingProse, string_id[] responses)
{
	Object[] objects = new Object[responses.length];
	System.arraycopy(responses, 0, objects, 0, responses.length);
	return npcStartConversation(player, npc, convoName, greetingId, greetingProse, objects);
}

// ----------------------------------------------------------------------

trigger OnStartNpcConversation (obj_id player)
{
	obj_id npc = self;

	if (ai_lib.isInCombat (npc) || ai_lib.isInCombat (player))
		return SCRIPT_OVERRIDE;

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_completedNaboo_Imperial (player, npc))
	{
		//-- NPC: You have made a grave error that we will strive to correct. You may yet get a chance to redeem yourself, but should that fail, there will be much blood on your hands.
		string_id message = new string_id (c_stringFile, "s_97");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_completedNaboo_Rebel (player, npc))
	{
		naboo_legacy_wilson_tchorshel_action_givePointerToCorellia (player, npc);

		//-- NPC: Thank you! You're efforts will not be forgotten. And may the Force be with you always!
		string_id message = new string_id (c_stringFile, "s_98");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_hasAllDroidParts_Imp (player, npc))
	{
		//-- NPC: You there. I know you're working for the Empire. Have you found the droid AI?
		string_id message = new string_id (c_stringFile, "s_48");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: As a matter of fact, I have.
		boolean hasResponse0 = false;
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: That is none of your concern, sir.
		boolean hasResponse1 = false;
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_90");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_91");

			utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 3);

			npcStartConversation (player, npc, "naboo_legacy_wilson_tchorshel", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_hasAllDroidParts_Rebel (player, npc))
	{
		//-- NPC: Do you have the droid AI? All four parts of it?
		string_id message = new string_id (c_stringFile, "s_12");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: I do. I have it all.
		boolean hasResponse0 = false;
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_80");

			utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 6);

			npcStartConversation (player, npc, "naboo_legacy_wilson_tchorshel", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_seekingDroidParts_Imp (player, npc))
	{
		//-- NPC: When you find the droid AI, please for the sake of all people, bring it to me. Not to the Empire.
		string_id message = new string_id (c_stringFile, "s_75");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_seekingDroidParts_Rebel (player, npc))
	{
		//-- NPC: The droid AI was split and is housed in four different droids? Very interesting. Gather all four and return with them to me. Do not speak with any Imperials about this!
		string_id message = new string_id (c_stringFile, "s_20");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_seekingRSFComputerAccess (player, npc))
	{
		//-- NPC: Once you gain access to the RSF mainframe, use the information you learn there to find and obtain the droid AI.
		string_id message = new string_id (c_stringFile, "s_22");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_onPanakaQuest_Imp (player, npc))
	{
		//-- NPC: Look, I understand what you're doing, but reconsider your options. If you learn anything, return to me instead of to the Empire. It is the right thing to do.
		string_id message = new string_id (c_stringFile, "s_37");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_onPanakaQuest_Rebel (player, npc))
	{
		//-- NPC: Check the old war bunker on the beach near the city. I've heard it has been overrun by Skaak Tippers, so be prepared for anything. Examine anything of interest you find in the bunker.
		string_id message = new string_id (c_stringFile, "s_49");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_kickQuestActive_Imp (player, npc))
	{
		//-- NPC: Listen to me for a minute. I know you think you're doing the right thing, but you're not. The Empire will to terrible things with that droid technology if they get their hands onto it.
		string_id message = new string_id (c_stringFile, "s_51");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Yes, I think I agree.
		boolean hasResponse0 = false;
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		//-- PLAYER: And you won't?
		boolean hasResponse1 = false;
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse1 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_53");

			if (hasResponse1)
				responses [responseIndex++] = new string_id (c_stringFile, "s_59");

			utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 15);

			npcStartConversation (player, npc, "naboo_legacy_wilson_tchorshel", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition_kickQuestActive_Rebel (player, npc))
	{
		//-- NPC: Over here, but keep your voice low. 
		string_id message = new string_id (c_stringFile, "s_73");
		int numberOfResponses = 0;

		boolean hasResponse = false;

		//-- PLAYER: Carh'la Bastra sent me to you.
		boolean hasResponse0 = false;
		if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
		{
			++numberOfResponses;
			hasResponse = true;
			hasResponse0 = true;
		}

		if (hasResponse)
		{
			int responseIndex = 0;
			string_id responses [] = new string_id [numberOfResponses];

			if (hasResponse0)
				responses [responseIndex++] = new string_id (c_stringFile, "s_76");

			utils.setScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId", 20);

			npcStartConversation (player, npc, "naboo_legacy_wilson_tchorshel", message, responses);
		}
		else
		{
			chat.chat (npc, player, message);
		}

		return SCRIPT_CONTINUE;
	}

	//-- [NOTE] 
	if (naboo_legacy_wilson_tchorshel_condition__defaultCondition (player, npc))
	{
		//-- NPC: Having enemies only means that you've taken a stand at some point in your life. Have the courage to stand up.
		string_id message = new string_id (c_stringFile, "s_100");
		chat.chat (npc, player, message);

		return SCRIPT_CONTINUE;
	}

	chat.chat (npc, "Error:  All conditions for OnStartNpcConversation were false.");

	return SCRIPT_CONTINUE;
}

// ----------------------------------------------------------------------

trigger OnNpcConversationResponse (string conversationId, obj_id player, string_id response)
{
	if (conversationId != "naboo_legacy_wilson_tchorshel")
		return SCRIPT_CONTINUE;

	obj_id npc = self;

	int branchId = utils.getIntScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

	if (branchId == 3 && naboo_legacy_wilson_tchorshel_handleBranch3 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 4 && naboo_legacy_wilson_tchorshel_handleBranch4 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 6 && naboo_legacy_wilson_tchorshel_handleBranch6 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 7 && naboo_legacy_wilson_tchorshel_handleBranch7 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 15 && naboo_legacy_wilson_tchorshel_handleBranch15 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 16 && naboo_legacy_wilson_tchorshel_handleBranch16 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 17 && naboo_legacy_wilson_tchorshel_handleBranch17 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 18 && naboo_legacy_wilson_tchorshel_handleBranch18 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 20 && naboo_legacy_wilson_tchorshel_handleBranch20 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 21 && naboo_legacy_wilson_tchorshel_handleBranch21 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	if (branchId == 22 && naboo_legacy_wilson_tchorshel_handleBranch22 (player, npc, response) == SCRIPT_CONTINUE)
		return SCRIPT_CONTINUE;

	chat.chat (npc, "Error:  Fell through all branches and responses for OnNpcConversationResponse.");

	utils.removeScriptVar (player, "conversation.naboo_legacy_wilson_tchorshel.branchId");

	return SCRIPT_CONTINUE;
}

// ======================================================================

